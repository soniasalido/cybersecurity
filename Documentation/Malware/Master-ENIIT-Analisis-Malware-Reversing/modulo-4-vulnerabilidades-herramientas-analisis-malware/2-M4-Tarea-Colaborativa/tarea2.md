
## Instalacion de Ghidrathon
Ghidrathon es un plugin/extensión para Ghidra que sirve para poder usar Python 3 dentro de Ghidra. Ghidra trae de serie scripts en Java y en Python 2 (Jython). Hoy en día casi todas las librerías y herramientas de seguridad están en Python 3, y eso complicaba integrarlas con Ghidra.  Ghidrathon, creado por el equipo FLARE de Mandiant, añade a Ghidra:

Intérprete interactivo de Python 3 dentro de la ventana de Ghidra. 
GitHub

Posibilidad de escribir y ejecutar scripts de Ghidra en Python 3 desde el Script Manager. 
GitHub
+1

Soporte para usar librerías externas (capstone, unicorn, angr, capa, etc.) como si fuera un entorno Python normal. 
GitHub
+1

### Crea un entorno Python 3 con jep instalado:
```
python3 -m venv ~/ghidra-py
source ~/ghidra-py/bin/activate
pip install --upgrade pip
pip install jep==4.2.0
deactivate
```

### Configuramos la variable de entorno:
```
export JAVA_HOME=/usr/lib/jvm/java-21-openjdk-amd64
```

### Agregar la variable de entorno a nuestro usuario:
```
echo 'export JAVA_HOME=/usr/lib/jvm/java-21-openjdk-amd64' >> ~/.bashrc
echo 'export PATH="$JAVA_HOME/bin:$PATH"' >> ~/.bashrc
source ~/.bashrc
```


### Instalammos Ghidrathon
Descargamos Ghidrathon en nuestro Ghidra environment: https://github.com/mandiant/Ghidrathon
Ejecutamos:
```
python -m pip install -r requirements.txt
python ghidrathon_configure.py <absolute_path_to_ghidra_install_dir>
```

### :
ghidrathon_configure.py by default attempts to write a file named ghidrathon.save to <absolute_path_to_ghidra_install_dir>. You can specify the path where this file is written by setting the GHIDRATHON_SAVE_PATH environment variable before running ghidrathon_configure.py and Ghidra:
```
export GHIDRATHON_SAVE_PATH="/path/to/custom/dir" # Linux/MacOS
```

### Si no lo crea, entonces creamos el archivo ghidrathon.save apuntando al Python de nuestro venv.
```
cd /home/xxniwexx/Escritorio/ghidra_11.4.1_PUBLIC
python ghidrathon_configure.py /home/xxniwexx/Escritorio/ghidra_11.4.1_PUBLIC
```


### Instalar capa en el mismo Python que usa Ghidrathon
```
source ~/ghidra-py/venv/bin/activate
/home/xxniwexx/ghidra-py/bin/python -m pip install --upgrade flare-capa
deactivate
```

### Comprobamos la version de capa instalado:
```
/home/xxniwexx/ghidra-py/bin/python -c "import importlib.util, pkgutil, sys; import capa; print('version:', getattr(capa,'__version__', 'unknown')); print('capa.main ->', importlib.util.find_spec('capa.main'))"
/home/xxniwexx/ghidra-py/bin/capa --version
```

### Descargamos las reglas de capa
```
git clone https://github.com/mandiant/capa-rules.git ~/capa-rules
```


### Editar el script o introducir rutas al ejecutarlo
Al ejecutar capa_explorer.py o capa_ghidra.py Si es la primera vez, debe pedirnos el path a capa y rules dir. Si no lo hacen, puedes abrir el script y buscar las variables tipo:
```
capa_path = "/ruta/a/capa"
rules_dir = "/ruta/a/capa-rules"
```

### Vemos su funcionamiento
Una vez instalado, ejecutamos el script. Aparece el informe que genera la herramienta capa. Podemos acceder a las partes que detecta este informe, haciendo doble click en ellas.
![Plugin capa para Ghidra](capturas/plugin-capa-ghidra.png)

-------------------------------------------------
## Instalacion de plugin CAPA para Ghidra
El ZIP del plugin capa explorer no viene con Ghidra, tenemos que descargarlo del repositorio oficial de capa en GitHub.

Descargamos capa_explorer.py y capa_ghidra.py: https://github.com/mandiant/capa/tree/master/capa/ghidra

En la ventana de script manager de ghidra, creamos una nueva carpeta de plugins. Una vez creada pegamos esos ficheros en esa nueva carpeta.
