
# Clasificaci√≥n de los sistemas de cifra
## üìå 1. Seg√∫n el tipo de clave
- **Cifrado sim√©trico:**
  - Usa la misma clave para cifrar y descifrar.
  - Ventaja: r√°pido y eficiente.
  - Inconveniente: problema de intercambio seguro de la clave.
  - Ejemplos: AES, DES, ChaCha20.

- **Cifrado asim√©trico:**
  - Usa dos claves distintas y relacionadas matem√°ticamente:
    - Clave p√∫blica (cifrar).
    - Clave privada (descifrar).
  - Ventaja: resuelve el problema de compartir claves.
  - Ejemplos: RSA, ECC, ElGamal.

## üìå 2. Seg√∫n la √©poca o generaci√≥n
- **Cifras cl√°sicas:**
  - Basadas en sustituci√≥n y transposici√≥n de letras.
  - Ejemplos: C√©sar, Vigen√®re, Esc√≠tala.
- **Cifras modernas:**
  - Basadas en algoritmos matem√°ticos complejos y c√≥mputo digital.
  - Ejemplos: AES, RSA, ECC.

## üìå 3. Seg√∫n la unidad de operaci√≥n
- **Cifrado por bloques:**
  - El texto se divide en bloques de tama√±o fijo y cada bloque se cifra como una unidad.
  - Ejemplos: AES (128 bits), DES (64 bits).
- **Cifrado en flujo:**
  - El texto se cifra bit a bit o byte a byte, generando un flujo pseudoaleatorio.
  - Ejemplos: RC4, Salsa20.

## üìå 4. Seg√∫n la transformaci√≥n aplicada
- **Cifras de sustituci√≥n:** cambian unos s√≠mbolos por otros.
- **Cifras de transposici√≥n:** reordenan los s√≠mbolos.
- **Cifras combinadas:** usan ambas t√©cnicas (muy comunes en algoritmos modernos).


## Resumen Clasificaci√≥n de los sistemas de cifra

| **Criterio**                | **Tipos**            | **Caracter√≠sticas**                                                                                    | **Ejemplos**                  |
| --------------------------- | -------------------- | ------------------------------------------------------------------------------------------------------ | ----------------------------- |
| **Por clave**               | üîë **Sim√©trico**     | Misma clave para cifrar y descifrar. R√°pido, pero hay problema de intercambio seguro de clave.         | AES, DES, ChaCha20            |
|                             | üîë **Asim√©trico**    | Par de claves: p√∫blica (cifrar) y privada (descifrar). M√°s lento, pero resuelve intercambio de claves. | RSA, ECC, ElGamal             |
|  |  |  |  |
| **Por √©poca**               | üèõÔ∏è **Cl√°sicos**     | Sustituci√≥n y transposici√≥n de letras o s√≠mbolos.                                                      | C√©sar, Vigen√®re, Esc√≠tala     |
|                             | üíª **Modernos**      | Algoritmos matem√°ticos complejos, aplicados en computaci√≥n.                                            | AES, RSA, ECC                 |
|  |  |  |  |
| **Por unidad de operaci√≥n** | üì¶ **Por bloques**   | Cifra bloques de datos de tama√±o fijo (64, 128 bits‚Ä¶).                                                 | AES (128 bits), DES (64 bits) |
|                             | üîÑ **En flujo**      | Cifra bit a bit o byte a byte con flujo pseudoaleatorio.                                               | RC4, Salsa20                  |
|  |  |  |  |
| **Por transformaci√≥n**      | üîÅ **Sustituci√≥n**   | Sustituye s√≠mbolos por otros.                                                                          | C√©sar, ROT13                  |
|                             | üîÄ **Transposici√≥n** | Reordena los s√≠mbolos sin cambiarlos.                                                                  | Esc√≠tala, Rail Fence          |
|                             | ‚ö° **Combinadas**     | Mezcla sustituci√≥n y transposici√≥n. Muy usadas en sistemas modernos.                                   | AES, Vigen√®re mejorado        |

_______________________________________________
# Clasificaci√≥n de las Cifras Cl√°sicas
## üìå 1. Seg√∫n el tipo de operaci√≥n que se realiza al texto en claro durante la cifra.
- **Cifras de Sustituci√≥n - Objetivo Confusi√≥n:**
  - Cada s√≠mbolo del mensaje se reemplaza por otro siguiendo una regla fija.
  - El alfabeto de cifra puede o no tener los mismos elementos que el alfabeto del texto en claro. En este segundo caso, puede incluir signos y diferente objetos gr√°ficos. Ejemplo: El escarabajo de oro.

  - **Clasificaci√≥n de los algoritmos por sustituci√≥n:**
    - **A) Cifrado Monoalfab√©tico** (cada letra se sustituye por otra distinta del alfabeto).
      - Tipos de cifrado monoalfab√©tico:
        - Cifrado Monogr√°mico: Se cifra letra a letra.
        - Cifrado Poligr√°mico: Se usa un grupo de letras del mensaje.

      - Ejemplos del algoritmos de sustituci√≥n Monoalfab√©ticos:
        - Cifrado C√©sar (desplazar el alfabeto un n√∫mero fijo de posiciones). Cifrado Monoalfab√©tico.
        - Cifrado Homof√≥nico (una letra puede sustituirse por varios s√≠mbolos posibles). Cifrado Monoalfab√©tico
        - Cifrado Afin. Cifrado Monoalfab√©tico.
        - Cifrado Playfair. Sustituci√≥n Monoalfab√©tico Poligr√°mico.
        - Cifrado Matrices de Hill. Monoalfab√©tico Poligr√°mico.
        
    - **B) Cifrado Polialfab√©tico** (usa varios alfabetos de sustituci√≥n, como el Vigen√®re).
      - La periodicidad se refiere a la repetici√≥n o no de una clave durante el cifrado.
      - No periodicos:
        - Cifrador de Vernam. Se considera polialfab√©tico no peri√≥dico solo cuando la clave es aleatoria y del mismo tama√±o que el mensaje (caso particular: One-Time Pad).
      - Peri√≥dicos:
        - Enigma.
        - Cifrador de Vigen√®re.

- **Cifras de Transposici√≥n o Permutaci√≥n - Objetivo Difusi√≥n:**
  - No se cambian los s√≠mbolos, sino que se reordenan siguiendo un patr√≥n.
  - En los algoritmos por Transposici√≥n, las operaciones se realizan mediante:
    - Grupos.
    - Series.
    - Columnas (escribir en una tabla y leer por columnas).
    - Filas.
    - Rutas (leer las letras siguiendo un recorrido).
  - Su importancia radica en que su uso en la cifra aumenta la seguridad de los algoritmos al difundir las propiedades estad√≠sticas del lenguaje.
  - Ejemplos:
    - Esc√≠tala espartana.

- **Cifras mixtas:** Combinan sustituci√≥n y transposici√≥n para m√°s seguridad.
  - Ejemplo: ADFGVX (usado en la Primera Guerra Mundial).


### Tabla Resumen de la Clasificaci√≥n de las Cifras Cl√°sicas

| **Categor√≠a** | **Subcategor√≠a** | **Caracter√≠sticas** | **Ejemplos** |
|---------------|------------------|----------------------|--------------|
| üîÅ Sustituci√≥n (Confusi√≥n) | **Monoalfab√©tica** | Cada letra del mensaje se sustituye siempre por otra fija. | C√©sar, Afin, Sustituci√≥n Homof√≥nica |
|               | **Poligr√°mica**  | Sustituye grupos de letras (d√≠grafos, tr√≠grafos o m√°s). | Playfair (d√≠grafos), Hill (matrices) |
|               | **Polialfab√©tica** | Usa varios alfabetos de sustituci√≥n en secuencia. Puede ser peri√≥dica o no. | Vigen√®re (peri√≥dico), Vernam/OTP (no peri√≥dico), Enigma (m√°quina polialfab√©tica) |
| üîÄ Transposici√≥n (Difusi√≥n) | **Por columnas** | Se escribe en tabla y se lee por columnas. | Transposici√≥n columnar |
|               | **Por filas** | Reordenamiento de caracteres en secuencia. | Variantes por permutaciones simples |
|               | **Por rutas** | Se sigue un recorrido en zigzag o espiral. | Transposici√≥n por ruta |
|               | **Otros** | Reordenamientos con objetos f√≠sicos. | Esc√≠tala espartana |
| ‚ö° Mixtas | - | Combinan sustituci√≥n y transposici√≥n para aumentar seguridad. | ADFGVX (Primera Guerra Mundial) |





## üìå 2. Seg√∫n el alfabeto utilizado
- **Monoalfab√©ticas:** usan un solo alfabeto para cifrar todo el mensaje.
  - Ejemplo: C√©sar.
- **Polialfab√©ticas:** usan varios alfabetos que se alternan.
  - Ejemplo: Vigen√®re, Alberti.

## üìå 3. Seg√∫n la unidad de cifrado
- **Por letras:** transforman cada letra individualmente.
- **Por grupos:** trabajan con s√≠labas o grupos de letras (ej. d√≠grafos).
- **Por palabras:** poco frecuente, sustituyen palabras enteras por s√≠mbolos o n√∫meros.

________________________________
# Mapa Conceptual: Clasificaci√≥n de las Cifras Cl√°sicas
## üìå 1. Sustituci√≥n: Reemplazan letras/s√≠mbolos por otros.
- Monoalfab√©ticas ‚Üí un solo alfabeto.
  - Cifrado C√©sar
  - Sustituci√≥n simple
- Polialfab√©ticas ‚Üí varios alfabetos alternados.
  - Vigen√®re
  - Disco de Alberti
- Homof√≥nicas ‚Üí una letra puede tener varias sustituciones.
- Pol√≠gramas ‚Üí sustituyen grupos de letras (ej. Playfair).

## üìå 2. Transposici√≥n: Reordenan los s√≠mbolos sin cambiarlos.
- Esc√≠tala espartana (vara con pergamino).
- Transposici√≥n por columnas (escribir en tabla y leer columnas).
- Ruta o zigzag (leer letras siguiendo un recorrido).

## üìå 3. Mixtas: Combinan sustituci√≥n + transposici√≥n.
- ADFGVX (Primera Guerra Mundial).


![Clasificaci√≥n de las Cifras Cl√°sicas](capturas/Clasificacion-de-las-Cifras-Clasicas.png)

![Clasificaci√≥n de las Cifras Cl√°sicas -2](capturas/clasificacion-cifras-clasicas-2.png)

---------------------------------------------------------------------------

# Cifrando en un cuerpo
Cifrando dentro de un cuerpo aborda un concepto fundamental en criptograf√≠a: **la idea de realizar operaciones de cifrado dentro de un cuerpo de cifra o m√≥dulo**, destacando que este concepto es distinto al de operar en un cuerpo (como en matem√°ticas abstractas), y que es esencial en muchos sistemas criptogr√°ficos modernos .

## Que significa "un cuerpo"
En matem√°ticas, un cuerpo (o campo, en ingl√©s field) **es una estructura algebraica donde se pueden hacer operaciones de suma, resta, multiplicaci√≥n y divisi√≥n (excepto dividir entre 0) y que cumplen ciertas reglas**.

Ejemplos de cuerpos:
- Los n√∫meros racionales (‚Ñö)
- Los n√∫meros reales (‚Ñù)
- Los n√∫meros complejos (‚ÑÇ)
- Tambi√©n cuerpos finitos como ‚Ñ§/p‚Ñ§ (enteros m√≥dulo un n√∫mero primo p).

## ¬øQu√© significa "un cuerpo" en criptograf√≠a?
En criptograf√≠a muchas operaciones no se hacen en los n√∫meros reales que usamos normalmente, sino dentro de un cuerpo finito o un anillo modular.
  - Ejemplo t√≠pico: RSA trabaja en los enteros m√≥dulo n (con n grande, producto de dos primos).
  - En criptograf√≠a de curva el√≠ptica se usan cuerpos finitos ‚Ñ§/p‚Ñ§ o cuerpos extendidos GF(2^m).

## ‚ÄúCifrando dentro de un cuerpo‚Äù, significa que:
- Se refiere al proceso de realizar la operaci√≥n de cifrado trabajando matem√°ticamente sobre un cuerpo algebraico (en ingl√©s, "field") en vez de un conjunto cualquiera.
- El texto claro y las claves se transforman en n√∫meros.
- Las operaciones de cifrado (sumas, multiplicaciones, potencias, etc.) se hacen dentro de un cuerpo finito, es decir, respetando las reglas de ese sistema matem√°tico.
- Esto garantiza que las operaciones tengan propiedades necesarias: inversas, cierre, etc., lo que permite que el cifrado sea reversible (descifrable).

## La operaci√≥n m√≥dulo
La operaci√≥n m√≥dulo es simplemente quedarse con el resto de una divisi√≥n.
```
17√∑5=3 con resto 2
Se escribe:
17‚â°2¬†(mod¬†5)
17‚â°2¬†(mod¬†5)
Eso significa que 17 y 2 dejan el mismo resto al dividir entre 5.
```

## M√≥dulo n
Trabajar ‚Äúm√≥dulo n‚Äù significa que:
- S√≥lo nos importan los restos entre 0 y n-1.
- Todo n√∫mero lo reducimos a su equivalente en ese rango.

Por ejemplo, m√≥dulo 7:
- 10‚â°3¬†(mod¬†7)
- 15‚â°1¬†(mod¬†7)
- 21‚â°0¬†(mod¬†7)



## ¬øQu√© es un cuerpo de cifra o m√≥dulo?
En criptograf√≠a las operaciones se realizan dentro de un cuerpo de cifra o m√≥dulo, siendo este concepto distinto cuando hablamos de criptograf√≠a cl√°sica o de criptograf√≠a moderna.

En matem√°tica discreta decimos que un cuerpo finito `n`, est√° conformado por `n` n√∫mero enteros, que van desde el valor `0`, hasta el valor `n-1`, siendo
- n = 0
- n+1 = 1
- ...

Ejemplo:
- Si n = 77 = { 0, 1, 2, 3, 4, ..., 74, 75, 76}
- Tendr√≠amos los siguiente resultados modulares posibles:
  - `22 mod 77 = 22`  ‚Üí 22√∑77  ‚Üí  El cociente es 0 y el resto es 22.
  - `100 mod 77 = 33` ‚Üí 77*1 = 77    ||| 100 - 77 = 33 ‚Üí  100 contiene 1 vez al 77 y queda como resto o residuo 33.
  - `450 mod 77 = 65` ‚Üí 77*5 = 385   ||| 450 - 385 = 65 ‚Üí  450 contiene 5 veces a 77 y queda como residuo 65.
  - `-200 mod 77 = 31` ‚Üí ‚àí200 mod 77 = 31

En criptograf√≠a, especialmente en algoritmos como RSA o ciertos esquemas de cifrado sim√©trico, las operaciones (como multiplicaciones o sumas) se realizan modularmente, es decir, dentro de un conjunto de residuos, por ejemplo usando una operaci√≥n como ‚Äúmod n‚Äù.

Este entorno ‚Äúmodular‚Äù asegura propiedades matem√°ticas √∫tiles para la seguridad criptogr√°fica, como resistencia a ciertos ataques y correcta reversibilidad de operaciones.


## Regla r√°pida para calcular el m√≥dulo de un n√∫mero
![m√≥dulo](capturas/regla-modulo-numero-positivo.png)

## Regla r√°pida para m√≥dulo con negativos
- Calculamos el m√≥dulo como si el n√∫mero fuera positivo.  
  Ejemplo: ‚àí200 mod‚Äâ‚Äâ77 ‚Üí primero 200mod‚Äâ‚Äâ77  
  200√∑77=2resto¬†46

  Entonces  
  200mod77=46.

- Ahora restamos el resultado al divisor n:  
  77‚àí46=31

- Ese es el valor positivo del m√≥dulo para ‚àí200.  
  ‚àí200mod‚Äâ‚Äâ77=31
![m√≥dulo con negativos](capturas/regla-modulo-numero-negativo.png)


## ¬øQu√© es un cuerpo de cifra o m√≥dulo?
- En criptograf√≠a, especialmente en algoritmos como RSA o ciertos esquemas de cifrado sim√©trico, las operaciones (como multiplicaciones o sumas) se realizan modularmente, es decir, dentro de un conjunto de residuos, por ejemplo usando una operaci√≥n como ‚Äúmod n‚Äù.
- Este entorno ‚Äúmodular‚Äù asegura propiedades matem√°ticas √∫tiles para la seguridad criptogr√°fica, como resistencia a ciertos ataques y correcta reversibilidad de operaciones.

## Cuerpo de cifra en la criptograf√≠a cl√°sica.
El Cuerpo de cifra en la criptograf√≠a cl√°sica es el n√∫mero de elementos que conforman el alfabeto del texto en claro. Aunque este alfabeto puede ser cualquier conjunto de letros y/o signos es habitual trabajar en m√≥dulo 27 ya que es el n√∫mero de letras may√∫sculas del alfabeto espa√±ol, incluida la `√ë`.

Se codifica usualmente la letra A = 0, B = 1, ...., Z=26

Sobre esos n√∫mero se realizan operaciones de suma, resa y producto para cifrar cada letra o un conjunto de letras del texto en claro en m√≥dulo 27.


 ## Cuerpo de cifra en la criptograf√≠a moderna
En la cifra moderna, el cuerpo en el que se realizan las operaciones no tiene ninguna relaci√≥n con el alfabeto utilizado en el texto en claro, por ejemplo los 256 caracteres del c√≥digo ASCII. Por lo general, ese cuerpo de cifra suele ser un n√∫mero mucho mayor, como por ejemplo 65.536 y 65.536 en el algoritmo de clave secreta IDEA, o bien, un n√∫mero de unos 300 d√≠gitos decimales o 1024 bits que se utiliza como valor m√≠nimo del m√≥dulo en el algoritmo de clave p√∫blica RSA.
 

## Inversos multiplicativos de un cuerpo
Se dice que un numero `a`, elemento del cuerpo `n` tiene inverso multiplicativo en dicho cuerpo (o simplemente, inverso), si existe otro `x` que haga cumplir la condici√≥n de que `a*x mod n = 1`, la identidad de la multiplicaci√≥n.

Por simplificar (aunque matem√°ticamente no es correcto), podemos asociar el concepto del inverso en ese cuerpo `n:
```
a = 1/x
x= 1/a
```

![Inversos multiplicativos de un cuerpo](capturas/inversos-multiplicativos-1.png)

![Inversos multiplicativos de un cuerpo](capturas/inversos-multiplicativos-2.png)


**¬øPor qu√© son importantes los inversos multiplicativos de un cuerpo en criptograf√≠a?:**
- Permiten ‚Äúdeshacer‚Äù operaciones.
- En RSA, Diffie-Hellman, curvas el√≠pticas, etc., se usan inversos multiplicativos para calcular claves privadas, descifrado o firmas.
- Ejemplo: en RSA el exponente privado `d` es el inverso multiplicativo de `e m√≥dulo œÜ(n)`:  
  `e‚ãÖd‚â°1(modœÜ(n))`

Un inverso multiplicativo en un cuerpo es el n√∫mero que, al multiplicarlo por otro, da 1 (dentro de ese cuerpo). En cuerpos finitos lo calculamos con aritm√©tica modular.

## Condici√≥n necesaria para la existencia del inverso
Para que se cumpla la relaci√≥n: `a*x mod n = 1`, es imprescindible que el m√°ximo com√∫n divisor entre `a`y `n` sea la unidad  ‚Üí  
`mcd(a,n) = 1`

Si esto no se cumple se puede dar la situaci√≥n de cifrar algo y que luego el receptor sea incapaz de descifrarlo.

Ejemplo  ‚Üí  Si en un sistema elemental de cifra m√≥dulo 27, multiplicamos el c√≥digo de cada letra por 3, la cifra se produce, pero NO ser√° posible descifrar, ya que NO EXISTE el inverso de 3 en ese m√≥dulo 27.

## Visualizaci√≥n de los inversos
Sea el cuerpo `n = 10`  
Con elementos o restos: `{0,1,2,3,4,5,6,7,8,9}  
A excepci√≥n del `0 y del 1` ya que no tiene sentido hablar de estos inversos, los √∫nicos elementos en 10 que tienen inversos son:  
{3,7,9} ya que el mcd de estos n√∫meros y 10 es igual a 1  ‚Üí 
mcd(3,10)=1  
mcd(7,10)=1  
mcd(9,10)=1  

Para comprobar que el 3 tiene inverso en 10, podr√≠amos multiplicar todos los elementos de `n` por `3`, reduciendo m√≥dulo 10 para ver el resultado:
```
3*0 = 0 ‚Üí  0  mod 10 = 0
3*1 = 3 ‚Üí  3  mod 10 = 3
3*2 = 6 ‚Üí  6  mod 10 = 6
3*3 = 9 ‚Üí  9  mod 10 = 9
3*4 = 12 ‚Üí 12 mod 10 = 2
3*5 = 15 ‚Üí 15 mod 10 = 5
3*6 = 18 ‚Üí 18 mod 10 = 8
3*7 = 21 ‚Üí 21 mod 10 = 1
3*8 = 24 ‚Üí 24 mod 10 = 4
3*9 = 27 ‚Üí 27 mod 10 = 7
```

Vemos que con los 10 elementos del cuerpo se obtienen TODOS los restos, y que solamente en el caso de `x=7`, se obtiene el resultado 1 que est√°bamos esperando.  
**Por lo tanto, el inverso de 3 en el cuerpo de 10 es 7.**  
De la misma manera, que el inverso de 7 en el cuerpo de 10 es 3.  
Adem√°s este valor es √∫nico.


## Algoritmo Extendido Euclides para calcular inversos multiplicativos
Con el algoritmo de Euclides para calcular inversos multiplicativos m√≥dulo n, sin tener que probar uno por uno.

![ecuacion-bezout](capturas/ecuacion-bezout.png)
