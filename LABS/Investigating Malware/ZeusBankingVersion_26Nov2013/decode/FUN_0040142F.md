
# FUN_0040142f

sta FUN_0040142f es, casi con total seguridad, una rutina “builder” de parámetros + mezclador (PRNG/KDF) ofuscado cuyo valor de retorno real no importa (al final hace XOR EAX,EAX), y cuyo propósito es:

construir un montón de enteros pseudo-aleatorios a partir de tablas DAT_0040fb** / DAT_0040fc**, shifts variables y constantes,

pasárselos a 2 funciones internas (FUN_0040ba1a y FUN_0040bc18) que probablemente hacen la parte “útil” (hash/RC4-like/decrypt/alloc/lookup),

terminar calculando un byte “check/seed” (lo guarda en un local byte en EBP-5) y devolver 0.

```
                             **************************************************************
                             *                          FUNCTION                          *
                             **************************************************************
                             undefined4 __stdcall FUN_0040142f(void)
                               assume FS_OFFSET = 0xffdff000
             undefined4        EAX:4          <RETURN>
             undefined4        Stack[-0x8]:4  local_8                                 XREF[3,1]:   0040144e(W), 
                                                                                                   00401490(W), 
                                                                                                   00401497(R), 
                                                                                                   00401661(W)  
             undefined4        Stack[-0xc]:4  local_c                                 XREF[4]:     00401489(W), 
                                                                                                   0040149a(R), 
                                                                                                   004014ac(W), 
                                                                                                   004014d5(R)  
             undefined4        Stack[-0x10]:4 local_10                                XREF[4]:     00401486(W), 
                                                                                                   004014b5(R), 
                                                                                                   0040159c(W), 
                                                                                                   00401612(R)  
             undefined4        Stack[-0x14]:4 local_14                                XREF[9]:     0040146f(W), 
                                                                                                   0040152e(R), 
                                                                                                   00401599(W), 
                                                                                                   004015c2(W), 
                                                                                                   004015e9(R), 
                                                                                                   0040160e(W), 
                                                                                                   00401624(W), 
                                                                                                   0040163d(W), 
                                                                                                   00401640(R)  
                             FUN_0040142f                                    XREF[4]:     FUN_00408469:00409053(*), 
                                                                                          FUN_00408469:004090df(W), 
                                                                                          FUN_00408469:0040920d(c), 
                                                                                          0040e5ac(*)  
        0040142f 55              PUSH       EBP
                             LAB_00401430                                    XREF[1]:     FUN_00408469:004090f9(W)  
        00401430 8b ec           MOV        EBP,ESP
        00401432 83 ec 20        SUB        ESP,0x20
        00401435 0f b7 05        MOVZX      EAX,word ptr [DAT_0040fb8c]                      = 014Fh
                 8c fb 40 00
        0040143c b9 b3 10        MOV        ECX,0x10b3
                 00 00
        00401441 66 2b c1        SUB        AX,CX
        00401444 33 d2           XOR        EDX,EDX
        00401446 53              PUSH       EBX
        00401447 56              PUSH       ESI
        00401448 57              PUSH       EDI
        00401449 35 06 54        XOR        EAX,0x5406
                 00 00
        0040144e 66 89 45 fc     MOV        word ptr [EBP + local_8],AX
        00401452 a1 a8 fb        MOV        EAX,[DAT_0040fba8]                               = 00000DD3h
                 40 00
        00401457 8b 0d a4        MOV        ECX,dword ptr [DAT_0040fba4]                     = 00003F00h
                 fb 40 00
        0040145d 69 c0 ac        IMUL       EAX,EAX,0x52ac
                 52 00 00
        00401463 0d 94 2c        OR         EAX,0x2c94
                 00 00
        00401468 2b c1           SUB        EAX,ECX
        0040146a 35 d4 c0        XOR        EAX,0x476c0d4
                 76 04
        0040146f 89 45 f0        MOV        dword ptr [EBP + local_14],EAX
        00401472 8b 0d b0        MOV        ECX,dword ptr [DAT_0040fbb0]                     = 00000001h
                 fb 40 00
        00401478 a1 ac fb        MOV        EAX,[DAT_0040fbac]                               = 000041BAh
                 40 00
        0040147d f7 f1           DIV        ECX
        0040147f 33 d2           XOR        EDX,EDX
        00401481 2d b9 41        SUB        EAX,0x41b9
                 00 00
        00401486 89 45 f4        MOV        dword ptr [EBP + local_10],EAX
        00401489 c7 45 f8        MOV        dword ptr [EBP + local_c],0x6191
                 91 61 00 00
        00401490 c7 45 fc        MOV        dword ptr [EBP + local_8],0x14
                 14 00 00 00
        00401497 8a 4d fc        MOV        CL,byte ptr [EBP + local_8]
        0040149a 8b 45 f8        MOV        EAX,dword ptr [EBP + local_c]
        0040149d d3 e0           SHL        EAX,CL
        0040149f 8b 0d e0        MOV        ECX,dword ptr [DAT_0040fbe0]                     = 00001A2Fh
                 fb 40 00
        004014a5 8d 84 08        LEA        EAX,[EAX + ECX*0x1 + 0xe6efe5d2]
                 d2 e5 ef e6
        004014ac 89 45 f8        MOV        dword ptr [EBP + local_c],EAX
        004014af 8b 35 d4        MOV        ESI,dword ptr [DAT_0040fbd4]                     = 000001E0h
                 fb 40 00
        004014b5 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        004014b8 8b 0c 85        MOV        ECX,dword ptr [EAX*0x4 + 0x40fbb8]=>DAT_0040fbbc = 000260E7h
                 b8 fb 40 00
        004014bf a1 b4 fb        MOV        EAX,[DAT_0040fbb4]                               = 00002E8Ah
                 40 00
        004014c4 2d 70 4e        SUB        EAX,0x4e70
                 00 00
        004014c9 f7 f1           DIV        ECX
        004014cb c1 e6 02        SHL        ESI,0x2
        004014ce 8b d0           MOV        EDX,EAX
        004014d0 a1 a0 fb        MOV        EAX,[DAT_0040fba0]                               = 00001DCDh
                 40 00
        004014d5 8b 4d f8        MOV        ECX,dword ptr [EBP + local_c]
        004014d8 8a 0c 8d        MOV        CL,byte ptr [ECX*0x4 + DAT_0040fbec]             = 79h    y
                 ec fb 40 00
        004014df 8b 3d e8        MOV        EDI,dword ptr [DAT_0040fbe8]                     = 00001288h
                 fb 40 00
        004014e5 8b 1d e4        MOV        EBX,dword ptr [DAT_0040fbe4]                     = 000002FEh
                 fb 40 00
        004014eb 33 fb           XOR        EDI,EBX
        004014ed d3 e7           SHL        EDI,CL
        004014ef 8b 0d dc        MOV        ECX,dword ptr [DAT_0040fbdc]                     = 00007C68h
                 fb 40 00
        004014f5 83 e1 1e        AND        ECX,0x1e
        004014f8 c1 e1 0a        SHL        ECX,0xa
        004014fb 81 f1 fe        XOR        ECX,0x5f3cbefe
                 be 3c 5f
        00401501 81 c7 80        ADD        EDI,0x6180
                 61 00 00
        00401507 81 f7 c8        XOR        EDI,0xe5b6c7c8
                 c7 b6 e5
        0040150d 57              PUSH       EDI
        0040150e 51              PUSH       ECX
        0040150f 8b 0d d8        MOV        ECX,dword ptr [DAT_0040fbd8]                     = 00000607h
                 fb 40 00
        00401515 c1 e9 02        SHR        ECX,0x2
        00401518 81 f1 2e        XOR        ECX,0x58fde02e
                 e0 fd 58
        0040151e 51              PUSH       ECX
        0040151f 8b 0d d0        MOV        ECX,dword ptr [DAT_0040fbd0]                     = 00001D69h
                 fb 40 00
        00401525 0b ce           OR         ECX,ESI
        00401527 be c9 5b        MOV        ESI,0xe29d5bc9
                 9d e2
        0040152c 2b f1           SUB        ESI,ECX
        0040152e 8b 4d f0        MOV        ECX,dword ptr [EBP + local_14]
        00401531 8b 0c 8d        MOV        ECX,dword ptr [ECX*0x4 + DAT_0040fbc4]           = 58h    X
                 c4 fb 40 00
        00401538 23 ca           AND        ECX,EDX
        0040153a 05 a8 78        ADD        EAX,0x78a8
                 00 00
        0040153f 81 c1 8b        ADD        ECX,0x62c0b18b
                 b1 c0 62
        00401545 c1 e0 0c        SHL        EAX,0xc
        00401548 56              PUSH       ESI
        00401549 51              PUSH       ECX
        0040154a 8b 0d 9c        MOV        ECX,dword ptr [DAT_0040fb9c]                     = 00001459h
                 fb 40 00
        00401550 33 d2           XOR        EDX,EDX
        00401552 f7 f1           DIV        ECX
        00401554 b9 e0 04        MOV        ECX,0x656b04e0
                 6b 65
        00401559 2d ab 04        SUB        EAX,0x1f4804ab
                 48 1f
        0040155e 50              PUSH       EAX
        0040155f a1 98 fb        MOV        EAX,[DAT_0040fb98]                               = 00002E8Dh
                 40 00
        00401564 0d 10 2d        OR         EAX,0x2d10
                 00 00
        00401569 c1 e8 03        SHR        EAX,0x3
        0040156c 2b c8           SUB        ECX,EAX
        0040156e 51              PUSH       ECX
        0040156f 8b 0d 94        MOV        ECX,dword ptr [DAT_0040fb94]                     = 0000002Bh
                 fb 40 00
        00401575 a1 90 fb        MOV        EAX,[DAT_0040fb90]                               = 00000C1Bh
                 40 00
        0040157a 33 d2           XOR        EDX,EDX
        0040157c f7 f1           DIV        ECX
        0040157e 33 d2           XOR        EDX,EDX
        00401580 b9 e4 4e        MOV        ECX,0x4ee4
                 00 00
        00401585 69 c0 1e        IMUL       EAX,EAX,0x311e
                 31 00 00
        0040158b f7 f1           DIV        ECX
        0040158d 81 c2 e9        ADD        EDX,0x42a43ce9
                 3c a4 42
        00401593 52              PUSH       EDX
        00401594 e8 81 a4        CALL       FUN_0040ba1a                                     int FUN_0040ba1a(void)
                 00 00
        00401599 89 45 f0        MOV        dword ptr [EBP + local_14],EAX
        0040159c c7 45 f4        MOV        dword ptr [EBP + local_10],0x0
                 00 00 00 00
        004015a3 8b 0d 04        MOV        ECX,dword ptr [DAT_0040fc04]                     = 00000CE6h
                 fc 40 00
        004015a9 a1 00 fc        MOV        EAX,[DAT_0040fc00]                               = 00007D76h
                 40 00
        004015ae 2b c1           SUB        EAX,ECX
        004015b0 8a 0d fc        MOV        CL,byte ptr [DAT_0040fbfc]                       = 09h
                 fb 40 00
        004015b6 d3 e8           SHR        EAX,CL
        004015b8 33 d2           XOR        EDX,EDX
        004015ba be b5 13        MOV        ESI,0x913b5
                 09 00
        004015bf 83 e8 38        SUB        EAX,0x38
        004015c2 89 45 f0        MOV        dword ptr [EBP + local_14],EAX
        004015c5 8b 0d 24        MOV        ECX,dword ptr [DAT_0040fc24]                     = 00000001h
                 fc 40 00
        004015cb a1 20 fc        MOV        EAX,[DAT_0040fc20]                               = 0000198Dh
                 40 00
        004015d0 f7 f1           DIV        ECX
        004015d2 8b 0d 1c        MOV        ECX,dword ptr [DAT_0040fc1c]                     = 00007FB0h
                 fc 40 00
        004015d8 33 d2           XOR        EDX,EDX
        004015da 23 c8           AND        ECX,EAX
        004015dc a1 18 fc        MOV        EAX,[DAT_0040fc18]                               = 00000F7Ah
                 40 00
        004015e1 0b c1           OR         EAX,ECX
        004015e3 2d 8e c9        SUB        EAX,0x554bc98e
                 4b 55
        004015e8 50              PUSH       EAX
        004015e9 8b 45 f0        MOV        EAX,dword ptr [EBP + local_14]
        004015ec 8b 0c 85        MOV        ECX,dword ptr [EAX*0x4 + DAT_0040fc0c]           = DCh
                 0c fc 40 00
        004015f3 a1 08 fc        MOV        EAX,[DAT_0040fc08]                               = 00000CE4h
                 40 00
        004015f8 2d 9f 28        SUB        EAX,0x289f
                 00 00
        004015fd f7 f6           DIV        ESI
        004015ff 33 c8           XOR        ECX,EAX
        00401601 b8 4b 6d        MOV        EAX,0x307d6d4b
                 7d 30
        00401606 2b c1           SUB        EAX,ECX
        00401608 50              PUSH       EAX
        00401609 e8 0a a6        CALL       FUN_0040bc18                                     uint FUN_0040bc18(void)
                 00 00
        0040160e 89 45 f0        MOV        dword ptr [EBP + local_14],EAX
        00401611 41              INC        ECX
        00401612 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        00401615 2d 21 b7        SUB        EAX,0xab721
                 0a 00
        0040161a 35 21 e3        XOR        EAX,0x2e321
                 02 00
        0040161f 05 42 63        ADD        EAX,0x6f6342
                 6f 00
        00401624 89 45 f0        MOV        dword ptr [EBP + local_14],EAX
        00401627 a1 30 fc        MOV        EAX,[DAT_0040fc30]                               = 00003607h
                 40 00
        0040162c 8b 0d 2c        MOV        ECX,dword ptr [DAT_0040fc2c]                     = 000025F6h
                 fc 40 00
        00401632 c1 e8 07        SHR        EAX,0x7
        00401635 03 c8           ADD        ECX,EAX
        00401637 81 f1 63        XOR        ECX,0x2663
                 26 00 00
        0040163d 89 4d f0        MOV        dword ptr [EBP + local_14],ECX
        00401640 8b 45 f0        MOV        EAX,dword ptr [EBP + local_14]
        00401643 8a 80 34        MOV        AL,byte ptr [EAX + 0x40fc34]=>DAT_0040fc35       = 97h
                 fc 40 00
        00401649 0f b6 c8        MOVZX      ECX,AL
        0040164c a0 29 fc        MOV        AL,[DAT_0040fc29]                                = 32h
                 40 00
        00401651 0f b6 c0        MOVZX      EAX,AL
        00401654 33 c1           XOR        EAX,ECX
        00401656 0f b6 0d        MOVZX      ECX,byte ptr [DAT_0040fc28]                      = 28h
                 28 fc 40 00
        0040165d 5f              POP        EDI
        0040165e 2b c1           SUB        EAX,ECX
        00401660 5e              POP        ESI
        00401661 88 45 ff        MOV        byte ptr [EBP + local_8+0x3],AL
        00401664 33 c0           XOR        EAX,EAX
        00401666 5b              POP        EBX
        00401667 c9              LEAVE
        00401668 c2 0c 00        RET        0xc


```