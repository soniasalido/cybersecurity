


```
                             **************************************************************
                             *                          FUNCTION                          *
                             **************************************************************
                             char * __stdcall FUN_004012df(char * param_1)
                               assume FS_OFFSET = 0xffdff000
             char *            EAX:4          <RETURN>
             char *            Stack[0x4]:4   param_1                                 XREF[9,5]:   004012f2(R), 
                                                                                                   00401303(R), 
                                                                                                   00401306(R), 
                                                                                                   0040134f(W), 
                                                                                                   0040135a(W), 
                                                                                                   00401361(R), 
                                                                                                   0040137a(W), 
                                                                                                   0040137d(R), 
                                                                                                   00401412(W), 
                                                                                                   0040132b(W), 
                                                                                                   004013a2(W), 
                                                                                                   004013d3(R), 
                                                                                                   004013de(W), 
                                                                                                   004013fb(R)  
             undefined1        Stack[-0x5]:1  local_5                                 XREF[2]:     00401356(W), 
                                                                                                   004013ee(R)  
             undefined1        Stack[-0x6]:1  local_6                                 XREF[2]:     00401352(W), 
                                                                                                   004013bc(R)  
             undefined4        Stack[-0xc]:4  local_c                                 XREF[4]:     00401311(W), 
                                                                                                   00401331(R), 
                                                                                                   00401342(R), 
                                                                                                   004013b8(W)  
             undefined4        Stack[-0x10]:4 local_10                                XREF[4]:     004012ea(W), 
                                                                                                   0040132e(R), 
                                                                                                   00401404(R), 
                                                                                                   0040141b(R)  
                             FUN_004012df                                    XREF[1]:     FUN_0040592c:00405c54(c)  
        004012df 55              PUSH       EBP
        004012e0 8b ec           MOV        EBP,ESP
        004012e2 83 ec 0c        SUB        ESP,0xc
        004012e5 53              PUSH       EBX
        004012e6 56              PUSH       ESI
        004012e7 57              PUSH       EDI
        004012e8 3b c3           CMP        EAX,EBX
        004012ea c7 45 f4        MOV        dword ptr [EBP + local_10],0xfff7abfe
                 fe ab f7 ff
        004012f1 93              XCHG       EAX,EBX
        004012f2 8b 45 08        MOV        EAX,dword ptr [EBP + param_1]
        004012f5 8a 00           MOV        AL,byte ptr [EAX]
        004012f7 04 32           ADD        AL,0x32
        004012f9 34 be           XOR        AL,0xbe
        004012fb 3c c1           CMP        AL,0xc1
        004012fd 0f 85 0a        JNZ        LAB_0040140d
                 01 00 00
        00401303 8b 45 08        MOV        EAX,dword ptr [EBP + param_1]
        00401306 8b 4d 08        MOV        ECX,dword ptr [EBP + param_1]
        00401309 03 48 3c        ADD        ECX,dword ptr [EAX + 0x3c]
        0040130c bf 21 e3        MOV        EDI,0x2e321
                 02 00
        00401311 89 4d f8        MOV        dword ptr [EBP + local_c],ECX
        00401314 a0 41 ea        MOV        AL,[DAT_0040ea41]                                = 7Ch
                 40 00
        00401319 0f b6 0d        MOVZX      ECX,byte ptr [DAT_0040ea40]                      = 87h
                 40 ea 40 00
        00401320 0f b6 c0        MOVZX      EAX,AL
        00401323 c1 e8 06        SHR        EAX,0x6
        00401326 33 c8           XOR        ECX,EAX
        00401328 83 c1 5e        ADD        ECX,0x5e
        0040132b 88 4d 0b        MOV        byte ptr [EBP + param_1+0x3],CL
        0040132e 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        00401331 8b 4d f8        MOV        ECX,dword ptr [EBP + local_c]
        00401334 33 c7           XOR        EAX,EDI
        00401336 be 21 b7        MOV        ESI,0xab721
                 0a 00
        0040133b 03 c6           ADD        EAX,ESI
        0040133d 39 41 54        CMP        dword ptr [ECX + 0x54],EAX
        00401340 74 08           JZ         LAB_0040134a
        00401342 8b 45 f8        MOV        EAX,dword ptr [EBP + local_c]
        00401345 e9 de 00        JMP        LAB_00401428
                 00 00
                             LAB_0040134a                                    XREF[1]:     00401340(j)  
        0040134a a1 6c 00        MOV        EAX,[->KERNEL32.DLL::GetSystemDefaultLCID]       = 000204a8
                 42 00
        0040134f 89 45 08        MOV        dword ptr [EBP + param_1],EAX
        00401352 c6 45 fe c6     MOV        byte ptr [EBP + local_6],0xc6
        00401356 c6 45 ff de     MOV        byte ptr [EBP + local_5],0xde
        0040135a c7 45 08        MOV        dword ptr [EBP + param_1],0x792e
                 2e 79 00 00
        00401361 8b 45 08        MOV        EAX,dword ptr [EBP + param_1]
        00401364 8b 0d 48        MOV        ECX,dword ptr [DAT_0040ea48]                     = 000053FCh
                 ea 40 00
        0040136a c1 e8 0c        SHR        EAX,0xc
        0040136d 69 c0 06        IMUL       EAX,EAX,0x6406
                 64 00 00
        00401373 33 c1           XOR        EAX,ECX
        00401375 2d d2 ef        SUB        EAX,0x2efd2
                 02 00
        0040137a 89 45 08        MOV        dword ptr [EBP + param_1],EAX
        0040137d 8b 45 08        MOV        EAX,dword ptr [EBP + param_1]
        00401380 8a 80 4c        MOV        AL,byte ptr [EAX + 0x40ea4c]=>DAT_0040ea50       = 02h
                 ea 40 00
        00401386 0f b6 c8        MOVZX      ECX,AL
        00401389 a0 46 ea        MOV        AL,[DAT_0040ea46]                                = 8Fh
                 40 00
        0040138e d2 e0           SHL        AL,CL
        00401390 0f b6 0d        MOVZX      ECX,byte ptr [DAT_0040ea45]                      = 8Eh
                 45 ea 40 00
        00401397 0f b6 c0        MOVZX      EAX,AL
        0040139a 33 c8           XOR        ECX,EAX
        0040139c 81 f1 a9        XOR        ECX,0xa9
                 00 00 00
        004013a2 88 4d 0b        MOV        byte ptr [EBP + param_1+0x3],CL
        004013a5 b9 9c 00        MOV        ECX,0x9c
                 00 00
        004013aa eb 35           JMP        LAB_004013e1
                             LAB_004013ac                                    XREF[1]:     00401402(j)  
        004013ac 0f b7 05        MOVZX      EAX,word ptr [DAT_0040ea54]                      = 51CEh
                 54 ea 40 00
        004013b3 05 70 65        ADD        EAX,0x6570
                 00 00
        004013b8 66 89 45 f8     MOV        word ptr [EBP + local_c],AX
        004013bc 8a 45 fe        MOV        AL,byte ptr [EBP + local_6]
        004013bf 8a 15 42        MOV        DL,byte ptr [DAT_0040ea42]                       = C0h
                 ea 40 00
        004013c5 c0 e0 06        SHL        AL,0x6
        004013c8 2a c2           SUB        AL,DL
        004013ca 0f b6 c0        MOVZX      EAX,AL
        004013cd 99              CDQ
        004013ce 6a 0c           PUSH       0xc
        004013d0 5b              POP        EBX
        004013d1 f7 fb           IDIV       EBX
        004013d3 0f b6 55 0b     MOVZX      EDX,byte ptr [EBP + param_1+0x3]
        004013d7 2c 0f           SUB        AL,0xf
        004013d9 0f b6 c0        MOVZX      EAX,AL
        004013dc 03 d0           ADD        EDX,EAX
        004013de 88 55 0b        MOV        byte ptr [EBP + param_1+0x3],DL
                             LAB_004013e1                                    XREF[1]:     004013aa(j)  
        004013e1 a0 44 ea        MOV        AL,[DAT_0040ea44]                                = FCh
                 40 00
        004013e6 0f b6 c0        MOVZX      EAX,AL
        004013e9 99              CDQ
        004013ea 8b d9           MOV        EBX,ECX
        004013ec f7 fb           IDIV       EBX
        004013ee 8a 45 ff        MOV        AL,byte ptr [EBP + local_5]
        004013f1 32 c2           XOR        AL,DL
        004013f3 8a 15 43        MOV        DL,byte ptr [DAT_0040ea43]                       = 37h
                 ea 40 00
        004013f9 22 c2           AND        AL,DL
        004013fb 8a 55 0b        MOV        DL,byte ptr [EBP + param_1+0x3]
        004013fe 34 1a           XOR        AL,0x1a
        00401400 3a d0           CMP        DL,AL
        00401402 76 a8           JBE        LAB_004013ac
        00401404 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        00401407 33 c7           XOR        EAX,EDI
        00401409 03 c6           ADD        EAX,ESI
        0040140b eb 1b           JMP        LAB_00401428
                             LAB_0040140d                                    XREF[1]:     004012fd(j)  
        0040140d a1 9c 00        MOV        EAX,[->SHLWAPI.DLL::Ordinal_14]                  = 8000000e
                 42 00
        00401412 89 45 08        MOV        dword ptr [EBP + param_1],EAX
        00401415 81 fa 07        CMP        EDX,0xf0e7a107
                 a1 e7 f0
        0040141b 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        0040141e 35 21 e3        XOR        EAX,0x2e321
                 02 00
        00401423 05 21 b7        ADD        EAX,0xab721
                 0a 00
                             LAB_00401428                                    XREF[2]:     00401345(j), 0040140b(j)  
        00401428 5f              POP        EDI
        00401429 5e              POP        ESI
        0040142a 5b              POP        EBX
        0040142b c9              LEAVE
        0040142c c2 04 00        RET        0x4


```
