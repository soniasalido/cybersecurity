

                             **************************************************************
                             *                          FUNCTION                          *
                             **************************************************************
                             ushort * __stdcall FUN_00402aaf(void)
                               assume FS_OFFSET = 0xffdff000
             ushort *          EAX:4          <RETURN>
             undefined4        Stack[-0x8]:4  local_8                                 XREF[4,1]:   00402ac1(W), 
                                                                                                   00402d8d(W), 
                                                                                                   0040431b(W), 
                                                                                                   00404327(R), 
                                                                                                   00404a4c(*)  
             undefined4        Stack[-0xc]:4  local_c                                 XREF[13]:    00402bcd(W), 
                                                                                                   00402c18(RW), 
                                                                                                   00402c2a(R), 
                                                                                                   00402c37(W), 
                                                                                                   00402c5d(RW), 
                                                                                                   00402c8c(R), 
                                                                                                   00402d23(W), 
                                                                                                   00402da9(W), 
                                                                                                   00402dad(W), 
                                                                                                   00402dc7(R), 
                                                                                                   00402dce(W), 
                                                                                                   00404323(W), 
                                                                                                   00404332(R)  
             undefined2        Stack[-0x10]:2 local_10                                XREF[6]:     00402df1(W), 
                                                                                                   00402e2f(R), 
                                                                                                   00402ec8(W), 
                                                                                                   00402ed5(R), 
                                                                                                   004042fe(W), 
                                                                                                   0040433c(R)  
             undefined4        Stack[-0x14]:4 local_14                                XREF[6]:     00402ba5(W), 
                                                                                                   00402c06(R), 
                                                                                                   00402cc0(W), 
                                                                                                   00402d13(R), 
                                                                                                   00402e13(W), 
                                                                                                   00402e16(R)  
             undefined4        Stack[-0x18]:4 local_18                                XREF[3]:     00402c77(W), 
                                                                                                   00402c7a(R), 
                                                                                                   00402c7d(*)  
             undefined4        Stack[-0x24]:4 local_24                                XREF[2]:     00402c80(W), 
                                                                                                   00402c83(*)  
             undefined4        Stack[-0x28]:4 local_28                                XREF[1]:     00402d70(W)  
             undefined4        Stack[-0x2c]:4 local_2c                                XREF[3]:     00402b0f(W), 
                                                                                                   00402b32(R), 
                                                                                                   00402b96(W)  
             undefined4        Stack[-0x30]:4 local_30                                XREF[1,5]:   004043d7(W), 
                                                                                                   00402b3d(W), 
                                                                                                   00402c03(W), 
                                                                                                   00402c91(W), 
                                                                                                   00402c9a(W), 
                                                                                                   00402cbd(W)  
             undefined4        Stack[-0x38]:4 local_38                                XREF[1]:     004043b2(W)  
             undefined4        Stack[-0x3c]:4 local_3c                                XREF[6]:     00402aeb(W), 
                                                                                                   00402b5a(RW), 
                                                                                                   00402b7d(R), 
                                                                                                   00402b88(W), 
                                                                                                   00402d2a(R), 
                                                                                                   00402d69(R)  
             undefined4        Stack[-0xa8]:4 local_a8                                XREF[1]:     004043ee(W)  
             undefined4        Stack[-0xac]:4 local_ac                                XREF[1]:     004043e4(W)  
             undefined4        Stack[-0xb0]:4 local_b0                                XREF[1]:     004043da(W)  
             undefined4        Stack[-0x120   local_120                               XREF[1]:     00402c86(W)  
                             FUN_00402aaf                                    XREF[2]:     004056fe(c), 
                                                                                          FUN_00408469:0040887f(c)  
        00402aaf 55              PUSH       EBP
        00402ab0 8b ec           MOV        EBP,ESP
        00402ab2 81 ec 34        SUB        ESP,0x134
                 01 00 00
        00402ab8 56              PUSH       ESI
        00402ab9 57              PUSH       EDI
        00402aba 3c 53           CMP        AL,0x53
        00402abc a1 7c 00        MOV        EAX,[->SHLWAPI.DLL::StrCmpNIA]                   = 000203f8
                 42 00
        00402ac1 89 45 fc        MOV        dword ptr [EBP + local_8],EAX
        00402ac4 8a 0d b4        MOV        CL,byte ptr [DAT_0040f1b4]                       = 0Ah
                 f1 40 00
        00402aca a1 b0 f1        MOV        EAX,[DAT_0040f1b0]                               = 00001A64h
                 40 00
        00402acf d3 e8           SHR        EAX,CL
        00402ad1 8b 0d ac        MOV        ECX,dword ptr [DAT_0040f1ac]                     = 00005FD6h
                 f1 40 00
        00402ad7 be f3 53        MOV        ESI,0x72fa53f3
                 fa 72
        00402adc 33 c8           XOR        ECX,EAX
        00402ade 81 f1 67        XOR        ECX,0x5967
                 59 00 00
        00402ae4 b8 94 5a        MOV        EAX,0x72fa5a94
                 fa 72
        00402ae9 2b c1           SUB        EAX,ECX
        00402aeb 89 45 c8        MOV        dword ptr [EBP + local_3c],EAX
        00402aee eb 6d           JMP        LAB_00402b5d
                             LAB_00402af0                                    XREF[1]:     00402b82(j)  
        00402af0 a1 c0 f1        MOV        EAX,[DAT_0040f1c0]                               = 0000743Ah
                 40 00
        00402af5 8b 0d bc        MOV        ECX,dword ptr [DAT_0040f1bc]                     = 0000380Fh
                 f1 40 00
        00402afb 35 59 28        XOR        EAX,0x2859
                 00 00
        00402b00 0b c8           OR         ECX,EAX
        00402b02 a1 b8 f1        MOV        EAX,[DAT_0040f1b8]                               = 0000060Bh
                 40 00
        00402b07 0f af c1        IMUL       EAX,ECX
        00402b0a 35 c4 f2        XOR        EAX,0x2eff2c4
                 ef 02
        00402b0f 89 45 d8        MOV        dword ptr [EBP + local_2c],EAX
        00402b12 a0 c6 f1        MOV        AL,[DAT_0040f1c6]                                = 81h
                 40 00
        00402b17 0f b6 c8        MOVZX      ECX,AL
        00402b1a a0 c5 f1        MOV        AL,[DAT_0040f1c5]                                = BCh
                 40 00
        00402b1f 0f b6 c0        MOVZX      EAX,AL
        00402b22 99              CDQ
        00402b23 f7 f9           IDIV       ECX
        00402b25 a0 c4 f1        MOV        AL,[DAT_0040f1c4]                                = 82h
                 40 00
        00402b2a 0f b6 c0        MOVZX      EAX,AL
        00402b2d 0f b6 ca        MOVZX      ECX,DL
        00402b30 23 c1           AND        EAX,ECX
        00402b32 8b 4d d8        MOV        ECX,dword ptr [EBP + local_2c]
        00402b35 8a 89 c8        MOV        CL,byte ptr [ECX + 0x40f1c8]=>DAT_0040f1c9       = 06h
                 f1 40 00
        00402b3b d3 e0           SHL        EAX,CL
        00402b3d 88 45 d7        MOV        byte ptr [EBP + local_30+0x3],AL
        00402b40 a1 9c f1        MOV        EAX,[DAT_0040f19c]                               = 000036FAh
                 40 00
        00402b45 8b 0d 98        MOV        ECX,dword ptr [DAT_0040f198]                     = 000074F8h
                 f1 40 00
        00402b4b c1 e0 08        SHL        EAX,0x8
        00402b4e 35 90 1e        XOR        EAX,0x1e90
                 00 00
        00402b53 2b c1           SUB        EAX,ECX
        00402b55 35 99 6f        XOR        EAX,0x366f99
                 36 00
        00402b5a 01 45 c8        ADD        dword ptr [EBP + local_3c],EAX
                             LAB_00402b5d                                    XREF[1]:     00402aee(j)  
        00402b5d a1 a8 f1        MOV        EAX,[DAT_0040f1a8]                               = 00003D9Bh
                 40 00
        00402b62 8b 0d a4        MOV        ECX,dword ptr [DAT_0040f1a4]                     = 00000227h
                 f1 40 00
        00402b68 05 ab 4f        ADD        EAX,0x4fab
                 00 00
        00402b6d 33 d2           XOR        EDX,EDX
        00402b6f f7 f1           DIV        ECX
        00402b71 8b 0d a0        MOV        ECX,dword ptr [DAT_0040f1a0]                     = 00006223h
                 f1 40 00
        00402b77 8b c6           MOV        EAX,ESI
        00402b79 23 ca           AND        ECX,EDX
        00402b7b 2b c1           SUB        EAX,ECX
        00402b7d 8b 4d c8        MOV        ECX,dword ptr [EBP + local_3c]
        00402b80 3b c8           CMP        ECX,EAX
        00402b82 0f 86 68        JBE        LAB_00402af0
                 ff ff ff
        00402b88 c7 45 c8        MOV        dword ptr [EBP + local_3c],0xfff7abfe
                 fe ab f7 ff
        00402b8f 53              PUSH       EBX
        00402b90 4a              DEC        EDX
        00402b91 a1 04 d0        MOV        EAX,[PTR_PTR_0040d004]                           = 00410930
                 40 00
        00402b96 c7 45 d8        MOV        dword ptr [EBP + local_2c],0xfff7abc2
                 c2 ab f7 ff
        00402b9d 8b 00           MOV        EAX=>PTR_PTR_00410930,dword ptr [EAX]            = 0040e4d0
        00402b9f 81 fb ea        CMP        EBX,0x193eb0ea
                 b0 3e 19
        00402ba5 c7 45 f0        MOV        dword ptr [EBP + local_14],0x4fb
                 fb 04 00 00
        00402bac 8b 0d cc        MOV        ECX,dword ptr [DAT_0040f1cc]                     = 00004316h
                 f1 40 00
        00402bb2 b8 ce a7        MOV        EAX,0xffffa7ce
                 ff ff
        00402bb7 2b c1           SUB        EAX,ECX
        00402bb9 8b 0d d0        MOV        ECX,dword ptr [DAT_0040f1d0]                     = 00006EDDh
                 f1 40 00
        00402bbf 03 c8           ADD        ECX,EAX
        00402bc1 69 c9 e1        IMUL       ECX,ECX,0x36e1
                 36 00 00
        00402bc7 81 c1 6c        ADD        ECX,0x20ee366c
                 36 ee 20
        00402bcd 89 4d f8        MOV        dword ptr [EBP + local_c],ECX
        00402bd0 a1 d4 f1        MOV        EAX,[DAT_0040f1d4]                               = 00000B81h
                 40 00
        00402bd5 be 29 22        MOV        ESI,0x2229
                 00 00
        00402bda 8b ce           MOV        ECX,ESI
        00402bdc 33 d2           XOR        EDX,EDX
        00402bde f7 f1           DIV        ECX
        00402be0 b9 ee 79        MOV        ECX,0x79ee
                 00 00
        00402be5 eb 3b           JMP        LAB_00402c22
                             LAB_00402be7                                    XREF[1]:     00402c2f(j)  
        00402be7 0f b6 05        MOVZX      EAX,byte ptr [DAT_0040f1d9]                      = 79h
                 d9 f1 40 00
        00402bee 8a 15 d8        MOV        DL,byte ptr [DAT_0040f1d8]                       = E9h
                 f1 40 00
        00402bf4 02 c2           ADD        AL,DL
        00402bf6 b2 ec           MOV        DL,0xec
        00402bf8 f6 ea           IMUL       DL
        00402bfa 33 d2           XOR        EDX,EDX
        00402bfc 8b fe           MOV        EDI,ESI
        00402bfe 25 cc 00        AND        EAX,0xcc
                 00 00
        00402c03 88 45 d7        MOV        byte ptr [EBP + local_30+0x3],AL
        00402c06 8b 45 f0        MOV        EAX,dword ptr [EBP + local_14]
        00402c09 25 07 13        AND        EAX,0x1307
                 00 00
        00402c0e 2d 73 54        SUB        EAX,0x5473
                 00 00
        00402c13 35 91 ab        XOR        EAX,0xffffab91
                 ff ff
        00402c18 29 45 f8        SUB        dword ptr [EBP + local_c],EAX
        00402c1b a1 d4 f1        MOV        EAX,[DAT_0040f1d4]                               = 00000B81h
                 40 00
        00402c20 f7 f7           DIV        EDI
                             LAB_00402c22                                    XREF[1]:     00402be5(j)  
        00402c22 23 d1           AND        EDX,ECX
        00402c24 8d 82 cc        LEA        EAX,[EDX + 0x176890cc]
                 90 68 17
        00402c2a 8b 55 f8        MOV        EDX,dword ptr [EBP + local_c]
        00402c2d 3b d0           CMP        EDX,EAX
        00402c2f 73 b6           JNC        LAB_00402be7
        00402c31 8b 3d 38        MOV        EDI,dword ptr [->USER32.DLL::AllowSetForegroun   = 000206c0
                 01 42 00
        00402c37 89 7d f8        MOV        dword ptr [EBP + local_c],EDI
        00402c3a 8a 0d e4        MOV        CL,byte ptr [DAT_0040f1e4]                       = 08h
                 f1 40 00
        00402c40 a1 e0 f1        MOV        EAX,[DAT_0040f1e0]                               = 00002796h
                 40 00
        00402c45 d3 e8           SHR        EAX,CL
        00402c47 8b 0d dc        MOV        ECX,dword ptr [DAT_0040f1dc]                     = 00000002h
                 f1 40 00
        00402c4d 33 d2           XOR        EDX,EDX
        00402c4f 0d c0 35        OR         EAX,0x35c0
                 00 00
        00402c54 f7 f1           DIV        ECX
        00402c56 33 d2           XOR        EDX,EDX
        00402c58 35 f3 1a        XOR        EAX,0x1af3
                 00 00
        00402c5d 01 45 f8        ADD        dword ptr [EBP + local_c],EAX
        00402c60 a1 ec f1        MOV        EAX,[DAT_0040f1ec]                               = 00004A45h
                 40 00
        00402c65 8b 0d e8        MOV        ECX,dword ptr [DAT_0040f1e8]                     = 00000003h
                 f1 40 00
        00402c6b 0d ec 0d        OR         EAX,0xdec
                 00 00
        00402c70 f7 f1           DIV        ECX
        00402c72 05 fb 25        ADD        EAX,0x17cf25fb
                 cf 17
        00402c77 89 45 ec        MOV        dword ptr [EBP + local_18],EAX
        00402c7a ff 75 ec        PUSH       dword ptr [EBP + local_18]
        00402c7d 8d 45 ec        LEA        EAX=>local_18,[EBP + -0x14]
        00402c80 89 45 e0        MOV        dword ptr [EBP + local_24],EAX
        00402c83 8d 45 e0        LEA        EAX=>local_24,[EBP + -0x20]
        00402c86 89 85 e4        MOV        dword ptr [EBP + local_120],EAX
                 fe ff ff
        00402c8c 8b 45 f8        MOV        EAX,dword ptr [EBP + local_c]
        00402c8f ff d0           CALL       EAX
        00402c91 c6 45 d7 c3     MOV        byte ptr [EBP + local_30+0x3],0xc3
        00402c95 bb cd f7        MOV        EBX,0x9fa2f7cd
                 a2 9f
        00402c9a c6 45 d7 c3     MOV        byte ptr [EBP + local_30+0x3],0xc3
        00402c9e a0 f1 f1        MOV        AL,[DAT_0040f1f1]                                = 59h
                 40 00
        00402ca3 8a 0d f0        MOV        CL,byte ptr [DAT_0040f1f0]                       = 03h
                 f1 40 00
        00402ca9 c0 e0 07        SHL        AL,0x7
        00402cac 0f b6 c0        MOVZX      EAX,AL
        00402caf 99              CDQ
        00402cb0 0f b6 c9        MOVZX      ECX,CL
        00402cb3 f7 f9           IDIV       ECX
        00402cb5 ba 3a 45        MOV        EDX,0x453a
                 00 00
        00402cba 83 f0 50        XOR        EAX,0x50
        00402cbd 88 45 d7        MOV        byte ptr [EBP + local_30+0x3],AL
        00402cc0 c7 45 f0        MOV        dword ptr [EBP + local_14],0xbe7
                 e7 0b 00 00
        00402cc7 a1 10 f2        MOV        EAX,[DAT_0040f210]                               = 00002BF7h
                 40 00
        00402ccc 8b 0d 0c        MOV        ECX,dword ptr [DAT_0040f20c]                     = 00000A77h
                 f2 40 00
        00402cd2 23 c1           AND        EAX,ECX
        00402cd4 8a 0d 04        MOV        CL,byte ptr [DAT_0040f204]                       = 0Dh
                 f2 40 00
        00402cda d3 ea           SHR        EDX,CL
        00402cdc 8b 0d fc        MOV        ECX,dword ptr [DAT_0040f1fc]                     = 00004AD3h
                 f1 40 00
        00402ce2 8b 35 08        MOV        ESI,dword ptr [DAT_0040f208]                     = 00006CC6h
                 f2 40 00
        00402ce8 03 f0           ADD        ESI,EAX
        00402cea a1 00 f2        MOV        EAX,[DAT_0040f200]                               = 00006F5Bh
                 40 00
        00402cef 23 c2           AND        EAX,EDX
        00402cf1 35 42 94        XOR        EAX,0x130f9442
                 0f 13
        00402cf6 81 f6 c4        XOR        ESI,0x7a90fcc4
                 fc 90 7a
        00402cfc 56              PUSH       ESI
        00402cfd 50              PUSH       EAX
        00402cfe a1 f8 f1        MOV        EAX,[DAT_0040f1f8]                               = 00005EBFh
                 40 00
        00402d03 c1 e9 03        SHR        ECX,0x3
        00402d06 33 c1           XOR        EAX,ECX
        00402d08 35 9b 1d        XOR        EAX,0xaa6e1d9b
                 6e aa
        00402d0d 50              PUSH       EAX
        00402d0e a1 f4 f1        MOV        EAX,[DAT_0040f1f4]                               = 00002673h
                 40 00
        00402d13 8b 4d f0        MOV        ECX,dword ptr [EBP + local_14]
        00402d16 23 c1           AND        EAX,ECX
        00402d18 35 9a 6d        XOR        EAX,0xc6a96d9a
                 a9 c6
        00402d1d 50              PUSH       EAX
        00402d1e e8 2e 8f        CALL       FUN_0040bc51                                     ushort FUN_0040bc51(void)
                 00 00
        00402d23 66 89 45 f8     MOV        word ptr [EBP + local_c],AX
        00402d27 80 fd 7d        CMP        CH,0x7d
        00402d2a 8b 45 c8        MOV        EAX,dword ptr [EBP + local_3c]
        00402d2d 8b 0d b0        MOV        ECX,dword ptr [PTR_DAT_00410ab0]                 = 00410938
                 0a 41 00
        00402d33 8b 89 9c        MOV        ECX,dword ptr [ECX + 0x19c]=>PTR_DAT_00410ad4    = 0040e558
                 01 00 00
        00402d39 bb 21 e3        MOV        EBX,0x2e321
                 02 00
        00402d3e 33 c3           XOR        EAX,EBX
        00402d40 be 21 b7        MOV        ESI,0xab721
                 0a 00
        00402d45 03 c6           ADD        EAX,ESI
        00402d47 39 01           CMP        dword ptr [ECX]=>DAT_0040e558,EAX                = 00586C14h
        00402d49 0f 84 89        JZ         LAB_004042d8
                 15 00 00
        00402d4f f6 05 80        TEST       byte ptr [DAT_00410b80],0x1
                 0b 41 00 01
        00402d56 75 11           JNZ        LAB_00402d69
        00402d58 a1 38 00        MOV        EAX,[->KERNEL32.DLL::GetDriveTypeA]              = 00020526
                 42 00
        00402d5d 83 0d 80        OR         dword ptr [DAT_00410b80],0x1
                 0b 41 00 01
        00402d64 a3 98 06        MOV        [DAT_00410698],EAX
                 41 00
                             LAB_00402d69                                    XREF[1]:     00402d56(j)  
        00402d69 8b 45 c8        MOV        EAX,dword ptr [EBP + local_3c]
        00402d6c 33 c3           XOR        EAX,EBX
        00402d6e 03 c6           ADD        EAX,ESI
        00402d70 89 45 dc        MOV        dword ptr [EBP + local_28],EAX
        00402d73 3a d6           CMP        DL,DH
        00402d75 8b 0d 1c        MOV        ECX,dword ptr [DAT_0040f21c]                     = 00000C04h
                 f2 40 00
        00402d7b a1 18 f2        MOV        EAX,[DAT_0040f218]                               = 000034CDh
                 40 00
        00402d80 d1 e9           SHR        ECX,0x1
        00402d82 0f af c1        IMUL       EAX,ECX
        00402d85 8b 0d 14        MOV        ECX,dword ptr [DAT_0040f214]                     = 00003DB0h
                 f2 40 00
        00402d8b 0b c8           OR         ECX,EAX
        00402d8d 89 4d fc        MOV        dword ptr [EBP + local_8],ECX
        00402d90 0f b7 05        MOVZX      EAX,word ptr [DAT_0040f220]                      = 5971h
                 20 f2 40 00
        00402d97 25 c9 6f        AND        EAX,0x6fc9
                 00 00
        00402d9c 69 c0 d7        IMUL       EAX,EAX,0x6bd7
                 6b 00 00
        00402da2 f6 05 80        TEST       byte ptr [DAT_00410b80],0x2
                 0b 41 00 02
        00402da9 66 89 45 f8     MOV        word ptr [EBP + local_c],AX
        00402dad c7 45 f8        MOV        dword ptr [EBP + local_c],0xfff7abfe
                 fe ab f7 ff
        00402db4 75 11           JNZ        LAB_00402dc7
        00402db6 a1 3c 00        MOV        EAX,[->KERNEL32.DLL::WriteFile]                  = 0002051a
                 42 00
        00402dbb 83 0d 80        OR         dword ptr [DAT_00410b80],0x2
                 0b 41 00 02
        00402dc2 a3 94 06        MOV        [DAT_00410694],EAX
                 41 00
                             LAB_00402dc7                                    XREF[1]:     00402db4(j)  
        00402dc7 8b 45 f8        MOV        EAX,dword ptr [EBP + local_c]
        00402dca 33 c3           XOR        EAX,EBX
        00402dcc 03 c6           ADD        EAX,ESI
        00402dce 89 45 f8        MOV        dword ptr [EBP + local_c],EAX
        00402dd1 66 a1 28        MOV        AX,[DAT_0040f228]                                = 2693h
                 f2 40 00
        00402dd7 0f b7 c0        MOVZX      EAX,AX
        00402dda 99              CDQ
        00402ddb b9 b8 3e        MOV        ECX,0x3eb8
                 00 00
        00402de0 f7 f9           IDIV       ECX
        00402de2 8a 0d 24        MOV        CL,byte ptr [DAT_0040f224]                       = 0Ch
                 f2 40 00
        00402de8 6a 40           PUSH       0x40
        00402dea 0f b7 c2        MOVZX      EAX,DX
        00402ded d3 e8           SHR        EAX,CL
        00402def 33 d2           XOR        EDX,EDX
        00402df1 66 89 45 f4     MOV        word ptr [EBP + local_10],AX
        00402df5 a1 30 f2        MOV        EAX,[DAT_0040f230]                               = 0000681Ah
                 40 00
        00402dfa 8b 0d 2c        MOV        ECX,dword ptr [DAT_0040f22c]                     = 00005430h
                 f2 40 00
        00402e00 69 c0 fc        IMUL       EAX,EAX,0x15fc
                 15 00 00
        00402e06 c1 e8 16        SHR        EAX,0x16
        00402e09 23 c8           AND        ECX,EAX
        00402e0b 58              POP        EAX
        00402e0c f7 f1           DIV        ECX
        00402e0e ba 03 41        MOV        EDX,0x4103
                 00 00
        00402e13 89 45 f0        MOV        dword ptr [EBP + local_14],EAX
        00402e16 8b 45 f0        MOV        EAX,dword ptr [EBP + local_14]
        00402e19 66 8b 04        MOV        AX,word ptr [EAX*0x2 + 0x40f238]=>DAT_0040f23c   = 65A3h
                 45 38 f2 
                 40 00
        00402e21 66 8b 0d        MOV        CX,word ptr [DAT_0040f234]                       = 44C5h
                 34 f2 40 00
        00402e28 66 0f af ca     IMUL       CX,DX
        00402e2c 66 0b c1        OR         AX,CX
        00402e2f 66 8b 4d f4     MOV        CX,word ptr [EBP + local_10]
        00402e33 66 3b c8        CMP        CX,AX
        00402e36 76 72           JBE        LAB_00402eaa
        00402e38 9f              LAHF
        00402e39 63 e3           ARPL       BX,SP
        00402e3b b7 c9           MOV        BH,0xc9
        00402e3d 49              DEC        ECX
        00402e3e 1d 35 63        SBB        EAX,0x3aac6335
                 ac 3a
        00402e43 cd 32           INT        0x32
        00402e45 5c              POP        ESP
        00402e46 cd 7f           INT        0x7f
        00402e48 e5 00           IN         EAX,0x0
        00402e4a 00 00           ADD        byte ptr [EAX],AL
        00402e4c 56              PUSH       ESI
        00402e4d 00 00           ADD        byte ptr [EAX],AL
        00402e4f 00 30           ADD        byte ptr [EAX],DH
        00402e51 46              INC        ESI
        00402e52 c0 7f 4b 6d     SAR        byte ptr [EDI + 0x4b],0x6d
        00402e56 73 4b           JNC        LAB_00402ea2+1
        00402e58 72 36           JC         LAB_00402e8f+1
        00402e5a 4e              DEC        ESI
        00402e5b 58              POP        EAX
        00402e5c 77 57           JA         LAB_00402eb5
        00402e5e 63 49 65        ARPL       word ptr [ECX + 0x65],CX
        00402e61 61              POPAD
        00402e62 4e              DEC        ESI
        00402e63 78 76           JS         LAB_00402ed9+2
        00402e65 39 78 77        CMP        dword ptr [EAX + 0x77],EDI
        00402e68 4a              DEC        EDX
        00402e69 67 4c           DEC        ESP
        00402e6b 4b              DEC        EBX
        00402e6c 5b              POP        EBX
        00402e6d 45              INC        EBP
        00402e6e 73 33           JNC        LAB_00402ea2+1
        00402e70 39 73 79        CMP        dword ptr [EBX + 0x79],ESI
        00402e73 68 72 4e        PUSH       0x33374e72
                 37 33
        00402e78 37              AAA
        00402e79 52              PUSH       EDX
        00402e7a 74 67           JZ         LAB_00402ee3
        00402e7c 43              INC        EBX
        00402e7d 2f              DAS
        00402e7e 66 74 65        JZ         LAB_00402ee6
        00402e81 4c              DEC        ESP
        00402e82 70 71           JO         LAB_00402ef4+1
        00402e84 33 74 4c 57     XOR        ESI,dword ptr [ESP + ECX*0x2 + 0x57]
        00402e88 78 4e           JS         LAB_00402ed5+3
        00402e8a 33 49 52        XOR        ECX,dword ptr [ECX + 0x52]
        00402e8d 58              POP        EAX
        00402e8e 4e              DEC        ESI
                             LAB_00402e8f+1                                  XREF[0,1]:   00402e58(j)  
        00402e8f 7a 76           JP         LAB_00402f07
        00402e91 5a              POP        EDX
        00402e92 7b 41           JNP        LAB_00402ed5
        00402e94 74 56           JZ         LAB_00402ee7+5
        00402e96 52              PUSH       EDX
        00402e97 38 62 56        CMP        byte ptr [EDX + 0x56],AH
        00402e9a 72 73           JC         LAB_00402f0d+2
        00402e9c 39 6a 56        CMP        dword ptr [EDX + 0x56],EBP
        00402e9f 73 4c           JNC        LAB_00402eed
        00402ea1 52              PUSH       EDX
                             LAB_00402ea2+1                                  XREF[0,2]:   00402e56(j), 00402e6e(j)  
        00402ea2 3a 6f 3a        CMP        CH,byte ptr [EDI + 0x3a]
        00402ea5 6d              INSD       ES:EDI,DX
        00402ea6 63 34 47        ARPL       word ptr [EDI + EAX*0x2],SI
        00402ea9 66              ??         66h    f
                             LAB_00402eaa                                    XREF[1]:     00402e36(j)  
        00402eaa 8a 0d 44        MOV        CL,byte ptr [DAT_0040f244]                       = 01h
                 f2 40 00
        00402eb0 b8 e8 6a        MOV        EAX,0x6ae8
                 00 00
                             LAB_00402eb5                                    XREF[1]:     00402e5c(j)  
        00402eb5 66 d3 e0        SHL        AX,CL
        00402eb8 b9 db 64        MOV        ECX,0x64db
                 00 00
        00402ebd 0f b7 c0        MOVZX      EAX,AX
        00402ec0 99              CDQ
        00402ec1 f7 f9           IDIV       ECX
        00402ec3 b9 7e 5b        MOV        ECX,0x5b7e
                 00 00
        00402ec8 66 89 55 f4     MOV        word ptr [EBP + local_10],DX
        00402ecc 66 a1 48        MOV        AX,[DAT_0040f248]                                = 7C29h
                 f2 40 00
        00402ed2 66 0b c1        OR         AX,CX
                             LAB_00402ed5+3                                  XREF[1,1]:   00402e92(j), 00402e88(j)  
                             LAB_00402ed5
        00402ed5 66 8b 4d f4     MOV        CX,word ptr [EBP + local_10]
                             LAB_00402ed9+2                                  XREF[0,1]:   00402e63(j)  
        00402ed9 66 3b c8        CMP        CX,AX
        00402edc 75 7c           JNZ        LAB_00402f59+1
        00402ede 2d 67 7a        SUB        EAX,0x1f4a7a67
                 4a 1f
                             LAB_00402ee3                                    XREF[1]:     00402e7a(j)  
        00402ee3 02 32           ADD        DH=>DAT_00000c1a,byte ptr [EDX]
        00402ee5 55              PUSH       EBP
                             LAB_00402ee6                                    XREF[1]:     00402e7e(j)  
        00402ee6 55              PUSH       EBP
                             LAB_00402ee7+5                                  XREF[0,1]:   00402e94(j)  
        00402ee7 de 9a d0        FICOMP     word ptr [EDX + 0xf17384d0]
                 84 73 f1
                             LAB_00402eed                                    XREF[1]:     00402e9f(j)  
        00402eed d0 3b           SAR        byte ptr [EBX]=>DAT_0002e321,0x1
        00402eef 01 00           ADD        dword ptr [EAX]=>DAT_e0b60518,EAX
        00402ef1 00 60 00        ADD        byte ptr [EAX]=>DAT_e0b60518,AH
                             LAB_00402ef4+1                                  XREF[0,1]:   00402e82(j)  
        00402ef4 00 00           ADD        byte ptr [EAX]=>DAT_e0b60518,AL
        00402ef6 42              INC        EDX
        00402ef7 5f              POP        EDI
        00402ef8 e4 d0           IN         AL,0xd0
        00402efa 34 61           XOR        AL,0x61
                             LAB_00402efc                                    XREF[1]:     00402f59(j)  
        00402efc 7a 36           JP         LAB_00402f33+1
        00402efe 58              POP        EAX
        00402eff 36 3a 39        CMP        BH,byte ptr SS:[ECX]=>DAT_00000c1a
        00402f02 46              INC        ESI
        00402f03 39 48 47        CMP        dword ptr [EAX + 0x47],ECX
        00402f06 5b              POP        EBX
                             LAB_00402f07                                    XREF[1]:     00402e8f(j)  
        00402f07 4f              DEC        EDI
        00402f08 35 6f 58        XOR        EAX,0x762f586f
                 2f 76
                             LAB_00402f0d+2                                  XREF[0,1]:   00402e9a(j)  
        00402f0d 69 35 51        IMUL       ESI,dword ptr [DAT_59364c51],0x69524845
                 4c 36 59 
                 45 48 52 69
        00402f17 35 48 31        XOR        EAX,0x6f643148
                 64 6f
        00402f1c 35 36 34        XOR        EAX,0x62773436
                 77 62
        00402f21 59              POP        ECX
        00402f22 70 42           JO         LAB_00402f64+2
        00402f24 64 39 44        CMP        dword ptr FS:[ECX + EBP*0x2 + 0x68],EAX=>Excep   = 00000000
                 69 68
        00402f29 66 31 68 7b     XOR        word ptr [EAX + 0x7b],BP
        00402f2d 42              INC        EDX
        00402f2e 76 34           JBE        LAB_00402f64
        00402f30 4f              DEC        EDI
        00402f31 49              DEC        ECX
        00402f32 6c              INSB       ES:EDI,DX
                             LAB_00402f33+1                                  XREF[0,1]:   00402efc(j)  
        00402f33 32 6d 46        XOR        CH,byte ptr [EBP + 0x46]
        00402f36 67 47           INC        EDI
        00402f38 59              POP        ECX
        00402f39 48              DEC        EAX
        00402f3a 62 6c 4b 39     BOUND      EBP,dword ptr [EBX + ECX*0x2 + 0x39]
        00402f3e 73 69           JNC        LAB_00402fa8+1
        00402f40 33 6d 6e        XOR        EBP,dword ptr [EBP + 0x6e]
        00402f43 51              PUSH       ECX
        00402f44 53              PUSH       EBX
        00402f45 4f              DEC        EDI
        00402f46 79 76           JNS        LAB_00402fba+4
        00402f48 7b 70           JNP        LAB_00402fba
        00402f4a 70 48           JO         LAB_00402f94
        00402f4c 5b              POP        EBX
        00402f4d 65 59           POP        ECX
        00402f4f 75 79           JNZ        LAB_00402fc9+1
        00402f51 7a 55           JP         LAB_00402fa8
        00402f53 47              INC        EDI
        00402f54 6b 65 4a 61     IMUL       ESP,dword ptr [EBP + 0x4a],0x61
        00402f58 42              INC        EDX
                             LAB_00402f59+1                                  XREF[0,1]:   00402edc(j)  
        00402f59 76 a1           JBE        LAB_00402efc
        00402f5b b0 0a           MOV        AL,0xa
        00402f5d 41              INC        ECX
        00402f5e 00 8b 88        ADD        byte ptr [EBX + 0x19c88],CL
                 9c 01 00
                             LAB_00402f64+2                                  XREF[1,1]:   00402f2e(j), 00402f22(j)  
                             LAB_00402f64
        00402f64 00 8b 80        ADD        byte ptr [EBX + 0x19c80],CL
                 9c 01 00
        00402f6a 00 8b 55        ADD        byte ptr [EBX + 0x5f6f855],CL
                 f8 f6 05
        00402f70 80 0b 41        OR         byte ptr [EBX],0x41
        00402f73 00 04 8b        ADD        byte ptr [EBX + ECX*0x4],AL
        00402f76 00 8b 09        ADD        byte ptr [EBX + 0x3c498b09],CL
                 8b 49 3c
        00402f7c 8d 44 d0 78     LEA        EAX,[EAX + EDX*0x8 + 0x78]
        00402f80 8b 04 08        MOV        EAX,dword ptr [EAX + ECX*0x1]
        00402f83 89 45 f0        MOV        dword ptr [EBP + -0x10],EAX
        00402f86 75 11           JNZ        LAB_00402f99
        00402f88 a1 94 00        MOV        EAX,[->SHLWAPI.DLL::PathParseIconLocationW]      = 000202e6
                 42 00
        00402f8d 83 0d 80        OR         dword ptr [DAT_00410b80],0x4
                 0b 41 00 04
                             LAB_00402f94                                    XREF[1]:     00402f4a(j)  
        00402f94 a3 90 06        MOV        [DAT_00410690],EAX
                 41 00
                             LAB_00402f99                                    XREF[1]:     00402f86(j)  
        00402f99 8b 0d 50        MOV        ECX,dword ptr [DAT_0040f250]                     = 00006792h
                 f2 40 00
        00402f9f a1 4c f2        MOV        EAX,[DAT_0040f24c]                               = 00003A86h
                 40 00
        00402fa4 33 d2           XOR        EDX,EDX
        00402fa6 f7 f1           DIV        ECX
                             LAB_00402fa8+1                                  XREF[1,1]:   00402f51(j), 00402f3e(j)  
                             LAB_00402fa8
        00402fa8 81 f2 90        XOR        EDX,0x3a90
                 3a 00 00
        00402fae c1 ea 03        SHR        EDX,0x3
        00402fb1 89 55 f4        MOV        dword ptr [EBP + -0xc],EDX
        00402fb4 8b 0d 6c        MOV        ECX,dword ptr [DAT_0040f26c]                     = 00005D41h
                 f2 40 00
                             LAB_00402fba+4                                  XREF[1,1]:   00402f48(j), 00402f46(j)  
                             LAB_00402fba
        00402fba a1 70 f2        MOV        EAX,[DAT_0040f270]                               = 00002E06h
                 40 00
        00402fbf 33 d2           XOR        EDX,EDX
        00402fc1 f7 f1           DIV        ECX
        00402fc3 81 c2 63        ADD        EDX,0x2ea9ff63
                 ff a9 2e
                             LAB_00402fc9+1                                  XREF[0,1]:   00402f4f(j)  
        00402fc9 89 55 f8        MOV        dword ptr [EBP + -0x8],EDX
        00402fcc eb 5e           JMP        LAB_0040302c
                             LAB_00402fce                                    XREF[1]:     00403050(j)  
        00402fce c7 45 dc        MOV        dword ptr [EBP + -0x24],0x1
                 01 00 00 00
        00402fd5 a1 78 f2        MOV        EAX,[DAT_0040f278]                               = 00007A05h
                 40 00
        00402fda 8a 4d dc        MOV        CL,byte ptr [EBP + -0x24]
        00402fdd 0d c0 4d        OR         EAX,0x4dc0
                 00 00
        00402fe2 d3 e8           SHR        EAX,CL
        00402fe4 33 d2           XOR        EDX,EDX
        00402fe6 35 e3 3f        XOR        EAX,0x3fe3
                 00 00
        00402feb 89 45 dc        MOV        dword ptr [EBP + -0x24],EAX
        00402fee 8b 45 dc        MOV        EAX,dword ptr [EBP + -0x24]
        00402ff1 8b 0c 85        MOV        ECX,dword ptr [EAX*0x4 + 0x40f27c]=>DAT_0040f280 = 00000005h
                 7c f2 40 00
        00402ff8 a1 74 f2        MOV        EAX,[DAT_0040f274]                               = 000068C5h
                 40 00
        00402ffd f7 f1           DIV        ECX
        00402fff 05 d9 60        ADD        EAX,0x60d9
                 00 00
        00403004 89 45 fc        MOV        dword ptr [EBP + -0x4],EAX
        00403007 8b 45 f4        MOV        EAX,dword ptr [EBP + -0xc]
        0040300a 8a 0c 85        MOV        CL,byte ptr [EAX*0x4 + 0x40f258]=>DAT_0040f260   = 09h
                 58 f2 40 00
        00403011 8b 15 54        MOV        EDX,dword ptr [DAT_0040f254]                     = 000003D8h
                 f2 40 00
        00403017 81 c2 5e        ADD        EDX,0x1e5e
                 1e 00 00
        0040301d d3 e2           SHL        EDX,CL
        0040301f b8 6d 44        MOV        EAX,0x446d
                 00 00
        00403024 c1 ea 08        SHR        EDX,0x8
        00403027 2b c2           SUB        EAX,EDX
        00403029 01 45 f8        ADD        dword ptr [EBP + -0x8],EAX
                             LAB_0040302c                                    XREF[1]:     00402fcc(j)  
        0040302c 8b 0d 68        MOV        ECX,dword ptr [DAT_0040f268]                     = 000028ADh
                 f2 40 00
        00403032 b8 a3 3f        MOV        EAX,0x3fa3
                 00 00
        00403037 2b c1           SUB        EAX,ECX
        00403039 8a 0d 64        MOV        CL,byte ptr [DAT_0040f264]                       = 0Ch
                 f2 40 00
        0040303f d3 e8           SHR        EAX,CL
        00403041 8b 4d f8        MOV        ECX,dword ptr [EBP + -0x8]
        00403044 0d a5 6b        OR         EAX,0x6ba5
                 00 00
        00403049 05 d4 c1        ADD        EAX,0x2ea9c1d4
                 a9 2e
        0040304e 3b c8           CMP        ECX,EAX
        00403050 0f 82 78        JC         LAB_00402fce
                 ff ff ff
        00403056 8b 45 f0        MOV        EAX,dword ptr [EBP + -0x10]
        00403059 85 c0           TEST       EAX,EAX
        0040305b 0f 85 b4        JNZ        LAB_00403115
                 00 00 00
        00403061 a0 91 f2        MOV        AL,[DAT_0040f291]                                = 93h
                 40 00
        00403066 0f b6 0d        MOVZX      ECX,byte ptr [DAT_0040f290]                      = 9Fh
                 90 f2 40 00
        0040306d 0f b6 c0        MOVZX      EAX,AL
        00403070 23 c8           AND        ECX,EAX
        00403072 81 e1 8b        AND        ECX,0x8b
                 00 00 00
        00403078 88 4d cf        MOV        byte ptr [EBP + -0x31],CL
        0040307b a0 92 f2        MOV        AL,[DAT_0040f292]                                = 55h
                 40 00
        00403080 b1 1c           MOV        CL,0x1c
        00403082 f6 e9           IMUL       CL
        00403084 8a 4d cf        MOV        CL,byte ptr [EBP + -0x31]
        00403087 04 39           ADD        AL,0x39
        00403089 3a c8           CMP        CL,AL
        0040308b 0f 86 fa        JBE        LAB_0040408b
                 0f 00 00
        00403091 3a ac 0f        CMP        CH,byte ptr [EDI + ECX*0x1 + 0x9b2182b5]
                 b5 82 21 9b
        00403098 14 ea           ADC        AL,0xea
        0040309a 33 f2           XOR        ESI,EDX
        0040309c 5c              POP        ESP
        0040309d 91              XCHG       EAX,ECX
        0040309e c3              RET
