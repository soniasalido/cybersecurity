```
                             //
                             // LOL0 
                             // ram:00401000-ram:00407fff
                             //
                             **************************************************************
                             *                          FUNCTION                          *
                             **************************************************************
                             undefined __cdecl FUN_00401000(byte * param_1, undefined
                               assume FS_OFFSET = 0xffdff000
             undefined         <UNASSIGNED>   <RETURN>
             byte *            Stack[0x4]:4   param_1                                 XREF[6]:     00401004(R), 
                                                                                                   00401019(R), 
                                                                                                   00401026(R), 
                                                                                                   0040104b(R), 
                                                                                                   00401059(R), 
                                                                                                   0040108a(R)  
             undefined1 *      Stack[0x8]:4   param_2                                 XREF[4]:     0040100e(R), 
                                                                                                   00401039(R), 
                                                                                                   0040107b(R), 
                                                                                                   004010a4(R)  
             int               Stack[0xc]:4   param_3                                 XREF[2]:     00401045(R), 
                                                                                                   00401084(R)  
             undefined1        Stack[-0x5]:1  local_5                                 XREF[3]:     00401072(W), 
                                                                                                   00401077(W), 
                                                                                                   0040107e(R)  
             undefined1        Stack[-0x6]:1  local_6                                 XREF[3]:     0040109b(W), 
                                                                                                   004010a0(W), 
                                                                                                   004010a7(R)  
                             FUN_00401000                                    XREF[10]:    004001f4(*), 
                                                                                          FUN_004010b1:0040114d(c), 
                                                                                          entry:0040af66(*), 
                                                                                          entry:0040af6c(*), 
                                                                                          entry:0040af73(W), 
                                                                                          entry:0040b005(*), 
                                                                                          entry:0040b008(W), 
                                                                                          entry:0040b014(*), 
                                                                                          entry:0040b019(W), 
                                                                                          entry:0040b032(R)  
        00401000 55              PUSH       EBP
                             LAB_00401001                                    XREF[5]:     entry:0040b008(W), 
                                                                                          entry:0040b032(R), 
                                                                                          entry:0040b03b(R), 
                                                                                          entry:0040b040(R), 
                                                                                          entry:0040b055(W)  
        00401001 8b ec           MOV        EBP,ESP
        00401003 51              PUSH       ECX
                             LAB_00401004+1                                  XREF[1,1]:   entry:0040b019(W), 
                             LAB_00401004                                                 entry:0040b042(R)  
        00401004 8b 45 08        MOV        EAX,dword ptr [EBP + param_1]
        00401007 33 c9           XOR        ECX,ECX
        00401009 8a 08           MOV        CL,byte ptr [EAX]
        0040100b c1 f9 02        SAR        ECX,0x2
        0040100e 8b 55 0c        MOV        EDX,dword ptr [EBP + param_2]
        00401011 8a 81 e8        MOV        AL,byte ptr [ECX + s_ABCDEFGHIJKLMNOPQRSTUVWXY   = "ABCDEFGHIJKLMNOPQRSTUVWXYZabc
                 50 40 00
        00401017 88 02           MOV        byte ptr [EDX],AL
        00401019 8b 4d 08        MOV        ECX,dword ptr [EBP + param_1]
        0040101c 33 d2           XOR        EDX,EDX
        0040101e 8a 11           MOV        DL,byte ptr [ECX]
        00401020 83 e2 03        AND        EDX,0x3
        00401023 c1 e2 04        SHL        EDX,0x4
        00401026 8b 45 08        MOV        EAX,dword ptr [EBP + param_1]
        00401029 33 c9           XOR        ECX,ECX
        0040102b 8a 48 01        MOV        CL,byte ptr [EAX + 0x1]
        0040102e 81 e1 f0        AND        ECX,0xf0
                 00 00 00
        00401034 c1 f9 04        SAR        ECX,0x4
        00401037 0b d1           OR         EDX,ECX
        00401039 8b 45 0c        MOV        EAX,dword ptr [EBP + param_2]
        0040103c 8a 8a e8        MOV        CL,byte ptr [EDX + s_ABCDEFGHIJKLMNOPQRSTUVWXY   = "ABCDEFGHIJKLMNOPQRSTUVWXYZabc
                 50 40 00
        00401042 88 48 01        MOV        byte ptr [EAX + 0x1],CL
        00401045 83 7d 10 01     CMP        dword ptr [EBP + param_3],0x1
        00401049 7e 2c           JLE        LAB_00401077
        0040104b 8b 55 08        MOV        EDX,dword ptr [EBP + param_1]
        0040104e 33 c0           XOR        EAX,EAX
        00401050 8a 42 01        MOV        AL,byte ptr [EDX + 0x1]
        00401053 83 e0 0f        AND        EAX,0xf
        00401056 c1 e0 02        SHL        EAX,0x2
        00401059 8b 4d 08        MOV        ECX,dword ptr [EBP + param_1]
        0040105c 33 d2           XOR        EDX,EDX
        0040105e 8a 51 02        MOV        DL,byte ptr [ECX + 0x2]
        00401061 81 e2 c0        AND        EDX,0xc0
                 00 00 00
        00401067 c1 fa 06        SAR        EDX,0x6
        0040106a 0b c2           OR         EAX,EDX
        0040106c 8a 80 e8        MOV        AL,byte ptr [EAX + s_ABCDEFGHIJKLMNOPQRSTUVWXY   = "ABCDEFGHIJKLMNOPQRSTUVWXYZabc
                 50 40 00
        00401072 88 45 ff        MOV        byte ptr [EBP + local_5],AL
        00401075 eb 04           JMP        LAB_0040107b
                             LAB_00401077                                    XREF[1]:     00401049(j)  
        00401077 c6 45 ff 3d     MOV        byte ptr [EBP + local_5],0x3d
                             LAB_0040107b                                    XREF[1]:     00401075(j)  
        0040107b 8b 4d 0c        MOV        ECX,dword ptr [EBP + param_2]
        0040107e 8a 55 ff        MOV        DL,byte ptr [EBP + local_5]
        00401081 88 51 02        MOV        byte ptr [ECX + 0x2],DL
        00401084 83 7d 10 02     CMP        dword ptr [EBP + param_3],0x2
        00401088 7e 16           JLE        LAB_004010a0
        0040108a 8b 45 08        MOV        EAX,dword ptr [EBP + param_1]
        0040108d 33 c9           XOR        ECX,ECX
        0040108f 8a 48 02        MOV        CL,byte ptr [EAX + 0x2]
        00401092 83 e1 3f        AND        ECX,0x3f
        00401095 8a 91 e8        MOV        DL,byte ptr [ECX + s_ABCDEFGHIJKLMNOPQRSTUVWXY   = "ABCDEFGHIJKLMNOPQRSTUVWXYZabc
                 50 40 00
        0040109b 88 55 fe        MOV        byte ptr [EBP + local_6],DL
        0040109e eb 04           JMP        LAB_004010a4
                             LAB_004010a0                                    XREF[1]:     00401088(j)  
        004010a0 c6 45 fe 3d     MOV        byte ptr [EBP + local_6],0x3d
                             LAB_004010a4                                    XREF[1]:     0040109e(j)  
        004010a4 8b 45 0c        MOV        EAX,dword ptr [EBP + param_2]
        004010a7 8a 4d fe        MOV        CL,byte ptr [EBP + local_6]
        004010aa 88 48 03        MOV        byte ptr [EAX + 0x3],CL
        004010ad 8b e5           MOV        ESP,EBP
        004010af 5d              POP        EBP
        004010b0 c3              RET

        
```

La funci√≥n FUN_00401000 implementa un bloque de codificaci√≥n Base64, es decir, convierte hasta 3 bytes de entrada en 4 caracteres ASCII seg√∫n el alfabeto Base64.

üö® ¬øPor qu√© es relevante en malware?

Codificar en Base64 puede tener m√∫ltiples prop√≥sitos:
- Ocultar o camuflar:
    - Comandos C2.
    - Nombres de API.
    - Payloads.
- Preparar contenido para transmitir por red (URLs, HTTP, etc.).
