# xor_bruteforce.py

def is_printable(s, threshold=0.9):
    """Devuelve True si m√°s del 90% de los caracteres son ASCII imprimibles."""
    printable = sum([32 <= b < 127 for b in s])
    return printable / len(s) > threshold

with open("bloque_raro.bin", "rb") as f:
    data = f.read()

for key in range(256):
    result = bytes([b ^ key for b in data])
    if is_printable(result):
        print(f"\n[+] Posible clave: {key:#02x}")
        print(result.decode(errors="replace"))
