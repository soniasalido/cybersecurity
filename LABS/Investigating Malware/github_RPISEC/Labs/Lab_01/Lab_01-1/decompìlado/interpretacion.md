
## Contenido en formato hexadecimal y desensamblado de la muestra de malware

```
                             //
                             // Headers
                             // ram:00400000-ram:004003ff
                             //
             assume DF = 0x0  (Default)
                             IMAGE_DOS_HEADER_00400000      XREF[1]:     00400114(*)
        00400000 4d 5a 90        IMAGE_DO
                 00 03 00
                 00 00 04
           00400000 4d 5a           char[2]   "MZ"        e_magic       XREF[1]:     00400114(*)
```
El encabezado DOS (DOS header) de un archivo PE (Portable Executable) de Windows, que es la estructura inicial de cualquier ejecutable .exe o .dll. Esta estructura se llama **IMAGE_DOS_HEADER**, y es la primera parte de un ejecutable en Windows. 

El **IMAGE_DOS_HEADER** es necesario para que Windows lo reconozca como ejecutable.

-------
### üìå 00400000 ‚Üí Campo e_magic

```
00400000 4D 5A           // "MZ"
```
Esto es el campo e_magic, que contiene "MZ", las iniciales de Mark Zbikowski, uno de los creadores del formato. Es una firma m√°gica que le dice al sistema: ‚Äúesto es un archivo ejecutable‚Äù.

-------

### üìå 0040003c ‚Üí Donde comienza la estructura PE
```
0040003c e0 00 00 00     ddw       E0h  e_lfanew      File address of ne
```
e_lfanew apunta a la offset donde comienza la estructura PE (Portable Executable) real. En este caso, es 0xE0, o sea, el encabezado PE est√° en 00400000 + 0xE0 = 004000E0.

-------

### üìå 00400040 ‚Üí Programa DOS "dummy"
```
00400040 0e 1f ba 0e 00  db[64]   e_program     Actual DOS program
         b4 09 cd 21 b8
         01 4c cd 21 54
```
Este bloque representa el programa DOS "dummy" que se ejecuta si alguien intenta lanzar este .exe en MS-DOS. Es una mini rutina en ensamblador x86 que imprime: "This program cannot be run in DOS mode."

Esto no tiene relevancia en reversing moderno, pero es necesario para cumplir con el formato PE.

-------


### üìå 004000E0 ‚Üí Inicio del encabezado PE
```
004000e0 50 45 00        IMAGE_NT      = 000022e0
         00 4c 01                      = 21D4h
         04 00 09
```

004000E0 50 45 00 00

‚úÖ Esto es clave:
- 50 45 = "PE"
- 00 00 = nulls para completar el identificador de 4 bytes: "PE\0\0"
- Marca el inicio del IMAGE_NT_HEADERS.

-------

### üìå 004000E4+ ‚Üí Cabecera de archivo (IMAGE_FILE_HEADER)
```
004000E4 4C 01        // M√°quina: 0x014C ‚Üí x86
004000E6 04 00        // N√∫mero de secciones: 4
004000E8 09 ...       // M√°s campos (timestamp, etc.)
```
- Tipo de arquitectura (x86 = 0x14C, x64 ser√≠a 0x8664)
- N√∫mero de secciones (.text, .data, etc.)
- Tama√±o del optional header
- Caracter√≠sticas del archivo

--------

### üìå 004001D8, 00400200, 00400228, 00400250 ‚Üí Secciones del binario
```
004001d8 2e 74 65        IMAGE_SE   .text    // C√≥digo ejecutable
         78 74 00
         00 00 a6
00400200 2e 72 64        IMAGE_SE    .rdata  // Datos de solo lectura (strings, imports, etc.)
         61 74 61
         00 00 7e
00400228 2e 64 61        IMAGE_SE    .data   // Datos de lectura/escritura (variables globales)
         74 61 00
         00 00 28
00400250 2e 72 73        IMAGE_SE    .rsrc   // Recursos (√≠conos, men√∫s, etc.)
         72 63 00
         00 00 7c
```

Cada secci√≥n tiene:
- Nombre (".text", ".rdata", etc.)
- Direcci√≥n virtual (RVA)
- Tama√±o
- Offset f√≠sico en el archivo
- 
-------



üéØ Resumen funcional
|Campo |	Direcci√≥n |	Descripci√≥n |
|--|--|--|
|e_magic |	0x00400000 | Firma "MZ" ‚Üí indica que es ejecutable DOS/PE |
| e_lfanew |	0x0040003C |	Offset del encabezado PE (donde empieza lo importante para Windows) |
| e_program | 0x00400040 |	C√≥digo DOS que se ejecuta si se intenta abrir en MS-DOS |
| Program | 00400040| 	Programa DOS (relleno) |
| Firma PE  | 004000E0	Firma PE (PE\0\0) ‚Üí comienza el PE header |
| .text | 004001D8 |	.text section (c√≥digo ejecutable) |
| .rdata | 00400200 |	.rdata (strings, tabla de importaci√≥n) |
| .data | 00400228 |	.data (variables globales) |
| .rsrc | 00400250 |	.rsrc (recursos como √≠conos, GUI, etc) |

