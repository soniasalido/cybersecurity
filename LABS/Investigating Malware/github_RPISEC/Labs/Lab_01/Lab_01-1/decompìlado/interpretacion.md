
## Contenido en formato hexadecimal y desensamblado de la muestra de malware

```
                             //
                             // Headers
                             // ram:00400000-ram:004003ff
                             //
             assume DF = 0x0  (Default)
                             IMAGE_DOS_HEADER_00400000      XREF[1]:     00400114(*)
        00400000 4d 5a 90        IMAGE_DO
                 00 03 00
                 00 00 04
           00400000 4d 5a           char[2]   "MZ"        e_magic       XREF[1]:     00400114(*)
```
El encabezado DOS (DOS header) de un archivo PE (Portable Executable) de Windows, que es la estructura inicial de cualquier ejecutable .exe o .dll. Esta estructura se llama **IMAGE_DOS_HEADER**, y es la primera parte de un ejecutable en Windows. 

El **IMAGE_DOS_HEADER** es necesario para que Windows lo reconozca como ejecutable.

-------

```
00400000 4D 5A           // "MZ"
```
Esto es el campo e_magic, que contiene "MZ", las iniciales de Mark Zbikowski, uno de los creadores del formato. Es una firma m√°gica que le dice al sistema: ‚Äúesto es un archivo ejecutable‚Äù.

-------
```
0040003c e0 00 00 00     ddw       E0h  e_lfanew      File address of ne
```
e_lfanew apunta a la offset donde comienza la estructura PE (Portable Executable) real. En este caso, es 0xE0, o sea, el encabezado PE est√° en 00400000 + 0xE0 = 004000E0.

-------

```
00400040 0e 1f ba 0e 00  db[64]   e_program     Actual DOS program
         b4 09 cd 21 b8
         01 4c cd 21 54
```
Este bloque representa el programa DOS "dummy" que se ejecuta si alguien intenta lanzar este .exe en MS-DOS. Es una mini rutina en ensamblador x86 que imprime: "This program cannot be run in DOS mode."

Esto no tiene relevancia en reversing moderno, pero es necesario para cumplir con el formato PE.

-------


üìå ###004000E0 ‚Üí Inicio del encabezado PE
```
004000e0 50 45 00        IMAGE_NT      = 000022e0
         00 4c 01                      = 21D4h
         04 00 09
```

‚úÖ Esto es clave:
50 45 = "PE"
00 00 = nulls para completar el identificador de 4 bytes: "PE\0\0"

Marca el inicio del IMAGE_NT_HEADERS.

-------

üéØ Resumen funcional
|Campo |	Direcci√≥n |	Descripci√≥n |
|--|--|--|
|e_magic |	0x00400000 | Firma "MZ" ‚Üí indica que es ejecutable DOS/PE |
| e_lfanew |	0x0040003C |	Offset del encabezado PE (donde empieza lo importante para Windows) |
| e_program | 0x00400040 |	C√≥digo DOS que se ejecuta si se intenta abrir en MS-DOS |

