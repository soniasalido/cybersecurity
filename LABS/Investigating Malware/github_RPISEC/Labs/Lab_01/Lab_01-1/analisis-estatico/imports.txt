[0x00401cda]> ii
[Imports]
nth vaddr      bind type lib          name
‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï‚Äï
1   0x00402000 NONE FUNC KERNEL32.dll CloseHandle
2   0x00402004 NONE FUNC KERNEL32.dll WaitForSingleObject
3   0x00402008 NONE FUNC KERNEL32.dll CreateEventA
4   0x0040200c NONE FUNC KERNEL32.dll ExitThread
5   0x00402010 NONE FUNC KERNEL32.dll Sleep
6   0x00402014 NONE FUNC KERNEL32.dll GetComputerNameA
7   0x00402018 NONE FUNC KERNEL32.dll CreatePipe
8   0x0040201c NONE FUNC KERNEL32.dll DisconnectNamedPipe
9   0x00402020 NONE FUNC KERNEL32.dll TerminateProcess
10  0x00402024 NONE FUNC KERNEL32.dll WaitForMultipleObjects
11  0x00402028 NONE FUNC KERNEL32.dll TerminateThread
12  0x0040202c NONE FUNC KERNEL32.dll CreateThread
13  0x00402030 NONE FUNC KERNEL32.dll CreateProcessA
14  0x00402034 NONE FUNC KERNEL32.dll DuplicateHandle
15  0x00402038 NONE FUNC KERNEL32.dll GetCurrentProcess
16  0x0040203c NONE FUNC KERNEL32.dll ReadFile
17  0x00402040 NONE FUNC KERNEL32.dll PeekNamedPipe
18  0x00402044 NONE FUNC KERNEL32.dll SetEvent
19  0x00402048 NONE FUNC KERNEL32.dll WriteFile
20  0x0040204c NONE FUNC KERNEL32.dll SetProcessPriorityBoost
21  0x00402050 NONE FUNC KERNEL32.dll SetThreadPriority
22  0x00402054 NONE FUNC KERNEL32.dll GetCurrentThread
23  0x00402058 NONE FUNC KERNEL32.dll SetPriorityClass
24  0x0040205c NONE FUNC KERNEL32.dll lstrcatA
25  0x00402060 NONE FUNC KERNEL32.dll lstrcpyA
26  0x00402064 NONE FUNC KERNEL32.dll GetEnvironmentVariableA
27  0x00402068 NONE FUNC KERNEL32.dll GetShortPathNameA
28  0x0040206c NONE FUNC KERNEL32.dll GetModuleFileNameA
29  0x00402070 NONE FUNC KERNEL32.dll GetStartupInfoA
30  0x00402074 NONE FUNC KERNEL32.dll GetModuleHandleA
1   0x004020e0 NONE FUNC USER32.dll   LoadStringA
1   0x004020d4 NONE FUNC SHELL32.dll  ShellExecuteExA
2   0x004020d8 NONE FUNC SHELL32.dll  SHChangeNotify
1   0x0040207c NONE FUNC MSVCRT.dll   _controlfp
2   0x00402080 NONE FUNC MSVCRT.dll   _beginthread
3   0x00402084 NONE FUNC MSVCRT.dll   _strnicmp
4   0x00402088 NONE FUNC MSVCRT.dll   sprintf
5   0x0040208c NONE FUNC MSVCRT.dll   atol
6   0x00402090 NONE FUNC MSVCRT.dll   strchr
7   0x00402094 NONE FUNC MSVCRT.dll   free
8   0x00402098 NONE FUNC MSVCRT.dll   malloc
9   0x0040209c NONE FUNC MSVCRT.dll   _exit
10  0x004020a0 NONE FUNC MSVCRT.dll   _XcptFilter
11  0x004020a4 NONE FUNC MSVCRT.dll   exit
12  0x004020a8 NONE FUNC MSVCRT.dll   _acmdln
13  0x004020ac NONE FUNC MSVCRT.dll   __getmainargs
14  0x004020b0 NONE FUNC MSVCRT.dll   _initterm
15  0x004020b4 NONE FUNC MSVCRT.dll   __setusermatherr
16  0x004020b8 NONE FUNC MSVCRT.dll   _adjust_fdiv
17  0x004020bc NONE FUNC MSVCRT.dll   __p__commode
18  0x004020c0 NONE FUNC MSVCRT.dll   __p__fmode
19  0x004020c4 NONE FUNC MSVCRT.dll   __set_app_type
20  0x004020c8 NONE FUNC MSVCRT.dll   _except_handler3
21  0x004020cc NONE FUNC MSVCRT.dll   _itoa
9   0x004020e8 NONE FUNC WS2_32.dll   htons
4   0x004020ec NONE FUNC WS2_32.dll   connect
23  0x004020f0 NONE FUNC WS2_32.dll   socket
115 0x004020f4 NONE FUNC WS2_32.dll   WSAStartup
19  0x004020f8 NONE FUNC WS2_32.dll   send
11  0x004020fc NONE FUNC WS2_32.dll   inet_addr
16  0x00402100 NONE FUNC WS2_32.dll   recv
3   0x00402104 NONE FUNC WS2_32.dll   closesocket

--------------------
[0x00401cda]> ii~CreateEventA
3   0x00402008 NONE FUNC KERNEL32.dll CreateEventA
[0x00401cda]> ii~CreateProcessA
13  0x00402030 NONE FUNC KERNEL32.dll CreateProcessA
[0x00401cda]> ii~GetCurrentProcess
15  0x00402038 NONE FUNC KERNEL32.dll GetCurrentProcess
[0x00401cda]> ii~WriteFile
19  0x00402048 NONE FUNC KERNEL32.dll WriteFile
[0x00401cda]> ii~GetCurrentThread
22  0x00402054 NONE FUNC KERNEL32.dll GetCurrentThread
[0x00401cda]> ii~SetPriorityClass
23  0x00402058 NONE FUNC KERNEL32.dll SetPriorityClass
[0x00401cda]> ii~GetEnvironmentVariableA
26  0x00402064 NONE FUNC KERNEL32.dll GetEnvironmentVariableA
[0x00401cda]> ii~ShellExecuteExA
1   0x004020d4 NONE FUNC SHELL32.dll  ShellExecuteExA
[0x00401cda]> ii~SHChangeNotify
2   0x004020d8 NONE FUNC SHELL32.dll  SHChangeNotify


-------------------------------------
IMPORTS que se muestran en pestudio:

Import - Flag   - Type   -- Ordinal  --- First Thunk (IAT)   ---  First Thunk Original (INT)  --- library
CloseHandle,-,implicit,-,0x000022E0,0x000022E0,KERNEL32.dll
WaitForSingleObject,-,implicit,-,0x000022EE,0x000022EE,KERNEL32.dll
CreateEventA,-,implicit,-,0x00002304,0x00002304,KERNEL32.dll
ExitThread,-,implicit,-,0x00002314,0x00002314,KERNEL32.dll
Sleep,-,implicit,-,0x00002322,0x00002322,KERNEL32.dll
GetComputerNameA,-,implicit,-,0x0000232A,0x0000232A,KERNEL32.dll
CreatePipe,x,implicit,-,0x0000233E,0x0000233E,KERNEL32.dll
DisconnectNamedPipe,-,implicit,-,0x0000234C,0x0000234C,KERNEL32.dll
TerminateProcess,-,implicit,-,0x00002362,0x00002362,KERNEL32.dll
WaitForMultipleObjects,-,implicit,-,0x00002376,0x00002376,KERNEL32.dll
TerminateThread,-,implicit,-,0x00002390,0x00002390,KERNEL32.dll
CreateThread,-,implicit,-,0x000023A2,0x000023A2,KERNEL32.dll
CreateProcessA,x,implicit,-,0x000023B2,0x000023B2,KERNEL32.dll
DuplicateHandle,-,implicit,-,0x000023C4,0x000023C4,KERNEL32.dll
GetCurrentProcess,x,implicit,-,0x000023D6,0x000023D6,KERNEL32.dll
ReadFile,-,implicit,-,0x000023EA,0x000023EA,KERNEL32.dll
PeekNamedPipe,-,implicit,-,0x000023F6,0x000023F6,KERNEL32.dll
SetEvent,-,implicit,-,0x00002406,0x00002406,KERNEL32.dll
WriteFile,x,implicit,-,0x00002412,0x00002412,KERNEL32.dll
SetProcessPriorityBoost,-,implicit,-,0x0000241E,0x0000241E,KERNEL32.dll
SetThreadPriority,-,implicit,-,0x00002438,0x00002438,KERNEL32.dll
GetCurrentThread,x,implicit,-,0x0000244C,0x0000244C,KERNEL32.dll
SetPriorityClass,x,implicit,-,0x00002460,0x00002460,KERNEL32.dll
lstrcatA,-,implicit,-,0x00002474,0x00002474,KERNEL32.dll
lstrcpyA,-,implicit,-,0x00002480,0x00002480,KERNEL32.dll
GetEnvironmentVariableA,x,implicit,-,0x0000248C,0x0000248C,KERNEL32.dll
GetShortPathNameA,-,implicit,-,0x000024A6,0x000024A6,KERNEL32.dll
GetModuleFileNameA,-,implicit,-,0x000024BA,0x000024BA,KERNEL32.dll
GetStartupInfoA,-,implicit,-,0x00002664,0x00002664,KERNEL32.dll
GetModuleHandleA,-,implicit,-,0x00002650,0x00002650,KERNEL32.dll
LoadStringA,-,implicit,-,0x000024DE,0x000024DE,USER32.dll
ShellExecuteExA,x,implicit,-,0x0000250A,0x0000250A,SHELL32.dll
SHChangeNotify,x,implicit,-,0x000024F8,0x000024F8,SHELL32.dll
_controlfp,-,implicit,-,0x0000262A,0x0000262A,MSVCRT.dll
_beginthread,-,implicit,-,0x00002528,0x00002528,MSVCRT.dll
_strnicmp,-,implicit,-,0x00002538,0x00002538,MSVCRT.dll
sprintf,-,implicit,-,0x00002544,0x00002544,MSVCRT.dll
atol,-,implicit,-,0x0000254E,0x0000254E,MSVCRT.dll
strchr,-,implicit,-,0x00002556,0x00002556,MSVCRT.dll
free,-,implicit,-,0x00002560,0x00002560,MSVCRT.dll
malloc,-,implicit,-,0x00002568,0x00002568,MSVCRT.dll
_exit,-,implicit,-,0x0000257E,0x0000257E,MSVCRT.dll
_XcptFilter,-,implicit,-,0x00002586,0x00002586,MSVCRT.dll
exit,-,implicit,-,0x00002594,0x00002594,MSVCRT.dll
_acmdln,-,implicit,-,0x0000259C,0x0000259C,MSVCRT.dll
__getmainargs,-,implicit,-,0x000025A6,0x000025A6,MSVCRT.dll
_initterm,-,implicit,-,0x000025B6,0x000025B6,MSVCRT.dll
__setusermatherr,-,implicit,-,0x000025C2,0x000025C2,MSVCRT.dll
_adjust_fdiv,-,implicit,-,0x000025D6,0x000025D6,MSVCRT.dll
__p__commode,-,implicit,-,0x000025E6,0x000025E6,MSVCRT.dll
__p__fmode,-,implicit,-,0x000025F6,0x000025F6,MSVCRT.dll
__set_app_type,-,implicit,-,0x00002604,0x00002604,MSVCRT.dll
_except_handler3,-,implicit,-,0x00002616,0x00002616,MSVCRT.dll
_itoa,-,implicit,-,0x00002676,0x00002676,MSVCRT.dll
9 (htons),x,implicit,x,0x80000009,0x80000009,WS2_32.dll
4 (connect),x,implicit,x,0x80000004,0x80000004,WS2_32.dll
23 (socket),x,implicit,x,0x80000017,0x80000017,WS2_32.dll
115 (WSAStartup),-,implicit,x,0x80000073,0x80000073,WS2_32.dll
19 (send),x,implicit,x,0x80000013,0x80000013,WS2_32.dll
11 (inet_addr),x,implicit,x,0x8000000B,0x8000000B,WS2_32.dll
16 (recv),x,implicit,x,0x80000010,0x80000010,WS2_32.dll
3 (closesocket),x,implicit,x,0x80000003,0x80000003,WS2_32.dll


üìÑ DLLs importadas (en orden):

    KERNEL32.dll

    USER32.dll

    GDI32.dll

    ADVAPI32.dll

    SHELL32.dll

    OLE32.dll

    OLEAUT32.dll

    COMCTL32.dll

    COMDLG32.dll

    WS2_32.dll



üîç An√°lisis por bloques:
üß± B√°sico del sistema:

    KERNEL32.dll: funciones esenciales del sistema (procesos, archivos, memoria).

    USER32.dll: interfaz de usuario.

    GDI32.dll: gr√°ficos y dibujo.

    ‚Üí Requisitos m√≠nimos para GUI y ejecuci√≥n est√°ndar.

üß∞ Componentes avanzados y COM:

    ADVAPI32.dll: registro, servicios.

    OLE32.dll y OLEAUT32.dll: automatizaci√≥n COM/OLE.

    COMCTL32.dll, COMDLG32.dll: controles comunes de interfaz (di√°logos, botones, ventanas comunes).

    ‚Üí Implica uso de componentes gr√°ficos sofisticados y objetos COM, t√≠pico en malware que se disfraza de programas leg√≠timos o tiene GUI elaborada.

üåê Red:

    WS2_32.dll: funciones de sockets Winsock (comunicaci√≥n por red).

    ‚Üí Capacidad de conectarse a red, enviar/recibir datos. Clave en malware que act√∫a como troyano, RAT, downloader, etc.

üß† Conclusiones que puedes extraer:
Aspecto	Indicio
Interfaz gr√°fica avanzada	Uso de USER32, GDI32, COMDLG32, COMCTL32
Comunicaci√≥n con red	Presencia de WS2_32
Automatizaci√≥n / COM	Presencia de OLE32 y OLEAUT32
Posible malware troyano o RAT	S√≠, alto potencial. Tiene herramientas para red, GUI y manipulaci√≥n del sistema.


Imports:

Address	Ordinal	Name	Library
00402000		CloseHandle	KERNEL32
00402008		CreateEventA	KERNEL32
00402018		CreatePipe	KERNEL32
00402030		CreateProcessA	KERNEL32
0040202C		CreateThread	KERNEL32
0040201C		DisconnectNamedPipe	KERNEL32
00402034		DuplicateHandle	KERNEL32
0040200C		ExitThread	KERNEL32
00402014		GetComputerNameA	KERNEL32
00402038		GetCurrentProcess	KERNEL32
00402054		GetCurrentThread	KERNEL32
00402064		GetEnvironmentVariableA	KERNEL32
0040206C		GetModuleFileNameA	KERNEL32
00402074		GetModuleHandleA	KERNEL32
00402068		GetShortPathNameA	KERNEL32
00402070		GetStartupInfoA	KERNEL32
004020E0		LoadStringA	USER32
00402040		PeekNamedPipe	KERNEL32
0040203C		ReadFile	KERNEL32
004020D8		SHChangeNotify	SHELL32
00402044		SetEvent	KERNEL32
00402058		SetPriorityClass	KERNEL32
0040204C		SetProcessPriorityBoost	KERNEL32
00402050		SetThreadPriority	KERNEL32
004020D4		ShellExecuteExA	SHELL32
00402010		Sleep	KERNEL32
00402020		TerminateProcess	KERNEL32
00402028		TerminateThread	KERNEL32
00402024		WaitForMultipleObjects	KERNEL32
00402004		WaitForSingleObject	KERNEL32
00402048		WriteFile	KERNEL32
004020A0		_XcptFilter	MSVCRT
004020AC		__getmainargs	MSVCRT
004020F4	115	__imp_WSAStartup	WS2_32
00402104	3	__imp_closesocket	WS2_32
004020EC	4	__imp_connect	WS2_32
004020E8	9	__imp_htons	WS2_32
004020FC	11	__imp_inet_addr	WS2_32
00402100	16	__imp_recv	WS2_32
004020F8	19	__imp_send	WS2_32
004020F0	23	__imp_socket	WS2_32
004020BC		__p__commode	MSVCRT
004020C0		__p__fmode	MSVCRT
004020C4		__set_app_type	MSVCRT
004020B4		__setusermatherr	MSVCRT
004020A8		_acmdln	MSVCRT
004020B8		_adjust_fdiv	MSVCRT
00402080		_beginthread	MSVCRT
0040207C		_controlfp	MSVCRT
004020C8		_except_handler3	MSVCRT
0040209C		_exit	MSVCRT
004020B0		_initterm	MSVCRT
004020CC		_itoa	MSVCRT
00402084		_strnicmp	MSVCRT
0040208C		atol	MSVCRT
004020A4		exit	MSVCRT
00402094		free	MSVCRT
0040205C		lstrcatA	KERNEL32
00402060		lstrcpyA	KERNEL32
00402098		malloc	MSVCRT
00402088		sprintf	MSVCRT
00402090		strchr	MSVCRT




üîç IMPORTS SOSPECHOSOS O CLAVE EN MALWARE
üßµ Creaci√≥n y control de procesos e hilos

    CreateProcessA ‚úÖ (muy sospechosa)
    ‚Üí Lanza otros ejecutables. Usada en droppers, inyectores, malware modular.

    CreateThread, BeginThread
    ‚Üí T√≠pico en malware multihilo o inyectores.

    TerminateThread, TerminateProcess
    ‚Üí Peligrosas; cortar procesos puede ocultar actividad o evadir an√°lisis.

üì° Red (WS2_32.dll)

Todas estas son de la API Winsock. Altamente sospechosas en cualquier muestra que no sea una app de red.

    WSAStartup ‚úÖ

    socket ‚úÖ

    connect ‚úÖ

    send, recv, closesocket ‚úÖ

    inet_addr, htons
    ‚Üí Confirma que el malware establece conexiones de red, lo cual es t√≠pico de backdoors, RATs o bots.

üìÇ Manipulaci√≥n de archivos, pipes y entradas/salidas

    CreatePipe, PeekNamedPipe, DisconnectNamedPipe ‚úÖ
    ‚Üí Suele usarse para comunicaci√≥n interprocesos o control encubierto de procesos lanzados.

    ReadFile, WriteFile
    ‚Üí B√°sicas, pero si est√°n junto a CreatePipe pueden implicar captura de salida de otros procesos.

üß† Carga de m√≥dulos y recursos

    LoadStringA
    ‚Üí Si bien com√∫n, puede usarse para cargar recursos cifrados/ocultos.

    GetModuleHandleA, GetModuleFileNameA
    ‚Üí Usadas para self-inspection o para manipular el entorno propio del malware.

üì• Shell e interacci√≥n con el sistema

    ShellExecuteExA ‚úÖ
    ‚Üí Puede lanzar comandos externos, URLs o descargar ejecutables.

üñ•Ô∏è Variables del entorno

    GetEnvironmentVariableA, GetStartupInfoA
    ‚Üí Usadas para modificar comportamiento seg√∫n el entorno (por ejemplo, detectar sandbox).

üíÄ Funciones de evasi√≥n o defensa

    SetProcessPriorityBoost, SetThreadPriority, SetPriorityClass
    ‚Üí Malware puede usar esto para ejecutarse con m√°s prioridad y evitar ser interrumpido.

‚ùå IMPORTS POCO RELEVANTES

Funciones como sprintf, malloc, strchr, free, etc., son est√°ndar en cualquier programa C/C++ y no son especialmente sospechosas por s√≠ solas.
üéØ RESUMEN: funciones que debes vigilar de cerca

    CreateProcessA

    ShellExecuteExA

    WSAStartup, socket, connect, recv, send

    CreatePipe, PeekNamedPipe, DisconnectNamedPipe

    TerminateThread, TerminateProcess

