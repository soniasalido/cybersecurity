## RESUMEN GENERAL DE LA CAPTURA
| Campo |	Valor |
| --| -- |
| IP origen| 	192.168.100.5 (tu VM Windows) |
| IP destino| 	69.25.50.10 |
| Protocolo| 	TLSv1.2 |
| Tipo de paquete| 	Client Hello |
| Puerto destino| 	443 (HTTPS) |
| Hora relativa| 	28.583027 s |

Este paquete es un inicio de conexi칩n segura desde la MV Windows hacia el servidor remoto.

Client Hello es el primer mensaje de la negociaci칩n TLS (handshake).

El malware est치 intentando iniciar una conexi칩n cifrada con el servidor remoto 69.25.50.10.


En el Lab 1.2 de RPISEC, el malware simula un cliente que contacta con un servidor C2 (Command & Control). Usa TLS para cifrar la comunicaci칩n, lo que impide que veamoss directamente el contenido de los comandos sin desencriptar el tr치fico.

### Para desencriptar el tr치fico, podr칤amos:
- Hook de funciones: Usar칤amos una herramienta como Frida o API Monitor para interceptar llamadas a funciones como:
    - InternetReadFile.
    - HttpSendRequestA.
    - send, recv.
    - WinINet.dll o WinHTTP.dll.
- An치lisis de memoria: Usar herramientas como x64dbg o Procmon para ver qu칠 comandos se env칤an o reciben antes del cifrado.
- FakeNet-NG: Usar칤amos la opci칩n -p para emular puertos. Podemos redirigir 69.25.50.10 a la MV Linux con FakeNet usando reglas DNS o en el hosts de Windows.
- TLS proxy / MITM: Podemos crear un entorno donde el malware conf칤e en nuestro certificado TLS para hacer un ataque man-in-the-middle (MITM), por ejemplo con:
    - mitmproxy.
    - Burp Suite.

游빋 쯏 si el malware valida certificados?
Muchos malware verifican los certificados o usan certificate pinning. En ese caso, deber칤amos usar hooking con Frida o instrumentaci칩n din치mica (x64dbg, Procmon, etc.).


## Desencriptar tr치fico con Burpsuite
游빓 Requisitos
- M치quina Linux: con Burp Suite y FakeNet-NG
- M치quina Windows: donde ejecutar치s la muestra
- Ambas conectadas a una red interna compartida
- Malware que no valide el certificado TLS (o puedas forzar que lo acepte)

