    1  sudp apt update
    2  sudo apt update
    3  sudo apt upgrade
    4  cd Descargas/
    5  sudo dpkg -i google-chrome-stable_current_amd64.deb 
    6  sudo apt update
    7  sudo apt upgrade
    8  sudo apt install gir1.2-mutter-13 libmutter-13-0 mutter-common mutter-common-bin
    9  sudo apt update
   10  sudo apt upgrade
   11  sudo apt autoclean 
   12  sudo apt clean
   13  sudo apt update
   14  sudo apt upgrade
   15  sudo gparted
   16  sudo apt install gparted
   17  sudo gparted
   18  sudo reboot
   19  sudo dpkg -i virtualbox-7.0_7.0.14-161095~Ubuntu~jammy_amd64.deb 
   20  sha256sum virtualbox-7.0_7.0.14-161095~Ubuntu~jammy_amd64.deb 
   21  sha256sum Oracle_VM_VirtualBox_Extension_Pack-7.0.14.vbox-extpack 
   22  virtualbox
   23  sudo /sbin/vboxconfig
   24  sudo apt-get install dkms build-essential linux-headers-`uname -r`
   25  apt --fix-broken install
   26  sudo apt --fix-broken install
   27  sudo apt install build-essential 
   28  sudo apt --fix-broken install
   29  sudo apt install build-essential 
   30  sudo apt install build-essential --fix-missing
   31  sudo apt install linux-headers-$(uname -r)
   32  sudo pt --fix-broken install
   33  sudo apt --fix-broken install
   34  sudo apt update
   35  sudo apt upgrade
   36  sudo apt upgrade -f
   37  md5sum Python-2.7.18.tgz 
   38  sudo cp /media/sf_Imgenes-ISO/
   39  sudo cd /media/sf_Imgenes-ISO/
   40  sudo su
   41  sudo apt update
   42  sudo apt upgrade
   43  sudo apt install unzip
   44  sudo apt upgrade
   45  sudo apt autoremove
   46  sudo apt install linux-headers-$(uname -r)
   47  sudo apt install linux-headers-
   48  sudo apt install linux-headers
   49  sudo apt install build-essential 
   50  sudo apt-get install libtirpc-dev
   51  sudo apt-get install build-essential libreadline-dev libncursesw5-dev libssl-dev libsqlite3-dev tk-dev
   52  sudo apt install libgdbm-dev libc6-dev libbz2-dev
   53  cd Descargas/
   54  tar -xzvf Python-2.7.x.tgz
   55  tar -xzvf Python-2.7.18.tgz 
   56  cd Python-2.7.18/
   57  sudo apt-get install zlib1g zlib1g-dev
   58  sudo ./configure --with-zlib
   59  ./configure --enable-optimizations
   60  sudo ./configure --enable-optimizations
   61  sudo make
   62  sudo make install
   63  python2.7 --version
   64  cd ..
   65  sudo apt install curl
   66  curl https://bootstrap.pypa.io/pip/2.7/get-pip.py --output get-pip.py
   67  sudo python2.7 get-pip.py
   68  sudo python2.7 -m pip install -U setuptools wheel
   69  sudo python2.7 -m pip install -U distorm3 yara pycrypto pillow openpyxl
   70  sudo python2.7 ujson pytz ipython capstone
   71  sudo python2.7 pytz ipython capstone
   72  sudo ln -s /usr/local/lib/python2.7/dist-packages/usr/lib/libyara.so /usr/lib/libyara.so
   73  sudo apt install git
   74  git clone https://github.com/volatilityfoundation/volatility.git
   75  sudo chmod +x volatility/vol.py
   76  cd volatility
   77  sudo python setup.py install
   78  vol.py --info
   79  python2.7 vol.py
   80  -h
   81  sudo pip uninstall yara
   82  pip install yara-python
   83  cd ..
   84  git clone --recursive https://github.com/VirusTotal/yara-python
   85  cd yara-python
   86  python setup.py build
   87  sudo python setup.py install
   88  cd ..
   89  cd volatility/
   90  vol.py --info
   91  python2.7 vol.py ~/Escritorio/Win10_22H2_Spanish_x64v1.iso 
   92  python2.7 vol.py -f ~/Escritorio/Win10_22H2_Spanish_x64v1.iso 
   93  python2.7 vol.py -f ~/Escritorio/Win10_22H2_Spanish_x64v1.iso  imageinfo
   94  vol.py -f ~/Escritorio/memdump-windows10-wanacry.mem imageinfo
   95  vol.py -f ~/Escritorio/memdump-windows10-wanacry.mem -h
   96  vol.py -f ~/Escritorio/memdump-windows10-wanacry.mem pstree
   97  python2.7 vol.py -f ~/Escritorio/memdump-windows10-wanacry.mem pstree
   98  python2.7 vol.py -f ~/Escritorio/Windows_RAM.mem pstree
   99  vol.py -f ~/Escritorio/Windows_RAM.mem pstree
  100  vol.py -f ~/Escritorio/Windows_RAM.mem imageinfo
  101  vol.py -f ~/Escritorio/Windows_RAM.mem pstree
  102  vol.py -f ~/Escritorio/Windows_RAM.mem -h
  103  vol.py -f ~/Escritorio/Windows_RAM.mem pslist
  104  vol.py -f ~/Escritorio/Windows_RAM.mem hivelist
  105  vol.py -f ~/Escritorio/Windows_RAM.mem imageinfo
  106  vol.py -f ~/Escritorio/Windows_RAM.mem --profile=Win7SP1x64 pstree
  107  vol.py -f ~/Escritorio/memdump-windows10-wanacry.mem --profile=Win7SP1x64 pstree
  108  vol.py -f ~/Escritorio/memdump-windows10-wanacry.mem imageinfo
  109  vol.py -f ~/Escritorio/memdump-windows10-wanacry.mem --profile=Win10x64_19041 pstree
  110  vol.py -f ~/Escritorio/memdump-windows10-wanacry.mem kdbgscan
  111  vol.py -f ~/Escritorio/memdump-windows10-wanacry.mem --profile=Win10x64_19041 hivelist
  112  cat > rule.yara
  113  strings -a -el file.4676.0xffff9e899e8cbc40.vacb file.4676.0xffff9e899e8cbc40.vacb.txt
  114  strings -a -el file.4676.0xffff9e899e8cbc40.vacb > file.4676.0xffff9e899e8cbc40.vacb.txt
  115  strings -a -n 8 file.4676.0xffff9e899e8cbc40.vacb > strings.txt
  116  strings -a -n 3 file.4676.0xffff9e899e8cbc40.vacb > file.4676.0xffff9e899e8cbc40.vacb.txt
  117  strings -el file.4676.0xffff9e899e8cbc40.vacb > file.4676.0xffff9e899e8cbc40.vacb.Unicode.txt
  118  strings -el /home/usuario/Escritorio/dump/file.3316.0xffff9e899dff5520.vacb > file.3316.0xffff9e899dff5520.vacb.txt
  119  strings -a -n 3 /home/usuario/Escritorio/dump/file.3316.0xffff9e899dff5520.vacb > file.3316.0xffff9e899dff5520.vacb.txt
  120  strings -a -n 3 /home/usuario/Escritorio/dump/file.3136.0xffff9e899b4db930.dat > file.3136.0xffff9e899b4db930.dat.txt
  121  strings -a -n 3 /home/usuario/Escritorio/dump/file.6452.0xffff9e899d453560.vacb file.6452.0xffff9e899d453560.vacb.txt
  122  strings -a -n 3 /home/usuario/Escritorio/dump/file.6452.0xffff9e899d453560.vacb > file.6452.0xffff9e899d453560.vacb.txt
  123  strings -a -n 3 /home/usuario/Escritorio/dump/file.3316.0xffff9e899b4d7470.dat > file.3316.0xffff9e899b4d7470.dat.txt
  124  strings -a -n 3 /home/usuario/Escritorio/dump/file.1744.0xffff9e899cf6bc30.img > file.1744.0xffff9e899cf6bc30.img.txt
  125  strings -a -n 3 /home/usuario/Escritorio/dump/file.3136.0xffff9e899d707a20.img > file.3136.0xffff9e899d707a20.img.txt
  126  strings -a -n 3 /home/usuario/Escritorio/dump/file.3316.0xffff9e899e0ba520.vacb > file.3316.0xffff9e899e0ba520.vacb.txt
  127  strings -a -n 3 /home/usuario/Escritorio/dump/file.92.0xffff9e899b7a3df0.dat > file.92.0xffff9e899b7a3df0.dat.txt
  128  strings -a -n 3 /home/usuario/Escritorio/dump/file.4704.0xffff9e899df3da20.vacb > file.4704.0xffff9e899df3da20.vacb.txt
  129  sudo chmod 777 -Rf Descargas/volatility/
  130  cd Descargas/volatility/
  131  ls
  132  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 cmdline
  133  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 cmdscan
  134  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 consoles
  135  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 hivelist
  136  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 hivescan
  137  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 hivedump
  138  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 netscan
  139  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 netscan > ~/Escritorio/Scans/netscan.txt
  140  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 pslist > ~/Escritorio/Scans/pslist.txt
  141  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 pslist 
  142  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 pstree
  143  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 pstree > ~/Escritorio/Scans/pstree.txt
  144  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 psxview
  145  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 psxview > ~/Escritorio/Scans/psxview.txt
  146  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 mutantscan
  147  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 mutantscan > ~/Escritorio/Scans/mutantscan.txt
  148  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 sessions
  149  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 sessions > ~/Escritorio/Scans/sessions.txt
  150  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 shellbags
  151  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 svcscan
  152  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 svcscan > ~/Escritorio/Scans/svcscan.txt
  153  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 thrdscan
  154  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 thrdscan > ~/Escritorio/Scans/thrdscan.txt
  155  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 threads
  156  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 threads > ~/Escritorio/Scans/threads.txt
  157  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 volshell
  158  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 dlllist > ~/Escritorio/Scans/dlllist.txt
  159  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 devicetree
  160  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 devicetree > ~/Escritorio/Scans/devicetree.txt
  161  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 dumpfiles -D ~/Escritorio/dump/
  162  wget https://gist.githubusercontent.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9/raw/4ec711d37f1b428b63bed1f786b26a0654aa2f31/malware_yara_rules.py
  163  mkdir rules
  164  python malware_yara_rules.py
  165  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 -y malware_rules.yar 
  166  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 yarascan -y malware_rules.yar 
  167  cd ..
  168  cd yara-python/
  169  ls
  170  yara ~/Descargas/volatility/malware_rules.yar ~/Escritorio/dump/
  171  cd ..
  172  git clone https://github.com/VirusTotal/yara.git
  173  cd yara
  174  ls
  175  ./bootstrap.sh
  176  ls
  177  sudo ./bootstrap.sh
  178  sudo apt-get install autoconf
  179  ./bootstrap.sh
  180  sudo ./bootstrap.sh
  181  sudo apt-get install automake libtool make gcc pkg-config
  182  sudo apt-get install flex bison
  183  ./bootstrap.sh
  184  ./configure
  185  make
  186  sudo make install
  187  make check
  188  ./configure --enable-cuckoo --enable-magic --enable-dotnet
  189  sudo apt install janson
  190  sudo apt install jansson
  191  yara ~/Descargas/volatility/malware_rules.yar ~/Escritorio/dump/
  192  ./bootstrap.sh
  193  cd ..
  194  cd volatility/
  195  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 yarascan -y malware_rules.yar | grep "Rule:" | grep -v "Str_Win32" | sort | uniq
  196  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 yarascan 
  197  vol.py -f ~/Escritorio/memdump-Win10-Wanacry.mem --profile=Win10x64_19041 yarascan -y malware_rules.yar 
  198  yara ~/Escritorio/yaraRules/rule.yara ~/Escritorio/dump/ -c
  199  sudo apt install yara
  200  yara ~/Escritorio/yaraRules/rule.yara ~/Escritorio/dump/ -c
  201  yara ~/Descargas/volatility/malware_rules.yar ~/Escritorio/dump/ -c
  202  yara ~/Descargas/volatility/malware_rules.yar ~/Escritorio/dump/ 
  203  yara ~/Descargas/volatility/malware_rules.yar ~/Escritorio/dump/ -c > ~/Escritorio/positivosYara.txt
  204  yara ~/Descargas/volatility/malware_rules.yar ~/Escritorio/dump/ -c
  205  sudo apt update
  206  sudo apt upgrade
  207  sudo apt autoremove
  208  sudo update-manager -d
  209  sudo update-manager -f
  210  sudo update-manager -h
  211  sudo apt upgrade -y
  212  sudo do-release-upgrade 
  213  sudo lsb_release -a
  214  ls
  215  cp VBoxLinuxAdditions.run ~/Escritorio/
  216  cd ~/Escritorio/
  217  chmod +x VBoxLinuxAdditions.run 
  218  sudo ./VBoxLinuxAdditions.run 
  219  sudo usermod -aG vboxsf $USER
  220  sudo reboot
  221  vol.py -f ~/Escritorio/memdump-Lab1-1-sucio-.mem imageinfo
  222  vol.py -f ~/Escritorio/memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 mutantscan
  223  cd ~/Escritorio/lab1-1/
  224  ls
  225  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 mutantscan > scans/mutanScan.txt
  226  vol.py -f memdump-Lab1-1-sucio-.mem imageinfo > scans/imageinfo.txt
  227  vol.py -f memdump-Lab1-1-sucio-.mem windows.info
  228  vol.py -f memdump-Lab1-1-sucio-.mem 
  229  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 windows.info
  230  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 pstree
  231  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 pstree > scans/pstree.txt
  232  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 pslist > scans/pslist.txt
  233  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 psscan > scans/psscan.txt
  234  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 cmdscan
  235  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 cmdlineScan
  236  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 devicetree
  237  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 devicetree > scans/devicetree.txt
  238  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 delllist
  239  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 dlllist
  240  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 dlllist > scans/dlllist.txt
  241  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 malfindScan
  242  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 netscan > scans/netscan.txt
  243  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 psxview
  244  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 psxview > scans/psxview.txt
  245  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 sessions
  246  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 sessions > scans/sessions.txt
  247  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 svcscan > scans/svcscan.txt
  248  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 thrdscan > scans/thrdscan.txt
  249  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 threads > scans/threads.txt
  250  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 filescan
  251  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 filescan > scans/filescan.txt
  252  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 hashdump
  253  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 connections
  254  vol.py -f memdump-Lab1-1-sucio-.mem  connections
  255  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 sockscan
  256  vol.py -f memdump-Lab1-1-sucio-.mem --profile=WinXPSP2x86 sockscan
  257  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 yarascan -y malware_rules.yar 
  258  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 lsof
  259  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 cmdscan
  260  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 pslist
  261  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 malfind
  262  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 malfind > scans/malfind.txt
  263  vol.py -h
  264  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 hivelist > scans-volatility/hivelist.txt
  265  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 hivelist 
  266  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 hivescan
  267  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 sockets
  268  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 shellbags
  269  wget https://gist.githubusercontent.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9/raw/4ec711d37f1b428b63bed1f786b26a0654aa2f31/malware_yara_rules.py
  270  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 yarascan -y malware_rules.yar 
  271  python malware_yara_rules.py
  272  history | grep malware_yara_rules.py
  273  history | grep yara
  274  python malware_yara_rules.py
  275  vol.py -f memdump-Lab1-1-sucio-.mem --profile=Win10x64_19041 yarascan -y malware_rules.yar 
  276  history > commands-history.txt
  277  cat >> 00-Explicacion
  278  history > commands-history.txt
