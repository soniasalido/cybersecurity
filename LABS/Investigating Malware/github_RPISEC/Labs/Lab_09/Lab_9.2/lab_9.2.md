
# Lab 9.2 RPISEC


# Indicators
```
file > name,c:\users\usuario\desktop\lab_09\lab_9.2\lab_09-2.malware
file > signature,Microsoft Linker 6.0 | Petite 1 - 2 | Visual Studio 6.0
file > sha256,FB331CE3A04032D2059413E54474BAADB84B5B3CF544F479B5D9FB2670A9D0FC
file > info,size: 12552 bytes, entropy: 7.224
file > type,executable, 32-bit, GUI
virustotal > score,No se pudo resolver el nombre de servidor o su dirección
stamp > compiler,Mon Jun 23 05:09:27 2003
languages > names,English-Canada
resources > info,count: 3, size: 1074 bytes, file-ratio: 8.56%
file > version,n/a
entry-point > location,0x00007046 (section: )
section > writable,name: .petite
sections > self-modifying,name: .petite | 
sections > flag,name: 
certificate,n/a
imports > flag,VirtualProtect
imphash > md5,D5E1BCC96A4DE3630A1D9D4AB92A1BFC
exports,n/a
overlay > info,signature: unknown, offset: 0x00000800, size: 10504 bytes, entropy: 7.669
overlay > first 10504 bytes (hex),B6 60 31 22 00 78 1F 32 BA C0 27 39 B2 37 33 F8 3F AB 92 A1 E1 61 00 00 5C 06 53 32 6C 2B A6 CF 
overlay > first 10504 bytes (text),..`1"..x..2....'9..73..?........a....\..S2l+....
overlay > entropy,7.669
``` 


# Footprinting
```
file > sha256,FB331CE3A04032D2059413E54474BAADB84B5B3CF544F479B5D9FB2670A9D0FC
dos-stub > sha256,5F7096AAB0EF1D35EE700E612DEE0A8C8C826723533F9FDF62EA7C92DEF48D54
dos-header > sha256,FB0863646ED387AF2CB553EBB9F5AB44608B01D407CC9D94C5B2532EB9F97BFE
rich-header > sha256,B605DF813D33B62289C5612B62F48C20D87DACA152A5048A94A59E905AE06D7B
section > .petite > sha256,7C5C491A17137277415C2A1473B15900239F9A3E23BA86ABC09295F6AB0B4F02
section > .rsrc > sha256,60D38BFC187AB1C34BDF46AA1D4C2182804F4F2269890AD21616D3CA4A427860
section > n/a > sha256,C084749F7BA1A0F0EB64011AB07563EB5B1EC2855E1F1585FC21070D7E149A3F
overlay > sha256,C3D1646B4B638757B6EE6AC8310553921AFE76AFA9C14E9EDBD184E201AAF0F9
,
special,
imphash > md5,D5E1BCC96A4DE3630A1D9D4AB92A1BFC
```


# Sections
![sections](capturas/sections.png)

| section | section[0] | section[1] | section[2] |
|---|---|---|---|
| name | .petite | .rsrc | n/a |
| section > sha256 | 7C5C....  | 60D3... | C084.... |
| entropy | 7.954 | 2.544 | 4.578 |
| file > ratio (91.84%) | 73.42 % | 10.26 % | 8.16 % |
| raw-address (begin) | 0x00000800 | 0x00002C00 | 0x00000400 |
| raw-address (end) | 0x00002C00 | 0x00003108 | 0x00000800 |
| raw-size (11528 bytes) | 0x00002400 (9216 bytes) | 0x00000508 (1288 bytes) | 0x00000400 (1024 bytes) |
| virtual-address (begin) | 0x00001000 | 0x00006000 | 0x00007000 |
| virtual-address (end) | 0x00006000 | 0x00007000 | 0x000072FC |
| virtual-size (25340 bytes) | 0x00005000 (20480 bytes) | 0x00001000 (4096 bytes) | 0x000002FC (764 bytes) |
| characteristics | 0xE0000060 | 0x40000040 | 0xE2000060 |
| write | x | - | x |
| execute | x | - | x |
| share | - | - | - |
| self-modifying | x | - | x |
| virtual | - | - | - |
| items |  |  |  |
| directory > import | - | - | 0x000071F0 |
| directory > resource | - | 0x00006000 | - |
| base-of-code | 0x00001000 | - | - |
| base-of-data | 0x00004000 | - | - |
| entry-point > location | - | - | 0x00007046 |



# Rich Headers
```
Utc12_CPP,Visual Studio 6.0 - 6.0
Masm613,Visual Studio 6.0 MASM - 6.13 SP1
Linker512,Visual Studio 5.0 - 5.12
Import,Visual Studio - 
Utc12_C,Visual Studio 6.0 - 6.0
Cvtres500,Visual Studio 5.0 CvtRes.exe - 5.0
,
property,value
rich-header > location,0x00000080 - 0x000000D0
size,0x00000050 (80 bytes)
checksum-builtin,0x9B0E79B0
checksum-real,0x9B0E79B0
rich-header > sha256,B605DF813D33B62289C5612B62F48C20D87DACA152A5048A94A59E905AE06D7B
``` 

# Overlays
![Overlays](capturas/overlay.png)
```
overlay > sha256,C3D1646B4B638757B6EE6AC8310553921AFE76AFA9C14E9EDBD184E201AAF0F9
entropy,7.669
overlay > location,0x00000800 - 0x00003108
size,0x2908 (10504 bytes)
signature,unknown
first 32 bytes (hex),B6 60 31 22 00 78 1F 32 BA C0 27 39 B2 37 33 F8 3F AB 92 A1 E1 61 00 00 5C 06 53 32 6C 2B A6 CF 
first 32 bytes (text),..`1"..x..2....'9..73..?........a....\..S2l+....
file > ratio,83.68 %
```

# Analisis de empaquetamiento
```
└─$ upx -d Lab_09-2.malware
                       Ultimate Packer for eXecutables
                          Copyright (C) 1996 - 2024
UPX 4.2.4       Markus Oberhumer, Laszlo Molnar & John Reiser    May 9th 2024

        File size         Ratio      Format      Name
   --------------------   ------   -----------   -----------
upx: Lab_09-2.malware: NotPackedException: not packed by UPX

Unpacked 0 files.
```

Analizamos con DIE:  
![DIE](capturas/die.png)

