```
                             **************************************************************
                             * Library Function - Single Match                            *
                             *  ___security_init_cookie                                   *
                             *                                                            *
                             * Library: Visual Studio 2015 Release                        *
                             **************************************************************
                             void __cdecl ___security_init_cookie(void)
                               assume FS_OFFSET = 0xffdff000
             void              <VOID>         <RETURN>
             undefined4        Stack[-0x8]:4  local_8                                 XREF[5]:     10002c9b(W), 
                                                                                                   10002ca4(RW), 
                                                                                                   10002cad(RW), 
                                                                                                   10002cbd(*), 
                                                                                                   10002cc3(R)  
             undefined4        Stack[-0xc]:4  local_c                                 XREF[2]:     10002c65(RW), 
                                                                                                   10002c95(R)  
             undefined4        Stack[-0x10]:4 local_10                                XREF[3]:     10002c61(RW), 
                                                                                                   10002c8b(*), 
                                                                                                   10002c98(R)  
             undefined4        Stack[-0x14]:4 local_14                                XREF[1]:     10002cba(R)  
             undefined4        Stack[-0x18]:4 local_18                                XREF[2]:     10002cb0(*), 
                                                                                                   10002cc0(R)  
                             ___security_init_cookie                         XREF[1]:     entry:100026d6(c)  
        10002c5b 55              PUSH       EBP
        10002c5c 8b ec           MOV        EBP,ESP
        10002c5e 83 ec 14        SUB        ESP,0x14
        10002c61 83 65 f4 00     AND        dword ptr [EBP + local_10],0x0
        10002c65 83 65 f8 00     AND        dword ptr [EBP + local_c],0x0
        10002c69 a1 04 60        MOV        EAX,[DAT_10006004]                               = BB40E64Eh
                 00 10
        10002c6e 56              PUSH       ESI
        10002c6f 57              PUSH       EDI
        10002c70 bf 4e e6        MOV        EDI,0xbb40e64e
                 40 bb
        10002c75 be 00 00        MOV        ESI,0xffff0000
                 ff ff
        10002c7a 3b c7           CMP        EAX,EDI
        10002c7c 74 0d           JZ         LAB_10002c8b
        10002c7e 85 c6           TEST       ESI,EAX
        10002c80 74 09           JZ         LAB_10002c8b
        10002c82 f7 d0           NOT        EAX
        10002c84 a3 00 60        MOV        [DAT_10006000],EAX                               = 44BF19B1h
                 00 10
        10002c89 eb 66           JMP        LAB_10002cf1
                             LAB_10002c8b                                    XREF[2]:     10002c7c(j), 10002c80(j)  
        10002c8b 8d 45 f4        LEA        EAX=>local_10,[EBP + -0xc]
        10002c8e 50              PUSH       EAX
        10002c8f ff 15 3c        CALL       dword ptr [->KERNEL32.DLL::GetSystemTimeAsFile   = 000058ea
                 40 00 10
        10002c95 8b 45 f8        MOV        EAX,dword ptr [EBP + local_c]
        10002c98 33 45 f4        XOR        EAX,dword ptr [EBP + local_10]
        10002c9b 89 45 fc        MOV        dword ptr [EBP + local_8],EAX
        10002c9e ff 15 38        CALL       dword ptr [->KERNEL32.DLL::GetCurrentThreadId]   = 000058d4
                 40 00 10
        10002ca4 31 45 fc        XOR        dword ptr [EBP + local_8],EAX
        10002ca7 ff 15 34        CALL       dword ptr [->KERNEL32.DLL::GetCurrentProcessId]  = 000058be
                 40 00 10
        10002cad 31 45 fc        XOR        dword ptr [EBP + local_8],EAX
        10002cb0 8d 45 ec        LEA        EAX=>local_18,[EBP + -0x14]
        10002cb3 50              PUSH       EAX
        10002cb4 ff 15 30        CALL       dword ptr [->KERNEL32.DLL::QueryPerformanceCou   = 000058a4
                 40 00 10
        10002cba 8b 4d f0        MOV        ECX,dword ptr [EBP + local_14]
        10002cbd 8d 45 fc        LEA        EAX=>local_8,[EBP + -0x4]
        10002cc0 33 4d ec        XOR        ECX,dword ptr [EBP + local_18]
        10002cc3 33 4d fc        XOR        ECX,dword ptr [EBP + local_8]
        10002cc6 33 c8           XOR        ECX,EAX
        10002cc8 3b cf           CMP        ECX,EDI
        10002cca 75 07           JNZ        LAB_10002cd3
        10002ccc b9 4f e6        MOV        ECX,0xbb40e64f
                 40 bb
        10002cd1 eb 10           JMP        LAB_10002ce3
                             LAB_10002cd3                                    XREF[1]:     10002cca(j)  
        10002cd3 85 ce           TEST       ESI,ECX
        10002cd5 75 0c           JNZ        LAB_10002ce3
        10002cd7 8b c1           MOV        EAX,ECX
        10002cd9 0d 11 47        OR         EAX,0x4711
                 00 00
        10002cde c1 e0 10        SHL        EAX,0x10
        10002ce1 0b c8           OR         ECX,EAX
                             LAB_10002ce3                                    XREF[2]:     10002cd1(j), 10002cd5(j)  
        10002ce3 89 0d 04        MOV        dword ptr [DAT_10006004],ECX                     = BB40E64Eh
                 60 00 10
        10002ce9 f7 d1           NOT        ECX
        10002ceb 89 0d 00        MOV        dword ptr [DAT_10006000],ECX                     = 44BF19B1h
                 60 00 10
                             LAB_10002cf1                                    XREF[1]:     10002c89(j)  
        10002cf1 5f              POP        EDI
        10002cf2 5e              POP        ESI
        10002cf3 8b e5           MOV        ESP,EBP
        10002cf5 5d              POP        EBP
        10002cf6 c3              RET
```


La función ___security_init_cookie no es maliciosa ni forma parte de la lógica específica del malware. Es parte del boilerplate de seguridad generado por el compilador.

La función ___security_init_cookie tiene como propósito inicializar el "security cookie" utilizado por el compilador de Visual Studio para proteger contra ataques de corrupción de pila, como stack buffer overflows. Esta técnica se conoce como GS (Guard Stack) o /GS security cookie.


