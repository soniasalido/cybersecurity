### RC_DATA / IDR_DLL1 en una DLL incrustada como recurso:

```
üìç Secci√≥n .rsrc (recursos del binario)

// .rsrc 
// ram:00404000-ram:004093ff

üìç Entrada RC_DATA / IDR_DLL1

**************************************************************
* Rsrc_RC_DATA_IDR_DLL1_409 Size of resource: 0x5000 bytes   *
**************************************************************
Rsrc_RC_DATA_IDR_DLL1_409
004040d0 4d 5a 90 00 ...

    RC_DATA es el tipo de recurso para datos arbitrarios binarios.

    IDR_DLL1 es el identificador simb√≥lico del recurso.

    0x004040D0 contiene datos que empiezan con la firma:

    4D 5A 90 00   ‚Üí  "MZ"  (cabecera DOS de un ejecutable PE/DLL)
```

- Comienza con MZ, por lo que se trata de un ejecutable PE (Portable Executable), en este caso probablemente una DLL.
- Tama√±o del recurso: Size of resource: 0x5000 bytes ‚Üí 20 KB. Este tama√±o es razonable para una DLL maliciosa compacta que contenga payloads (por ejemplo: backdoors, downloaders o m√≥dulos cifrados).

### Resumiendo
- El dropper contiene embebida una DLL en formato PE dentro de los recursos del ejecutable.
- Est√° empaquetada bajo el tipo RC_DATA con el nombre IDR_DLL1.
- El ejecutable principal probablemente extrae este recurso a disco o lo carga directamente en memoria para ejecutarlo.
    

### Usamos Resource Hacker para extraer la dll
Abrimos la muestra de malware con Resorce Hacker
![resource-hacker](../analisis-estatico/capturas/resource-hacker.png)


Al abrir Resource Hacker vemos el recurso RC_DATA ‚Üí IDR_DLL1 : 1033, que es exactamente donde est√° la DLL incrustada. üëâ El n√∫mero 1033 es el identificador del idioma (en este caso, ingl√©s - EE.UU.), que Resource Hacker muestra como parte de la ruta al recurso:
RC_DATA ‚Üí IDR_DLL1 : 1033 = RC_DATA/IDR_DLL1/409 (porque 1033 decimal = 0x409 hexadecimal).

![RC_DATA ‚Üí IDR_DLL1](../analisis-estatico/capturas/dll-IDR_DLL1-1033.png)

Hacemos clic derecho sobre IDR_DLL1 : 1033 y guardamos con extensi√≥n *.bin o *.dll.
     
        
### Verificamos que la extracci√≥n se realiz√≥ correctamente
```
‚îî‚îÄ$ file IDR_DLL1.bin 
IDR_DLL1.bin: PE32 executable for MS Windows 6.00 (DLL), Intel i386, 5 sections
```

## Analizamos la dll extraida con x32dbg
![dll von x32dbg](../analisis-estatico/capturas/dll-IDR_DLL1-x32dbg.png)


El c√≥digo que vemos pertenece a **ntdll.dll**, concretamente a la funci√≥n **LdrInitializeProcess**. Esto indica que estamos en una fase muy temprana de la carga del proceso (dentro de las rutinas del sistema para inicializar una DLL o EXE). Lo que significa que hemos cargado correctamente la DLL, pero el c√≥digo en ejecuci√≥n ahora a√∫n no es nuestro, es de ntdll.dll, el cual Windows llama autom√°ticamente al cargar cualquier m√≥dulo PE. Es una se√±al de que la DLL est√° esperando llegar a su propio **DllMain o punto de entrada.**


### Analizamos los m√≥dulos
Para ver los m√≥dulos: ALt + E

![lista de modulo](../analisis-estatico/capturas/lista-de-modulos.png)

### Vamos a encontrar el OEP ( Original Entry Point) de esta DLL --> IDR_DLL1 cargada como ntdll1.dll

- Vamos a la pesta√±a "Memory Map".
- Buscamos el m√≥dulo ntdll1.dll.
  ![ntdll1.dll en memoria](../analisis-estatico/capturas/ntdll1.dll-memoria.png)  Hacer captura
- Direcci√≥n Base: 77D01000
- Hacemos click derecho sobre √©l --> Dump Memory to File. Para despues analiazarlo con Ghidra.
- Cargamos el m√≥dulo en la vista CPU haciendo doble click sobre el.
  ![ntdll1.dll vista cpu](../analisis-estatico/capturas/ntdll1.dll-vista-cpu.png)


- Cargamos la dll extraida con DIE:
  ![ntdll1.dll detect it easy](../analisis-estatico/capturas/ntdll1.dll-die.png)



xxxxxxxxxxxxxxxx copiar de chat gpt

### Direccion 77D036CD

![ntdll1.dll En el punto 77D036CD](../analisis-estatico/capturas/ntdll1.dll-77D036CD.png)


## Step Over:

![ntdll1.dll En el punto 77DB1C1C](../analisis-estatico/capturas/ntdll1.dll-77DB1C1C.png)


## Carga de otra dll en 77CD1C32
![ntdll1.dll En el punto 77DB1C1C](../analisis-estatico/capturas/ntdll1.dll-77CD1C32.png)


## De 77CD1C32 Salta a 77CCC16B

![ntdll1.dll En el punto 77DB1C1C](../analisis-estatico/capturas/ntdll1.dll-77CCC16B.png)




## De 77CCC218

![ntdll1.dll En el punto 77DB1C1C](../analisis-estatico/capturas/ntdll1.dll-77CCC218.png)
