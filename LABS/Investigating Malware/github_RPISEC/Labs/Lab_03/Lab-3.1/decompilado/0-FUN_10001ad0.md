```
                             **************************************************************
                             *                          FUNCTION                          *
                             **************************************************************
                             undefined __stdcall FUN_10001ad0(void)
                               assume FS_OFFSET = 0xffdff000
             undefined         <UNASSIGNED>   <RETURN>
             undefined4        Stack[-0x8]:4  local_8                                 XREF[2]:     10001baf(W), 
                                                                                                   10001be8(W)  
             undefined4        Stack[-0x10]:4 local_10                                XREF[2]:     10001aef(*), 
                                                                                                   10001bf9(R)  
             undefined4        Stack[-0x14]:4 local_14                                XREF[2]:     10001aeb(W), 
                                                                                                   10001c04(R)  
             undefined4        Stack[-0x18]:4 local_18                                XREF[1]:     10001b1e(W)  
             undefined4        Stack[-0x1c]:4 local_1c                                XREF[1]:     10001b17(W)  
             undefined4        Stack[-0x20]:4 local_20                                XREF[1]:     10001b10(W)  
             undefined4        Stack[-0x24]:4 local_24                                XREF[1]:     10001b09(W)  
             undefined4        Stack[-0x28]:4 local_28                                XREF[1]:     10001b02(W)  
             undefined4        Stack[-0x2c]:4 local_2c                                XREF[1]:     10001afb(W)  
             undefined4        Stack[-0x30]:4 local_30                                XREF[6]:     10001b25(W), 
                                                                                                   10001b73(*), 
                                                                                                   10001bb8(R), 
                                                                                                   10001bbd(R), 
                                                                                                   10001bda(R), 
                                                                                                   10001bdf(R)  
             undefined4        Stack[-0x34]:4 local_34                                XREF[4]:     10001b62(W), 
                                                                                                   10001b65(R), 
                                                                                                   10001b8b(W), 
                                                                                                   10001b8e(R)  
             undefined1        Stack[-0x38]:1 local_38                                XREF[3]:     10001ba7(*), 
                                                                                                   10001bd1(*), 
                                                                                                   10001bef(*)  
             undefined4        Stack[-0x3c]:4 local_3c                                XREF[1]:     10001af8(W)  
                             FUN_10001ad0                                    XREF[1]:     FUN_10001810:10001a0c(c)  
        10001ad0 55              PUSH       EBP
        10001ad1 8b ec           MOV        EBP,ESP
        10001ad3 6a ff           PUSH       -0x1
        10001ad5 68 f8 34        PUSH       LAB_100034f8
                 00 10
        10001ada 64 a1 00        MOV        EAX,FS:[0x0]=>ExceptionList                      = 00000000
                 00 00 00
        10001ae0 50              PUSH       EAX
        10001ae1 83 ec 2c        SUB        ESP,0x2c
        10001ae4 a1 04 60        MOV        EAX,[DAT_10006004]                               = BB40E64Eh
                 00 10
        10001ae9 33 c5           XOR        EAX,EBP
        10001aeb 89 45 f0        MOV        dword ptr [EBP + local_14],EAX
        10001aee 50              PUSH       EAX
        10001aef 8d 45 f4        LEA        EAX=>local_10,[EBP + -0xc]
        10001af2 64 a3 00        MOV        FS:[0x0]=>ExceptionList,EAX                      = 00000000
                 00 00 00
        10001af8 89 4d c8        MOV        dword ptr [EBP + local_3c],ECX
        10001afb c7 45 d8        MOV        dword ptr [EBP + local_2c],s_http://rpis.ec/_1   = "http://rpis.ec/"
                 90 42 00 10
        10001b02 c7 45 dc        MOV        dword ptr [EBP + local_28],s_http://rpis.ec/bi   = "http://rpis.ec/binexp"
                 a0 42 00 10
        10001b09 c7 45 e0        MOV        dword ptr [EBP + local_24],s_https://twitter.c   = "https://twitter.com/RPISEC"
                 b8 42 00 10
        10001b10 c7 45 e4        MOV        dword ptr [EBP + local_20],s_https://www.faceb   = "https://www.facebook.com/RPI-
                 d8 42 00 10
        10001b17 c7 45 e8        MOV        dword ptr [EBP + local_1c],s_http://blog.rpis.   = "http://blog.rpis.ec/"
                 30 43 00 10
        10001b1e c7 45 ec        MOV        dword ptr [EBP + local_18],s_http://security.c   = "http://security.cs.rpi.edu/co
                 48 43 00 10
        10001b25 c7 45 d4        MOV        dword ptr [EBP + local_30],0x0
                 00 00 00 00
        10001b2c 6a 00           PUSH       0x0
        10001b2e e8 7d ff        CALL       FUN_10001ab0                                     __time64_t FUN_10001ab0(__time64
                 ff ff
        10001b33 83 c4 04        ADD        ESP,0x4
        10001b36 50              PUSH       EAX
        10001b37 ff 15 04        CALL       dword ptr [->API-MS-WIN-CRT-UTILITY-L1-1-0.DLL   = 0000567c
                 41 00 10
        10001b3d 83 c4 04        ADD        ESP,0x4
        10001b40 ff 15 00        CALL       dword ptr [->API-MS-WIN-CRT-UTILITY-L1-1-0.DLL   = 00005684
                 41 00 10
        10001b46 99              CDQ
        10001b47 b9 03 00        MOV        ECX,0x3
                 00 00
        10001b4c f7 f9           IDIV       ECX
        10001b4e 85 d2           TEST       EDX,EDX
        10001b50 74 08           JZ         LAB_10001b5a
        10001b52 8a 45 20        MOV        AL,byte ptr [EBP + Stack[0x1c]]
        10001b55 e9 9f 00        JMP        LAB_10001bf9
                 00 00
                             LAB_10001b5a                                    XREF[1]:     10001b50(j)  
        10001b5a 6a 00           PUSH       0x0
        10001b5c ff 15 0c        CALL       dword ptr [->OLE32.DLL::CoInitialize]            = 0000553c
                 41 00 10
        10001b62 89 45 d0        MOV        dword ptr [EBP + local_34],EAX
        10001b65 83 7d d0 00     CMP        dword ptr [EBP + local_34],0x0
        10001b69 7d 08           JGE        LAB_10001b73
        10001b6b 8a 45 20        MOV        AL,byte ptr [EBP + Stack[0x1c]]
        10001b6e e9 86 00        JMP        LAB_10001bf9
                 00 00
                             LAB_10001b73                                    XREF[1]:     10001b69(j)  
        10001b73 8d 55 d4        LEA        EDX=>local_30,[EBP + -0x2c]
        10001b76 52              PUSH       EDX
        10001b77 68 80 41        PUSH       DAT_10004180                                     = 61h    a
                 00 10
        10001b7c 6a 04           PUSH       0x4
        10001b7e 6a 00           PUSH       0x0
        10001b80 68 a0 41        PUSH       DAT_100041a0                                     = 01h
                 00 10
        10001b85 ff 15 10        CALL       dword ptr [->OLE32.DLL::CoCreateInstance]        = 0000554c
                 41 00 10
        10001b8b 89 45 d0        MOV        dword ptr [EBP + local_34],EAX
        10001b8e 83 7d d0 00     CMP        dword ptr [EBP + local_34],0x0
        10001b92 75 63           JNZ        LAB_10001bf7
        10001b94 ff 15 00        CALL       dword ptr [->API-MS-WIN-CRT-UTILITY-L1-1-0.DLL   = 00005684
                 41 00 10
        10001b9a 99              CDQ
        10001b9b b9 06 00        MOV        ECX,0x6
                 00 00
        10001ba0 f7 f9           IDIV       ECX
        10001ba2 8b 54 95 d8     MOV        EDX,dword ptr [EBP + EDX*0x4 + -0x28]
        10001ba6 52              PUSH       EDX
        10001ba7 8d 4d cc        LEA        ECX=>local_38,[EBP + -0x34]
        10001baa e8 e1 f8        CALL       FUN_10001490                                     int * FUN_10001490(void * this, 
                 ff ff
        10001baf c7 45 fc        MOV        dword ptr [EBP + local_8],0x0
                 00 00 00 00
        10001bb6 6a 01           PUSH       0x1
        10001bb8 8b 45 d4        MOV        EAX,dword ptr [EBP + local_30]
        10001bbb 8b 08           MOV        ECX,dword ptr [EAX]
        10001bbd 8b 55 d4        MOV        EDX,dword ptr [EBP + local_30]
        10001bc0 52              PUSH       EDX
        10001bc1 8b 81 a4        MOV        EAX,dword ptr [ECX + 0xa4]
                 00 00 00
        10001bc7 ff d0           CALL       EAX
        10001bc9 6a 00           PUSH       0x0
        10001bcb 6a 00           PUSH       0x0
        10001bcd 6a 00           PUSH       0x0
        10001bcf 6a 00           PUSH       0x0
        10001bd1 8d 4d cc        LEA        ECX=>local_38,[EBP + -0x34]
        10001bd4 e8 77 f9        CALL       FUN_10001550                                     undefined4 FUN_10001550(int * pa
                 ff ff
        10001bd9 50              PUSH       EAX
        10001bda 8b 4d d4        MOV        ECX,dword ptr [EBP + local_30]
        10001bdd 8b 11           MOV        EDX,dword ptr [ECX]
        10001bdf 8b 45 d4        MOV        EAX,dword ptr [EBP + local_30]
        10001be2 50              PUSH       EAX
        10001be3 8b 4a 2c        MOV        ECX,dword ptr [EDX + 0x2c]
        10001be6 ff d1           CALL       ECX
        10001be8 c7 45 fc        MOV        dword ptr [EBP + local_8],0xffffffff
                 ff ff ff ff
        10001bef 8d 4d cc        LEA        ECX=>local_38,[EBP + -0x34]
        10001bf2 e8 39 f9        CALL       FUN_10001530                                     undefined FUN_10001530(int * par
                 ff ff
                             LAB_10001bf7                                    XREF[1]:     10001b92(j)  
        10001bf7 32 c0           XOR        AL,AL
                             LAB_10001bf9                                    XREF[2]:     10001b55(j), 10001b6e(j)  
        10001bf9 8b 4d f4        MOV        ECX,dword ptr [EBP + local_10]
        10001bfc 64 89 0d        MOV        dword ptr FS:[0x0]=>ExceptionList,ECX            = 00000000
                 00 00 00 00
        10001c03 59              POP        ECX
        10001c04 8b 4d f0        MOV        ECX,dword ptr [EBP + local_14]
        10001c07 33 cd           XOR        ECX,EBP
        10001c09 e8 30 07        CALL       __security_check_cookie                          undefined __security_check_cooki
                 00 00
        10001c0e 8b e5           MOV        ESP,EBP
        10001c10 5d              POP        EBP
        10001c11 c2 1c 00        RET        0x1c

```

    Muy relevante: Es una función de entrada que realiza lógica condicional basada en la fecha/hora del sistema y contiene:

        Llamadas a CoInitialize, CoCreateInstance.

        Uso de interfaces COM y funciones virtuales (como vtable[0xA4] y vtable[0x2C]).

        Llamada directa a FUN_10001530, que a su vez llama a Clear.

🔗 Está directamente involucrada en lógica de inicialización del malware y llamadas dinámicas.


**Llama a 10002c5b**
[10002c5](1-10002c5.md)
