```
             //
                             // .rdata 
                             // ram:00402000-ram:00402bff
                             //
                             **************************************************************
                             *                POINTER to EXTERNAL FUNCTION                *
                             **************************************************************
                             DWORD __stdcall SizeofResource(HMODULE hModule, HRSRC hR
             DWORD             EAX:4          <RETURN>
             HMODULE           Stack[0x4]:4   hModule
             HRSRC             Stack[0x8]:4   hResInfo
             assume FS_OFFSET = <UNKNOWN>
                             1361  SizeofResource  <<not bound>>
                             PTR_SizeofResource_00402000                     XREF[4]:     00400138(*), 004001e0(*), 
                                                                                          00400234(*), 
                                                                                          FUN_00401000:0040103a(R)  
        00402000 f0 26 00 00     addr       KERNEL32.DLL::SizeofResource
                             **************************************************************
                             *                POINTER to EXTERNAL FUNCTION                *
                             **************************************************************
                             BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer,
             BOOL              EAX:4          <RETURN>
             HANDLE            Stack[0x4]:4   hFile
             LPCVOID           Stack[0x8]:4   lpBuffer
             DWORD             Stack[0xc]:4   nNumberOfBytesToWrite
             LPDWORD           Stack[0x10]:4  lpNumberOfBytesWritten
             LPOVERLAPPED      Stack[0x14]:4  lpOverlapped
                             1505  WriteFile  <<not bound>>
                             PTR_WriteFile_00402004                          XREF[1]:     FUN_00401000:00401081(R)  
        00402004 02 27 00 00     addr       KERNEL32.DLL::WriteFile
                             **************************************************************
                             *                POINTER to EXTERNAL FUNCTION                *
                             **************************************************************
                             HANDLE __stdcall CreateFileW(LPCWSTR lpFileName, DWORD d
             HANDLE            EAX:4          <RETURN>
             LPCWSTR           Stack[0x4]:4   lpFileName
             DWORD             Stack[0x8]:4   dwDesiredAccess
             DWORD             Stack[0xc]:4   dwShareMode
             LPSECURITY_ATT    Stack[0x10]:4  lpSecurityAttributes
             DWORD             Stack[0x14]:4  dwCreationDisposition
             DWORD             Stack[0x18]:4  dwFlagsAndAttributes
             HANDLE            Stack[0x1c]:4  hTemplateFile
                             194  CreateFileW  <<not bound>>
                             PTR_CreateFileW_00402008                        XREF[1]:     FUN_00401000:00401066(R)  
        00402008 0e 27 00 00     addr       KERNEL32.DLL::CreateFileW
                             **************************************************************
                             *                POINTER to EXTERNAL FUNCTION                *
                             **************************************************************
                             LPVOID __stdcall LockResource(HGLOBAL hResData)
             LPVOID            EAX:4          <RETURN>
             HGLOBAL           Stack[0x4]:4   hResData
                             957  LockResource  <<not bound>>
                             PTR_LockResource_0040200c                       XREF[1]:     FUN_00401000:00401047(R)  
        0040200c 1c 27 00 00     addr       KERNEL32.DLL::LockResource
                             **************************************************************
                             *                POINTER to EXTERNAL FUNCTION                *
                             **************************************************************
                             BOOL __stdcall CloseHandle(HANDLE hObject)
             BOOL              EAX:4          <RETURN>
             HANDLE            Stack[0x4]:4   hObject
                             127  CloseHandle  <<not bound>>
                             PTR_CloseHandle_00402010                        XREF[1]:     FUN_00401000:0040108b(R)  
        00402010 2c 27 00 00     addr       KERNEL32.DLL::CloseHandle
                             **************************************************************
                             *                POINTER to EXTERNAL FUNCTION                *
                             **************************************************************
                             HGLOBAL __stdcall LoadResource(HMODULE hModule, HRSRC hR
             HGLOBAL           EAX:4          <RETURN>
             HMODULE           Stack[0x4]:4   hModule
             HRSRC             Stack[0x8]:4   hResInfo
                             939  LoadResource  <<not bound>>
                             PTR_LoadResource_00402014                       XREF[1]:     FUN_00401000:00401029(R)  
        00402014 3a 27 00 00     addr       KERNEL32.DLL::LoadResource
                             **************************************************************
                             *                POINTER to EXTERNAL FUNCTION                *
                             **************************************************************
                             HRSRC __stdcall FindResourceW(HMODULE hModule, LPCWSTR l
             HRSRC             EAX:4          <RETURN>
             HMODULE           Stack[0x4]:4   hModule
             LPCWSTR           Stack[0x8]:4   lpName
             LPCWSTR           Stack[0xc]:4   lpType
                             393  FindResourceW  <<not bound>>
                             PTR_FindResourceW_00402018                      XREF[1]:     FUN_00401000:00401018(R)  
        00402018 4a 27 00 00     addr       KERNEL32.DLL::FindResourceW
                             **************************************************************
                             *                POINTER to EXTERNAL FUNCTION                *
                             **************************************************************
                             HMODULE __stdcall GetModuleHandleW(LPCWSTR lpModuleName)
             HMODULE           EAX:4          <RETURN>
             LPCWSTR           Stack[0x4]:4   lpModuleName
                             615  GetModuleHandleW  <<not bound>>
                             PTR_GetModuleHandleW_0040201c                   XREF[2]:     FUN_004010a0:004010aa(R), 
                                                                                          ___scrt_is_managed_app:004018d9(
        0040201c 5a 27 00 00     addr       KERNEL32.DLL::GetModuleHandleW
                             **************************************************************
                             *                POINTER to EXTERNAL FUNCTION                *
                             **************************************************************
                             BOOL __stdcall IsDebuggerPresent(void)
             BOOL              EAX:4          <RETURN>
                             871  IsDebuggerPresent  <<not bound>>
                             PTR_IsDebuggerPresent_00402020                  XREF[1]:     ___scrt_fastfail:00401891(R)  
        00402020 5a 2b 00 00     addr       KERNEL32.DLL::IsDebuggerPresent
                             **************************************************************

```

Destacamos:
```
                             **************************************************************
                             *                POINTER to EXTERNAL FUNCTION                *
                             **************************************************************
                             BOOL __stdcall IsDebuggerPresent(void)
             BOOL              EAX:4          <RETURN>
                             871  IsDebuggerPresent  <<not bound>>
                             PTR_IsDebuggerPresent_00402020                  XREF[1]:     ___scrt_fastfail:00401891(R)  
        00402020 5a 2b 00 00     addr       KERNEL32.DLL::IsDebuggerPresent
                             **************************************************************
```

El uso de IsDebuggerPresent implica que el malware puede detectar si se está ejecutando dentro de un depurador como x32dbg, OllyDbg, IDA, etc. Si lo detecta, puede cambiar su comportamiento para:
- No ejecutar su payload real.
- Ejecutar una función falsa o inofensiva para despistar.
- Finalizar el proceso inmediatamente.
- Lanzar contraataques o corrupción de memoria para dificultar el análisis.

IsDebuggerPresent es una función de la API de Windows que revisa el campo BeingDebugged en el PEB (Process Environment Block). Si estamos usando un depurador como x32dbg, ese campo suele estar en 1.

¿Cómo evitarlo?
- Parchear IsDebuggerPresent para que siempre devuelva 0.
- Modificar el PEB manualmente desde el depurador para establecer BeingDebugged = 0.
- Usar herramientas como ScyllaHide, un plugin para x32dbg que intercepta llamadas a funciones anti-debug.

