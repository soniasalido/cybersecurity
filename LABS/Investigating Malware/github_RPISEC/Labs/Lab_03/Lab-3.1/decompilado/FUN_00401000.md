```
                             //
                             // .text
                             // ram:00401000-ram:00401dff
                             //
                             **************************************************************
                             *                          FUNCTION                          *
                             **************************************************************
                             undefined4 __cdecl FUN_00401000(HMODULE param_1, LPCWSTR
                               assume FS_OFFSET = 0xffdff000
             undefined4        EAX:4          <RETURN>
             HMODULE           Stack[0x4]:4   param_1                                 XREF[3]:     00401014(R),
                                                                                                   00401025(R),
                                                                                                   00401036(R)
             LPCWSTR           Stack[0x8]:4   param_2                                 XREF[1]:     00401062(R)
             undefined1        Stack[-0x5]:1  local_5                                 XREF[3]:     00401006(W),
                                                                                                   00401091(W),
                                                                                                   00401095(R)
             undefined4        Stack[-0xc]:4  local_c                                 XREF[3]:     0040101e(W),
                                                                                                   00401021(R),
                                                                                                   00401032(R)
             undefined4        Stack[-0x10]:4 local_10                                XREF[3]:     0040106c(W),
                                                                                                   0040107d(R),
                                                                                                   00401087(R)
             undefined4        Stack[-0x14]:4 local_14                                XREF[2]:     0040102f(W),
                                                                                                   00401043(R)
             undefined4        Stack[-0x18]:4 local_18                                XREF[2]:     00401040(W),
                                                                                                   00401075(R)
             undefined4        Stack[-0x1c]:4 local_1c                                XREF[2]:     0040104d(W),
                                                                                                   00401079(R)
             undefined1        Stack[-0x20]:1 local_20                                XREF[1]:     00401071(*)
                             FUN_00401000                                    XREF[3]:     00400134(*), 0040020c(*),
                                                                                          FUN_004010a0:004010b1(c)
        00401000 55              PUSH       EBP
        00401001 8b ec           MOV        EBP,ESP
        00401003 83 ec 1c        SUB        ESP,0x1c
        00401006 c6 45 ff 00     MOV        byte ptr [EBP + local_5],0x0
        0040100a 68 18 21        PUSH       u_RC_DATA_00402118                               = u"RC_DATA"
                 40 00
        0040100f 68 28 21        PUSH       u_IDR_DLL1_00402128                              = u"IDR_DLL1"
                 40 00
        00401014 8b 45 08        MOV        EAX,dword ptr [EBP + param_1]
        00401017 50              PUSH       EAX
        00401018 ff 15 18        CALL       dword ptr [->KERNEL32.DLL::FindResourceW]        = 0000274a
                 20 40 00
        0040101e 89 45 f8        MOV        dword ptr [EBP + local_c],EAX
        00401021 8b 4d f8        MOV        ECX,dword ptr [EBP + local_c]
        00401024 51              PUSH       ECX
        00401025 8b 55 08        MOV        EDX,dword ptr [EBP + param_1]
        00401028 52              PUSH       EDX
        00401029 ff 15 14        CALL       dword ptr [->KERNEL32.DLL::LoadResource]         = 0000273a
                 20 40 00
        0040102f 89 45 f0        MOV        dword ptr [EBP + local_14],EAX
        00401032 8b 45 f8        MOV        EAX,dword ptr [EBP + local_c]
        00401035 50              PUSH       EAX
        00401036 8b 4d 08        MOV        ECX,dword ptr [EBP + param_1]
        00401039 51              PUSH       ECX
        0040103a ff 15 00        CALL       dword ptr [->KERNEL32.DLL::SizeofResource]       = 000026f0
                 20 40 00
        00401040 89 45 ec        MOV        dword ptr [EBP + local_18],EAX
        00401043 8b 55 f0        MOV        EDX,dword ptr [EBP + local_14]
        00401046 52              PUSH       EDX
        00401047 ff 15 0c        CALL       dword ptr [->KERNEL32.DLL::LockResource]         = 0000271c
                 20 40 00
        0040104d 89 45 e8        MOV        dword ptr [EBP + local_1c],EAX
        00401050 6a 00           PUSH       0x0
        00401052 68 80 00        PUSH       0x80
                 00 00
        00401057 6a 02           PUSH       0x2
        00401059 6a 00           PUSH       0x0
        0040105b 6a 00           PUSH       0x0
        0040105d 68 00 00        PUSH       0xc0000000
                 00 c0
        00401062 8b 45 0c        MOV        EAX,dword ptr [EBP + param_2]
        00401065 50              PUSH       EAX
        00401066 ff 15 08        CALL       dword ptr [->KERNEL32.DLL::CreateFileW]          = 0000270e
                 20 40 00
        0040106c 89 45 f4        MOV        dword ptr [EBP + local_10],EAX
        0040106f 6a 00           PUSH       0x0
        00401071 8d 4d e4        LEA        ECX=>local_20,[EBP + -0x1c]
        00401074 51              PUSH       ECX
        00401075 8b 55 ec        MOV        EDX,dword ptr [EBP + local_18]
        00401078 52              PUSH       EDX
        00401079 8b 45 e8        MOV        EAX,dword ptr [EBP + local_1c]
        0040107c 50              PUSH       EAX
        0040107d 8b 4d f4        MOV        ECX,dword ptr [EBP + local_10]
        00401080 51              PUSH       ECX
        00401081 ff 15 04        CALL       dword ptr [->KERNEL32.DLL::WriteFile]            = 00002702
                 20 40 00
        00401087 8b 55 f4        MOV        EDX,dword ptr [EBP + local_10]
        0040108a 52              PUSH       EDX
        0040108b ff 15 10        CALL       dword ptr [->KERNEL32.DLL::CloseHandle]          = 0000272c
                 20 40 00
        00401091 c6 45 ff 01     MOV        byte ptr [EBP + local_5],0x1
        00401095 8a 45 ff        MOV        AL,byte ptr [EBP + local_5]
        00401098 8b e5           MOV        ESP,EBP
        0040109a 5d              POP        EBP
        0040109b c3              RET
        0040109c cc cc cc cc     align      align(4)

```

La funci√≥n FUN_00401000 contiene l√≥gica cl√°sica de extracci√≥n y volcado de recursos embebidos. En concreto, extrae un recurso del propio ejecutable (probablemente un DLL o payload) y lo escribe como archivo en disco. Este comportamiento es com√∫n en malware que:

    Embebe su payload cifrado o comprimido en la secci√≥n de recursos.

    Lo extrae y guarda como archivo temporal.

    Posteriormente lo carga o ejecuta.

üß† Resumen funcional

FUN_00401000(HMODULE hModule, LPCWSTR outputFilePath)

    Busca un recurso de tipo RC_DATA y nombre IDR_DLL1 en hModule.

    Lo carga en memoria.

    Obtiene su tama√±o.

    Lo bloquea (accede al puntero de datos).

    Crea un archivo en disco en la ruta outputFilePath.

    Escribe los datos del recurso en el archivo.

    Cierra el archivo.

    Devuelve 1 (true) si todo fue bien, 0 en caso contrario.


üß© Indicadores de posible actividad maliciosa
Indicador	Observaci√≥n
Uso de FindResourceW, LockResource	Suele indicar un payload embebido
Nombre IDR_DLL1, tipo RC_DATA	Nombre t√≠pico de DLL oculta en recursos
Escritura en disco (CreateFileW + WriteFile)	Puede estar soltando un dropper
No hay validaciones de seguridad	Todo el recurso se escribe sin checks


‚úÖ Conclusi√≥n

Esta funci√≥n extrae un recurso incrustado y lo escribe en disco, probablemente como parte de un comportamiento dropper o stager. Es sospechosa en contexto de malware, y deber√≠as:

    Extraer y analizar el recurso IDR_DLL1

    Revisar las funciones que llaman a FUN_00401000

    Monitorizar si el archivo escrito se ejecuta despu√©s
