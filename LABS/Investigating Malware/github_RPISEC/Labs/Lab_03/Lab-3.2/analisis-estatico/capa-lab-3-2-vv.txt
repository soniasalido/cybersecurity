>capa -vv Lab_03-1.malware > capa-lab-3-2-vv.txt

md5                     b76020bb02053ccb460639ec8f46e88d                                
sha1                    acdb68ac4e4b4dd7f151de1751fad91dc1ee2f9f                        
sha256                  dce7c942883810c535fab689ece1e366287336c79ed15c808038bb5863eddf66
path                    C:/Users/usuario/Desktop/Lab_03-1.malware                       
timestamp               2025-08-11 13:44:40.639356                                      
capa version            9.2.1                                                           
os                      windows                                                         
format                  pe                                                              
arch                    i386                                                            
analysis                static                                                          
extractor               VivisectFeatureExtractor                                        
base address            0x400000                                                        
rules                   C:/Users/usuario/AppData/Local/Temp/_MEI42642/rules             
function count          42                                                              
library function count  21                                                              
total feature count     1061                                                            

contain loop (library rule)
author  moritz.raabe@mandiant.com
scope   function                 
function @ 0x401993
  or:
    characteristic: loop @ 0x401993

create or open file (library rule)
author  michael.hunhoff@mandiant.com, joakim@intezer.com
scope   instruction                                     
mbc     File System::Create File [C0016]                
instruction @ 0x401066
  or:
    api: CreateFile @ 0x401066

contains PDB path
namespace  executable/pe/pdb        
author     moritz.raabe@mandiant.com
scope      file                     
regex: /:\\.*\.pdb/
  - "C:\\Users\\IEUser\\Downloads\\BHOinCPP_src\\BHOinCPP\\Release\\BHOinCPP.pdb" @ file+0x57BC
  - "C:\\Users\\IEUser\\Downloads\\BHOinCPP_src\\BHOinCPP\\Release\\launch.pdb" @ file+0x147C

extract resource via kernel32 functions
namespace  executable/resource            
author     william.ballenthin@mandiant.com
scope      function                       
function @ 0x401000
  or:
    and:
      or:
        api: LoadResource @ 0x401029
        api: LockResource @ 0x401047
      optional:
        or:
          api: FindResource @ 0x401018
        api: SizeofResource @ 0x40103A

contain an embedded PE file
namespace  executable/subfile/pe                        
author     moritz.raabe@mandiant.com                    
scope      file                                         
mbc        Execution::Install Additional Program [B0023]
or:
  count(characteristic(embedded pe)): 1 or more @ file+0x20D0

write file on Windows
namespace  host-interaction/file-system/write                              
author     william.ballenthin@mandiant.com, anushka.virgaonkar@mandiant.com
scope      function                                                        
mbc        File System::Writes File [C0052]                                
function @ 0x401000
  or:
    and:
      os: windows
      optional:
        basic block:
          or:
            number: 0x2 = FILE_WRITE_DATA @ 0x401057
            match: create or open file @ 0x401066
              or:
                api: CreateFile @ 0x401066
      or:
        api: WriteFile @ 0x401081

execute command
namespace  host-interaction/process/create
author     @mr-tz                         
scope      function                       
mbc        Process::Create Process [C0017]
function @ 0x4010A0
  or:
    api: system @ 0x4010BE



