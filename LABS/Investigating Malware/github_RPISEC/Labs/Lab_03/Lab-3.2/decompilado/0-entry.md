
```
                             **************************************************************
                             *                          FUNCTION                          *
                             **************************************************************
                             undefined __stdcall entry(void)
                               assume FS_OFFSET = 0xffdff000
             undefined         <UNASSIGNED>   <RETURN>
             undefined4        Stack[-0x8]:4  local_8                                 XREF[1]:     0040359a(RW)  
             undefined4        Stack[-0x18]:4 local_18                                XREF[1]:     004035ef(R)  
             undefined4        Stack[-0x1c]:4 local_1c                                XREF[1]:     00403552(W)  
             undefined4        Stack[-0x20]:4 local_20                                XREF[1]:     004035e6(W)  
             undefined4        Stack[-0x24]:4 local_24                                XREF[1]:     004035f6(W)  
                             entry                                           XREF[2]:     Entry Point(*), 00400100(*)  
        0040352f 55              PUSH       EBP
        00403530 8b ec           MOV        EBP,ESP
        00403532 6a ff           PUSH       -0x1
        00403534 68 78 91        PUSH       DAT_00409178                                     = FFh
                 40 00
        00403539 68 c4 5e        PUSH       LAB_00405ec4
                 40 00
        0040353e 64 a1 00        MOV        EAX,FS:[0x0]=>ExceptionList                      = 00000000
                 00 00 00
        00403544 50              PUSH       EAX
        00403545 64 89 25        MOV        dword ptr FS:[0x0]=>ExceptionList,ESP            = 00000000
                 00 00 00 00
        0040354c 83 ec 10        SUB        ESP,0x10
        0040354f 53              PUSH       EBX
        00403550 56              PUSH       ESI
        00403551 57              PUSH       EDI
        00403552 89 65 e8        MOV        dword ptr [EBP + local_1c],ESP
        00403555 ff 15 d8        CALL       dword ptr [->KERNEL32.DLL::GetVersion]           = 00009ada
                 90 40 00
        0040355b 33 d2           XOR        EDX,EDX
        0040355d 8a d4           MOV        DL,AH
        0040355f 89 15 d8        MOV        dword ptr [DAT_0040add8],EDX
                 ad 40 00
        00403565 8b c8           MOV        ECX,EAX
        00403567 81 e1 ff        AND        ECX,0xff
                 00 00 00
        0040356d 89 0d d4        MOV        dword ptr [DAT_0040add4],ECX
                 ad 40 00
        00403573 c1 e1 08        SHL        ECX,0x8
        00403576 03 ca           ADD        ECX,EDX
        00403578 89 0d d0        MOV        dword ptr [DAT_0040add0],ECX
                 ad 40 00
        0040357e c1 e8 10        SHR        EAX,0x10
        00403581 a3 cc ad        MOV        [DAT_0040adcc],EAX
                 40 00
        00403586 6a 00           PUSH       0x0
        00403588 e8 f1 28        CALL       FUN_00405e7e                                     undefined4 FUN_00405e7e(int para
                 00 00
        0040358d 59              POP        ECX
        0040358e 85 c0           TEST       EAX,EAX
        00403590 75 08           JNZ        LAB_0040359a
        00403592 6a 1c           PUSH       0x1c
        00403594 e8 9a 00        CALL       FUN_00403633                                     undefined FUN_00403633(DWORD par
                 00 00
        00403599 59              POP        ECX
                             LAB_0040359a                                    XREF[1]:     00403590(j)  
        0040359a 83 65 fc 00     AND        dword ptr [EBP + local_8],0x0
        0040359e e8 30 27        CALL       FUN_00405cd3                                     undefined FUN_00405cd3(void)
                 00 00
        004035a3 ff 15 d4        CALL       dword ptr [->KERNEL32.DLL::GetCommandLineA]      = 00009ac8
                 90 40 00
        004035a9 a3 18 c3        MOV        [DAT_0040c318],EAX
                 40 00
        004035ae e8 ee 25        CALL       FUN_00405ba1                                     LPSTR FUN_00405ba1(void)
                 00 00
        004035b3 a3 b4 ad        MOV        [DAT_0040adb4],EAX
                 40 00
        004035b8 e8 97 23        CALL       FUN_00405954                                     undefined FUN_00405954(void)
                 00 00
        004035bd e8 d9 22        CALL       FUN_0040589b                                     undefined FUN_0040589b(void)
                 00 00
        004035c2 e8 5e 09        CALL       FUN_00403f25                                     undefined FUN_00403f25(void)
                 00 00
        004035c7 a1 e8 ad        MOV        EAX,[DAT_0040ade8]
                 40 00
        004035cc a3 ec ad        MOV        [DAT_0040adec],EAX
                 40 00
        004035d1 50              PUSH       EAX
        004035d2 ff 35 e0        PUSH       dword ptr [DAT_0040ade0]
                 ad 40 00
        004035d8 ff 35 dc        PUSH       dword ptr [DAT_0040addc]
                 ad 40 00
        004035de e8 0d dd        CALL       FUN_004012f0                                     undefined4 FUN_004012f0(void)
                 ff ff
        004035e3 83 c4 0c        ADD        ESP,0xc
        004035e6 89 45 e4        MOV        dword ptr [EBP + local_20],EAX
        004035e9 50              PUSH       EAX
        004035ea e8 63 09        CALL       FUN_00403f52                                     undefined FUN_00403f52(UINT para
                 00 00
        004035ef 8b 45 ec        MOV        EAX,dword ptr [EBP + local_18]
        004035f2 8b 08           MOV        ECX,dword ptr [EAX]
        004035f4 8b 09           MOV        ECX,dword ptr [ECX]
        004035f6 89 4d e0        MOV        dword ptr [EBP + local_24],ECX
        004035f9 50              PUSH       EAX
        004035fa 51              PUSH       ECX
        004035fb e8 17 21        CALL       FUN_00405717                                     LONG FUN_00405717(int param_1, _
                 00 00
        00403600 59              POP        ECX
        00403601 59              POP        ECX
        00403602 c3              RET
```

El malware guarda la versión del sistema operativo. Esto se puede usar para:
- Asegurarse de que está en un entorno Windows compatible.
- Activar o desactivar funcionalidades según la versión.


Llama a una función FUN_00405e7e, que probablemente verifica alguna condición. Si no se cumple, llama a otra función (FUN_00403633).


Inicialización de estructuras y funciones auxiliares
```
004035a3 ff 15 ...             CALL [GetCommandLineA]
004035ae e8 ...                CALL FUN_00405ba1 ; ¿parsing?
004035b3 a3 b4 ad ...          MOV  [DAT_0040adb4], EAX
...
004035bd e8 ...                CALL FUN_0040589b
004035c2 e8 ...                CALL FUN_00403f25
```

Estas funciones probablemente:
- Guardan argumentos de línea de comandos.
- Analizan parámetros.
- Preparan variables internas.
- Posible instalación de persistencia o generación de nombre de mutex, etc.


- Inicialización de comunicación o payload
```
004035c7 a1 e8 ad 40 00        MOV  EAX,[DAT_0040ade8]
...
004035de e8 ...                CALL FUN_004012f0
...
004035ea e8 ...                CALL FUN_00403f52
```
Significado:
- Recupera configuraciones (tal vez servidor C2, parámetros, etc.).
- Llama a FUN_004012f0, que parece una función importante (posible payload).
- Luego pasa EAX a otra función (FUN_00403f52) como parámetro.


Inyección o manipulación de objetos
```
004035f2 8b 08                 MOV ECX,[EAX]
004035f4 8b 09                 MOV ECX,[ECX]
004035f6 89 4d e0              MOV [EBP + local_24], ECX
...
004035fb e8 ...                CALL FUN_00405717
```
Significado: Este patrón de doble indirección sugiere acceso a estructuras de objetos o punteros a vtables (si usa COM u OLE). Puede estar manipulando objetos COM para persistencia o ejecución.

