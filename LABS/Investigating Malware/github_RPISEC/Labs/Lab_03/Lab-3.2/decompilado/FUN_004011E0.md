```
                             **************************************************************
                             *                          FUNCTION                          *
                             **************************************************************
                             undefined __stdcall FUN_004011e0(void)
                               assume FS_OFFSET = 0xffdff000
             undefined         <UNASSIGNED>   <RETURN>
             undefined1        Stack[-0x100   local_100                               XREF[1]:     004011e6(*)
                             FUN_004011e0                                    XREF[1]:     FUN_004012f0:00401496(c)
        004011e0 81 ec 00        SUB        ESP,0x100
                 01 00 00
        004011e6 8d 44 24 00     LEA        EAX=>local_100,[ESP]
        004011ea 56              PUSH       ESI
        004011eb 57              PUSH       EDI
        004011ec 68 00 01        PUSH       0x100
                 00 00
        004011f1 50              PUSH       EAX
        004011f2 ff 15 54        CALL       dword ptr [->WS2_32.DLL::Ordinal_57]             = 80000039
                 91 40 00
        004011f8 8d 7c 24 08     LEA        EDI,[ESP + 0x8]
        004011fc 83 c9 ff        OR         ECX,0xffffffff
        004011ff 33 c0           XOR        EAX,EAX
        00401201 f2 ae           SCASB.RE   ES:EDI
        00401203 f7 d1           NOT        ECX
        00401205 2b f9           SUB        EDI,ECX
        00401207 8b d1           MOV        EDX,ECX
        00401209 8b f7           MOV        ESI,EDI
        0040120b 8b bc 24        MOV        EDI,dword ptr [ESP + 0x10c]
                 0c 01 00 00
        00401212 c1 e9 02        SHR        ECX,0x2
        00401215 f3 a5           MOVSD.REP  ES:EDI,ESI
        00401217 8b ca           MOV        ECX,EDX
        00401219 83 e1 03        AND        ECX,0x3
        0040121c f3 a4           MOVSB.REP  ES:EDI,ESI
        0040121e 5f              POP        EDI
        0040121f 5e              POP        ESI
        00401220 81 c4 00        ADD        ESP,0x100
                 01 00 00
        00401226 c3              RET
        00401227 90 90 90        align      align(9)
                 90 90 90
                 90 90 90
```

La función FUN_004011e0() es una rutina auxiliar que obtiene el nombre del host (hostname) de la máquina infectada y lo copia en un buffer externo. Es sencilla, pero su propósito es importante en contexto de malware: recolectar información del sistema para envío al C2 o identificación de la víctima.

Ordinal_57 en WS2_32.dll corresponde a gethostname.



| Aspecto | Descripción |
| -- | -- |
| Función API usada  | gethostname(char *name, int len) |
| Propósito | Obtener el nombre del equipo (hostname) |
| Uso habitua | Fingerprinting, identificación de la víctima, construcción de rutas personalizadas |
| Destino de los datos | Copia el resultado en un puntero externo pasado por el caller |
