

‚îî‚îÄ$ pepack Lab_02-2.malware -d db_packer.txt                 
packer:                          Dev-C++ 4.9.9.2 -> Bloodshed Software
   
  
-  El binario fue compilado usando Dev-C++ 4.9.9.2, lo cual es un IDE que utiliza el compilador mingw32 de GCC para Windows.
- No est√° empaquetado con una herramienta tradicional de protecci√≥n de binarios.
- Puede tener ofuscaci√≥n a nivel de c√≥digo fuente o cifrado manual, pero no a nivel de empaquetado PE.
- El malware puede desencriptar datos o strings en tiempo de ejecuci√≥n, o tener sus funciones cifradas, pero no est√° comprimido/oculto con un packer PE.


### DIE

![](capturas/die-lab2.2.png)

üß† An√°lisis del binario Lab_02-2.malware
üü° Informaci√≥n general:

    Tipo: PE32 (ejecutable de 32 bits)

    Modo: Consola

    Compilador: MinGW (GCC)

    Linker: GNU Bintutils (ld) v2.56

    Lenguaje: C

üü• Indicadores sospechosos / heur√≠sticos:
üî∏ Heur/Empaquetar: Compressed or packed data (Strange overlay)

    El motor heur√≠stico de DIE detecta datos empaquetados o comprimidos, especialmente por la presencia de un overlay inusual.

üî∏ Overlay: Binary(Desplazamiento=0x2e00, Tama√±o=0x41b6)

    Hay un overlay PE (datos que est√°n despu√©s del final de la √∫ltima secci√≥n PE).

    Desplazamiento 0x2e00 (11.264 bytes)

    Tama√±o 0x41b6 (16.694 bytes)

üîç Esto puede indicar datos cifrados o un payload embebido manualmente.
üö© ¬øQu√© es un overlay en un binario PE?

Un overlay es una regi√≥n que no pertenece a ninguna secci√≥n PE leg√≠tima. Puede usarse para:

    Esconder payloads que ser√°n le√≠dos o desencriptados en tiempo de ejecuci√≥n.

    Evitar an√°lisis est√°tico directo, ya que no est√° cargado por el loader PE.

    Implementar un dropper o loader que desempaqueta c√≥digo a memoria.

‚úÖ Pr√≥ximos pasos recomendados

    Extraer el overlay para analizarlo:
    Puedes usar un comando como:

dd if=Lab_02-2.malware of=overlay.bin bs=1 skip=11776 count=16790

(11776 = 0x2e00, 16790 = 0x41b6)

Analizar el overlay extra√≠do:

    Ejecuta strings overlay.bin

    Busca encabezados (¬øes un archivo PE, ZIP, CAB, etc.?)

    C√°rgalo en un editor hexadecimal (como HxD)

Revisar el binario principal en Ghidra o IDA:

    Busca llamadas a fopen, CreateFile, fread, ReadFile, memcpy, etc.

    F√≠jate si el binario lee el final de s√≠ mismo (overlay) ‚Üí eso confirmar√≠a que desencripta su contenido.

Debug din√°mico con x32dbg:

    Coloca breakpoints en GetModuleFileNameA o fopen

    Revisa si abre su propio archivo para leer el overlay
