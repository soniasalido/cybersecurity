```
                             //
                             // .rdata 
                             // ram:00404000-ram:004047ff
                             //
                             s_ConsoleWindowClass_00404000                   XREF[2]:     004001d4(*), _main:004012c7(*)  
        00404000 43 6f 6e        ds         "ConsoleWindowClass"
                 73 6f 6c 
                 65 57 69 
                             DAT_00404013                                    XREF[4]:     _main:004012ef(*), 
                                                                                          get_keys:00401362(*), 
                                                                                          get_keys:004013a4(*), 
                                                                                          MailIt:00401989(*)  
        00404013 61              ??         61h    a
        00404014 2b              ??         2Bh    +
        00404015 00              ??         00h
                             s_\WINDOWS\lzwindowlz.av_00404016               XREF[5]:     _main:004012f7(*), 
                                                                                          get_keys:0040136a(*), 
                                                                                          get_keys:004013ac(*), 
                                                                                          get_keys:00401873(*), 
                                                                                          get_keys:00401949(*)  
        00404016 5c 57 49        ds         "\\WINDOWS\\lzwindowlz.av"
                 4e 44 4f 
                 57 53 5c 
                             s_Started_logging:_0040402d                     XREF[1]:     _main:0040131c(*)  
        0040402d 0a 53 74        ds         "\nStarted logging: "
                 61 72 74 
                 65 64 20 
                             s_[SHIFT]_00404040                              XREF[1]:     get_keys:00401491(*)  
        00404040 0d 0a 5b        ds         "\r\n[SHIFT]\r\n"
                 53 48 49 
                 46 54 5d 
                             s_[ENTER]_0040404c                              XREF[1]:     get_keys:004014b4(*)  
        0040404c 0d 0a 5b        ds         "\r\n[ENTER]\r\n"
                 45 4e 54 
                 45 52 5d 
                             s_[BACKSPACE]_00404058                          XREF[1]:     get_keys:004014d7(*)  
        00404058 0d 0a 5b        ds         "\r\n[BACKSPACE]\r\n"
                 42 41 43 
                 4b 53 50 
                             s_[TAB]_00404068                                XREF[1]:     get_keys:004014fa(*)  
        00404068 0d 0a 5b        ds         "\r\n[TAB]\r\n"
                 54 41 42 
                 5d 0d 0a 00
                             s_[CTRL]_00404072                               XREF[1]:     get_keys:0040151d(*)  
        00404072 0d 0a 5b        ds         "\r\n[CTRL]\r\n"
                 43 54 52 
                 4c 5d 0d 
                             s_[DEL]_0040407d                                XREF[1]:     get_keys:00401540(*)  
        0040407d 0d 0a 5b        ds         "\r\n[DEL]\r\n"
                 44 45 4c 
                 5d 0d 0a 00
                             s_[;:]_00404087                                 XREF[1]:     get_keys:00401563(*)  
        00404087 0d 0a 5b        ds         "\r\n[;:]\r\n"
                 3b 3a 5d 
                 0d 0a 00
                             s_[/?]_00404090                                 XREF[1]:     get_keys:00401586(*)  
        00404090 0d 0a 5b        ds         "\r\n[/?]\r\n"
                 2f 3f 5d 
                 0d 0a 00
                             s_[`~]_00404099                                 XREF[1]:     get_keys:004015a9(*)  
        00404099 0d 0a 5b        ds         "\r\n[`~]\r\n"
                 60 7e 5d 
                 0d 0a 00
                             s_[_[{_]_004040a2                               XREF[1]:     get_keys:004015cc(*)  
        004040a2 0d 0a 5b        ds         "\r\n[ [{ ]\r\n"
                 20 5b 7b 
                 20 5d 0d 
                             s_[\|]_004040ad                                 XREF[1]:     get_keys:004015ef(*)  
        004040ad 0d 0a 5b        ds         "\r\n[\\|]\r\n"
                 5c 7c 5d 
                 0d 0a 00
                             s_[_]}_]_004040b6                               XREF[1]:     get_keys:00401612(*)  
        004040b6 0d 0a 5b        ds         "\r\n[ ]} ]\r\n"
                 20 5d 7d 
                 20 5d 0d 
                             s_['"]_004040c1                                 XREF[1]:     get_keys:00401635(*)  
        004040c1 0d 0a 5b        ds         "\r\n['\"]\r\n"
                 27 22 5d 
                 0d 0a 00
                             s_[CAPS_LOCK]_004040ca                          XREF[1]:     get_keys:00401839(*)  
        004040ca 0d 0a 5b        ds         "\r\n[CAPS LOCK]\r\n"
                 43 41 50 
                 53 20 4c 
                             DAT_004040da                                    XREF[1]:     get_keys:0040186b(*)  
        004040da 72              ??         72h    r
        004040db 62              ??         62h    b
        004040dc 00              ??         00h
                             s_Logged_004040dd                               XREF[1]:     get_keys:00401912(*)  
        004040dd 4c 6f 67        ds         "Logged"
                 67 65 64 00
                             s_unknown-g@hotmail.co.uk_004040e4              XREF[1]:     get_keys:0040191a(*)  
        004040e4 75 6e 6b        ds         "unknown-g@hotmail.co.uk"
                 6e 6f 77 
                 6e 2d 67 
                             s_unknown-g@inbox.com_004040fc                  XREF[1]:     get_keys:00401922(*)  
        004040fc 75 6e 6b        ds         "unknown-g@inbox.com"
                 6e 6f 77 
                 6e 2d 67 
                             s_my.inbox.com_00404110                         XREF[1]:     get_keys:0040192a(*)  
        00404110 6d 79 2e        ds         "my.inbox.com"
                 69 6e 62 
                 6f 78 2e 
                             DAT_0040411d                                    XREF[1]:     get_keys:00401941(*)  
        0040411d 77              ??         77h    w
        0040411e 00              ??         00h
        0040411f 00              ??         00h
                             switchD_00401465::switchdataD_00404120          XREF[1]:     get_keys:0040145e(*)  
        00404120 d0 14 40 00     addr       switchD_00401465::caseD_8
        00404124 f3 14 40 00     addr       switchD_00401465::caseD_9
        00404128 52 18 40 00     addr       switchD_00401465::caseD_a
        0040412c 52 18 40 00     addr       switchD_00401465::caseD_a
        00404130 52 18 40 00     addr       switchD_00401465::caseD_a
        00404134 ad 14 40 00     addr       switchD_00401465::caseD_d
        00404138 52 18 40 00     addr       switchD_00401465::caseD_a
        0040413c 52 18 40 00     addr       switchD_00401465::caseD_a
        00404140 8a 14 40 00     addr       switchD_00401465::caseD_10
        00404144 16 15 40 00     addr       switchD_00401465::caseD_11
        00404148 52 18 40 00     addr       switchD_00401465::caseD_a
        0040414c 52 18 40 00     addr       switchD_00401465::caseD_a
        00404150 32 18 40 00     addr       switchD_00401465::caseD_14
        00404154 52 18 40 00     addr       switchD_00401465::caseD_a
        00404158 52 18 40 00     addr       switchD_00401465::caseD_a
        0040415c 52 18 40 00     addr       switchD_00401465::caseD_a
        00404160 52 18 40 00     addr       switchD_00401465::caseD_a
        00404164 52 18 40 00     addr       switchD_00401465::caseD_a
        00404168 52 18 40 00     addr       switchD_00401465::caseD_a
        0040416c 52 18 40 00     addr       switchD_00401465::caseD_a
        00404170 52 18 40 00     addr       switchD_00401465::caseD_a
        00404174 52 18 40 00     addr       switchD_00401465::caseD_a
        00404178 52 18 40 00     addr       switchD_00401465::caseD_a
        0040417c 52 18 40 00     addr       switchD_00401465::caseD_a
        00404180 67 14 40 00     addr       switchD_00401465::caseD_20
        00404184 52 18 40 00     addr       switchD_00401465::caseD_a
        00404188 52 18 40 00     addr       switchD_00401465::caseD_a
        0040418c 52 18 40 00     addr       switchD_00401465::caseD_a
        00404190 52 18 40 00     addr       switchD_00401465::caseD_a
        00404194 52 18 40 00     addr       switchD_00401465::caseD_a
        00404198 52 18 40 00     addr       switchD_00401465::caseD_a
        0040419c 52 18 40 00     addr       switchD_00401465::caseD_a
        004041a0 52 18 40 00     addr       switchD_00401465::caseD_a
        004041a4 52 18 40 00     addr       switchD_00401465::caseD_a
        004041a8 52 18 40 00     addr       switchD_00401465::caseD_a
        004041ac 52 18 40 00     addr       switchD_00401465::caseD_a
        004041b0 52 18 40 00     addr       switchD_00401465::caseD_a

        ......
        
                0040460f 00              ??         00h
                             ___RUNTIME_PSEUDO_RELOC_LIST_END__              XREF[3]:     __pei386_runtime_relocator:00402
                             __RUNTIME_PSEUDO_RELOC_LIST__                                __pei386_runtime_relocator:00402
                             ___RUNTIME_PSEUDO_RELOC_LIST__                               __pei386_runtime_relocator:00402
                             __RUNTIME_PSEUDO_RELOC_LIST_END__
        00404610 00 00 00 00     undefined4 00000000h
                             DAT_00404614                                    XREF[1]:     __pei386_runtime_relocator:00402
        00404614 00 00 00 00     undefined4 00000000h
        00404618 00              ??         00h
        00404619 00              ??         00h
        0040461a 00              ??         00h


```


📚 Análisis de la sección .rdata (ram:00404000-004047ff)
🪪 Cadenas relevantes
Dirección	Cadena/Campo	Significado
00404000	ConsoleWindowClass	Clase usada para ocultar ventana con FindWindowA
00404016	\\WINDOWS\\lzwindowlz.av	Ruta sospechosa de almacenamiento del log
0040402d	\nStarted logging:	Indicador de inicio de captura de teclas
00404040	\r\n[SHIFT]\r\n y otras similares	Traducción legible de teclas especiales (ENTER, TAB, etc.)
004040dd	Logged	Marca registros en archivo
004040e4	unknown-g@hotmail.co.uk	Credencial usada para enviar datos (SMTP probablemente)
004040fc	unknown-g@inbox.com	Dirección alternativa
00404110	my.inbox.com	Servidor SMTP usado para exfiltración
🎯 Conclusiones
✅ Comportamiento confirmado

Este keylogger:

    Usa GetAsyncKeyState para capturar teclas en tiempo real.

    Guarda resultados en:
    C:\WINDOWS\lzwindowlz.av

    Anota teclas especiales con formato legible como [ENTER], [CTRL], [DEL], etc.

    Usa SMTP para exfiltrar información a través de:

        unknown-g@hotmail.co.uk

        unknown-g@inbox.com

        Vía my.inbox.com

🧠 Inteligencia para defensa
IOCs (Indicadores de compromiso):
Tipo	Valor
Ruta	C:\WINDOWS\lzwindowlz.av
Cadenas	[ENTER], Started logging, Logged
Email	unknown-g@inbox.com
Servidor	my.inbox.com


📦 DLLs Importadas
DLL	Funcionalidad general	Uso confirmado en el malware
KERNEL32.DLL	Funciones básicas del sistema y consola	AllocConsole, ExitProcess, Sleep, SetUnhandledExceptionFilter, manejo de átomos
USER32.DLL	Interacción con la GUI y teclado	FindWindowA, ShowWindow, GetAsyncKeyState (keylogger)
WS2_32.DLL	Red (Winsock API)	socket, connect, send, recv, closesocket (exfiltración SMTP)
MSVCRT.DLL	Funciones estándar de C	fopen, fputs, fclose, strcat, strcpy, malloc, free, etc. (registro en archivo, manipulación de cadenas)
🔍 Funciones clave importadas (por nombre o por hint)
🛜 Networking (WS2_32.DLL)

    socket, connect, send, recv, closesocket, WSAStartup, WSACleanup

        → Establece conexión C2 para enviar logs (probablemente usando SMTP).

⌨️ Captura de teclas (USER32.DLL)

    GetAsyncKeyState

        → Captura pulsaciones en tiempo real (keylogger).

💾 Archivo (MSVCRT.DLL)

    fopen, fputs, fclose

        → Escribe los logs capturados en C:\WINDOWS\lzwindowlz.av.

⏲️ Tiempo & flujo

    Sleep → pausa entre capturas.

    ExitProcess, SetUnhandledExceptionFilter → control de errores.

🪪 Ocultación

    FindWindowA, ShowWindow → ocultan la consola del programa.
