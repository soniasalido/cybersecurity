
## Analisis trafico de red 

### Petici√≥n para resolver la IP de reversing.rocks:

![](capturas/wireshark-lab2.1.png)

Este fragmento de tr√°fico de red muestra una resoluci√≥n DNS del dominio reversing.rocks, probablemente realizada por el malware al inicio de su ejecuci√≥n. Analicemos cada l√≠nea:
```
üìä An√°lisis de los paquetes
No.	Tiempo	Origen	Destino	Protocolo	Info
1	0.000	10.0.2.15	192.168.18.1	DNS	Consulta A para reversing.rocks
2	0.018	10.0.2.15	192.168.18.1	DNS	Reintento de consulta A (ID igual: 0x3045)
3	0.045	192.168.18.1	10.0.2.15	DNS	Respuesta A: reversing.rocks ‚Üí 162.255.119.254
```
- El sistema (posiblemente el malware) env√≠a una consulta DNS para obtener la IP de reversing.rocks.
- Hay un peque√±o reintento, que puede deberse a una p√©rdida moment√°nea de paquete o una espera corta sin respuesta inmediata.
- Finalmente, recibe como respuesta la IP 162.255.119.254, que ya sabemos que el malware intenta contactar despu√©s en el puerto 1234.



Este tr√°fico:
- Confirma que reversing.rocks es el dominio C2 (Command & Control) del malware.
- La IP 162.255.119.254 obtenida es usada en los intentos de conexi√≥n posteriores.




### Conexi√≥n inicial a puerto 80 (HTTP):
```
49840 ‚Üí 80 [SYN]
80 ‚Üí 49840 [SYN, ACK]
49840 ‚Üí 80 [ACK]
49840 ‚Üí 80 [FIN, ACK]
80 ‚Üí 49840 [ACK]
```
‚úÖ Esto indica una conexi√≥n TCP completada y cerrada inmediatamente sin transferencia de datos HTTP. Podr√≠a ser una prueba de conectividad o un mecanismo para comprobar disponibilidad del servidor.

### Intento de conexi√≥n al puerto 1234:
```
49841 ‚Üí 1234 [SYN]
Retransmisiones sucesivas...
49842 ‚Üí 1234 [SYN]
....M√°s retransmisiones...
```

‚ö†Ô∏è Aqu√≠ el malware est√° intentando abrir una conexi√≥n hacia el puerto 1234 del servidor remoto 162.255.119.254, pero no obtiene respuesta alguna, lo que da lugar a m√∫ltiples retransmisiones durante 30+ segundos.

### Interpretaci√≥n
- Puerto 1234 es un puerto com√∫nmente usado por malware y shells reversas (Netcat, backdoors personalizados, C2).
- Este comportamiento sugiere que la muestra de malware est√° programada para conectarse a un servidor de comando y control (C2) en el puerto 1234.
- El hecho de que no haya respuesta indica:
    - El C2 ya no est√° activo.
    - Est√° detr√°s de un firewall.
    - O el dominio/IP fue sustituido y el malware qued√≥ obsoleto.


### Conclusi√≥n. El tr√°fico capturado evidencia:
- Intento de conexi√≥n v√°lido al puerto 80, pero sin datos (probablemente prueba de vida).
- Persistentes intentos fallidos al puerto 1234, lo cual confirma funcionalidad de comunicaci√≥n con C2.
