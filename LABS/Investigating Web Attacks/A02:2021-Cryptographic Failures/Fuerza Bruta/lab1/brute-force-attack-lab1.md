El ataque de fuerza bruta, en términos de la enumeración común de debilidades (CWE por sus siglas en inglés), se clasifica generalmente bajo CWE-307: Improper Restriction of Excessive Authentication Attempts (Restricción inadecuada de intentos excesivos de autenticación).


Partimos de la web insegura: foro

## Instalación de Java
Descargamos e instalamos Java: https://www.java.com/es/download/ie_manual.jsp


## Instalar Apache Jmeter
JMeter es un proyecto de Apache que puede ser utilizado como una herramienta de prueba de carga para analizar y medir el rendimiento de una variedad de servicios, con énfasis en aplicaciones web.

Descargamos Apache Jmeter: https://jmeter.apache.org/download_jmeter.cgi


## Abrimos el programa Apache Jmeter haciendo doble click en ApacheJMeter.jar:
![](capturas/brute-force-attack-lab1.png)


## Ataque de Fuerza Bruta
Ejecutamos el script:  scriptFuerzabruta.jmx: Abrimos el  scriptFuerzabruta.jmx con Jmeter. Este es el algoritmo que buscará por fuerza bruta la password:

Ajustar los valores de los parámetros user y password:
- Ajustamos los valores: USER: test2
- PASSWORD: 05121980 (Fecha 05/12/1980)
  ![](capturas/brute-force-attack-lab1-2.png)

- Ajustamos la IP: Comprobamos que la IP apunte a localhost que es donde está xampp funcionando:
![](capturas/brute-force-attack-lab1-3.png)


## Lanzamos el script
Pulsamos el botón Lanzar (Arrancar) -->

Tras unos pocos intentos fallidos, vemos que obtiene un resultado que sí logra registrarse en el login. Accedemos a View Results Tree para ver los resultados de las pruebas de la contraseña:

![](capturas/brute-force-attack-lab1-4.png)
![](capturas/brute-force-attack-lab1-5.png)
![](capturas/brute-force-attack-lab1-6.png)


# Análisis con Wireshark

## Filtra por peticiones HTTP que usan el método POST:
Dado que el ataque involucra enviar información a través de un formulario web, lo más probable es que estos datos sean transmitidos mediante una petición HTTP POST con el contenido codificado en application/x-www-form-urlencoded.
```
http.request.method == "POST"
```
![](capturas/brute-force-attack-lab1-7.png)


## Buscar tipos de contenido de carga de archivos:
Este filtro busca peticiones POST con un tipo de contenido multipart/form-data, que es el utilizado para la carga de archivos en formularios web.
```
http.content_type contains "multipart/form-data"
```



## Identificar extensiones de archivos sospechosas:
Este filtro busca ciertas extensiones de archivos que podrían ser maliciosas.
```
(http.file_data contains ".exe" || http.file_data contains ".php" || http.file_data contains ".js")
```



## Filtering for Web Traffic
The expression http.request reveals URLs for HTTP requests, and tls.handshake.type eq 1 shows domain names used in HTTPS or SSL/TLS traffic.

For web traffic generated by Windows hosts, results from this filter include HTTP requests over UDP port 1900. This HTTP traffic is Simple Service Discovery Protocol (SSDP). SSDP is used to discover plug-and-play devices and is not associated with normal web traffic. We can exclude SSDP traffic in our results by modifying our filter expression to:
```
(http.request or tls.handshake.type eq 1) and !(ssdp)
```



## Recuperar fichero subido del tráfico de red:
Primero debemos encontrar el paquete donde se sube el fichero:
```
http.file_data contains ".php" 
```

Hacemos clic derecho sobre el paquete y seleccionamos "Follow" --> "HTTP Stream". Esto  mostrará todo el flujo de la conversación HTTP en la que se encuentra el fichero subido.



Para guardar los Datos: En la ventana de "Follow HTTP Stream", buscamos el contenido binario de la imagen. Usualmente, encontraremos encabezados HTTP primero, seguidos de los datos binarios del fichero. Seleccionamos solamente la parte binaria y cópiamos.

Para guardar Como Archivo: Abrimos un editor de texto en bruto (como Notepad++ o un editor hexadecimal) y pegamos  los datos binarios. Guardamos este archivo con la extensión apropiada.

